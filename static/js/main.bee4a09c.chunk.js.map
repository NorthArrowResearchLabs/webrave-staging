{"version":3,"sources":["../../src/index.ts","../../src/config.ts","../../../src/modals/ShareDialog.tsx","../../src/types.ts","../../../src/misc/WarehouseTags.tsx","../../../src/misc/DownloadZipBtn.tsx","../../../src/misc/WebRaveBtn.tsx","../../src/constants.ts","../../../src/frame/Footer.tsx","../../../src/frame/Topbar.tsx","../../src/xml.ts","../../src/api.ts","../../src/schema.graphql.ts","../../../src/classes/Program.ts","../../../src/classes/Project.ts","../../../src/classes/errors.ts","../../../src/classes/TileServiceJSONClass.ts","../../../src/frame/Topbar.style.ts","../../../src/misc/WarehouseButton.tsx","../../../src/modals/ProgramChooser.tsx","../../../../src/modals/ProjectModal/ProjectModal.tsx","../../../../src/modals/ProjectModal/RecurseTreeItem.tsx","../../../../src/modals/ProjectModal/RecurseTreeItem.style.ts","../../../../src/modals/ProjectModal/ProjectModal.style.ts","../../../src/modals/LoginScreen.tsx","../../../src/modals/NotAllowedModal.tsx","../../../src/hooks/useDownloads.tsx","../../../src/hooks/useProgram.ts","../../../src/hooks/useProject.ts","../../../src/hooks/useQueryParams.tsx","../../src/themes.ts","../../src/googleAnalytics.ts","../../src/Multidot.tsx","../../src/Polygon.tsx","../../src/Polyline.tsx","../../src/QRCode.tsx","../../src/Raster.tsx","../../src/LayerIcon.tsx","components/AppWrapper.tsx","components/ProjectLoading.tsx","mapStyles/index.ts","config.ts","lib/util.ts","recoil/project.ts","recoil/tree.ts","lib/downloadQueue.ts","recoil/tiles.ts","recoil/symbology.ts","recoil/layers.ts","recoil/map.ts","hooks/useViews.tsx","hooks/useAppStateInit.tsx","components/ProjectNotFound.tsx","components/AppSplitter.tsx","components/TreeDrawer.tsx","hooks/useMapLayers.tsx","components/tree/TreeNodeLabel.tsx","components/tree/TreeLeaf.tsx","components/tree/TreeBranch.tsx","components/tree/TreeControl.tsx","components/tree/TreeContextMenu.tsx","connectors/TreeContextMenu.connect.tsx","components/meta/MetaData.tsx","components/meta/LayerMeta.tsx","components/meta/LayerTileInfo.tsx","components/meta/LayerInfo.tsx","connectors/TreeLayerInfo.connect.tsx","connectors/Treecontrol.connect.tsx","connectors/MapTiles.connect.tsx","components/legend/ViewList.tsx","components/legend/BaseLayerPicker.tsx","components/legend/LegendError.tsx","components/legend/Legend.tsx","components/legend/ColorRamp.tsx","components/legend/LegendLayerItem.tsx","connectors/Legend.connect.tsx","components/map/MapLoading.tsx","components/map/Map.tsx","components/TreeToggleBtn.tsx","components/map/defaultSymbology.ts","connectors/MapLayer.connect.tsx","connectors/Map.connect.tsx","components/ProjectInfoTab.tsx","hooks/useColourFallback.ts","connectors/App.connect.tsx","connectors/AppAuth.connect.tsx","index.tsx"],"names":["exports","react_1","default","createElement","e","_a","root","display","zIndex","theme","drawer","text","flexGrow","logo","fileSort","currFolder","sort","a","children","b","color","palette","primary","contrastText","maxWidth","prog","role","treeItemRoot","backgroundColor","background","paper","treeItemContainer","treeItemText","marginLeft","spacing","padding","treeItemIcon","treeFile","treeFileContent","borderBottom","treeFolder","treeFolderContent","treeFolderText","allowSelect","userSelect","cursor","margin","scrollPaper","alignItems","name","whiteSpace","overflow","textOverflow","marginBottom","titlebar","titlebarLeft","header","headerLeft","flex","headerRight","textAlign","closeButton","colors_1","Object","keys","input","forEach","params","k","stringVal","changes","length","loglevel_1","_1","AppWrapper","title","history","signOut","containerProps","ThemeProvider","themes","home","noScroll","fullWidth","topbar","signOutHandler","shareUrl","window","location","href","ProjectLoading","logoSVG","CircularProgress","size","thickness","status","Typography","variant","component","style","position","top","left","width","height","mapStyles","id","toolTip","Icon","SatelliteOutlined","Satellite","DirectionsCarOutlined","BasicMap","TerrainOutlined","GrayscaleHS","domain","process","REACT_APP_DOMAIN","log","debug","endpoints","graphql","warehouseUrl","appDefaults","appName","zoomRange","worldBounds","baseLayer","baseLayers","drawerOpen","init","minFilterTextLength","maxMapLayers","retryDelayS","refreshDelayS","legendColors","red","green","blue","orange","purple","cyan","lime","brown","redirectUrl","URL","endsWith","origin","console","publicUrl","addColorAlpha","inColor","alpha","bgTmp","decomposeColor","type","values","recomposeColor","newBounds","oldBounds","newRect","fallback","Math","max","min","SORT_ORDER","ProjectTreeLayerTypes","POINT","LINE","POLYGON","TIN","RASTER","projectAtom","atom","key","authAtom","drawerOpenAtom","activeIdsAtom","activeTreeLeavesSelector","selector","get","proj","activeIds","tree","leaves","filter","leaf","indexOf","activeLeavesSortedSelector","newArr","lyrA","lyrB","layerType","layerSort","projectMapLayerLeafsSelector","layerPath","nodeExists","ProjectTreeLayerTileTypes","projectLayerPathsSelector","reduce","acc","treeFilterTextAtom","projectLeafHierarchySelector","project","parent","pid","ancestry","searchStrings","branches","foundBranch","find","br","bid","push","label","toLowerCase","trim","map","idx","projectLeafSearchAncestry","treeInfoPaneIdAtom","treeInfoPaneOpenAtom","treeLeafSelectorFamily","selectorFamily","ptid","Error","treeSelectedIdsAtom","treeSelectedSelector","rawIds","selectedIds","ids","parseInt","replace","projectHiddenNodesSelector","retVal","hierarchy","filterText","filterTextArr","split","w","allowedLeaves","leafHierarchy","every","word","allowedBranches","Array","from","Set","lid","treeLeafStateSelector","layer","layerStateSelectorFamily","hidden","active","reportUrl","REPORT","tileStatus","TilingStatus","SUCCESS","tiles","url","tilesState","treeAllowed","undefined","renderable","treeRootBranchId","branch","treeBranchSelectorFamily","lf","treeBranchStateSelectorFamily","hiddenNodes","collapsed","Boolean","treeExpandedSelector","selected","treeContextMenuAtom","treeExpandedIdsAtom","treeAllIdsSelector","QUEUE","Bottleneck","maxConcurrent","tilesRequestIdAtomFamily","atomFamily","tilesRetriesAtomFamily","tilesSelectorFamily","auth","UNKNOWN","downloadQueue","schedule","priority","getCurrentToken","then","jwt","getLayerTiles","projType","program","apiRes","errors","data","FETCH_ERROR","error","JSON","stringify","join","toString","createSymbologyKeys","symbology","symbKey","sk","isEqual","projectSymbologiesSelector","mapLyrs","symbologySelectorFamily","activeSymb","isRaster","SymbologyStatus","getWebSymbology","catch","err","ERROR","assignedRandomColorsAtom","leafRandomColAtomFamily","selectNextColor","current","leafid","tileServLoadable","noWait","symbologyLoadable","legendActive","treeSelected","state","FETCHING","contents","FILE","symbologyStatus","NOT_APPLICABLE","viewProjLeafIdsSelector","views","view","viewIds","layers","vl","ptl","blLayerId","baseLayerAtom","mapErrorAtom","mapLoadingAtom","renderableMapLayersSelector","usableLayers","rndCols","lyr","randomColor","idStr","beforeId","activeViewAtom","boundsAtom","zoomBoundsAtom","boundsSelector","zoom","bounds","useViews","useRecoilState","currView","setCurrView","viewLeafIds","useRecoilValue","setActiveMapIds","useSetRecoilState","setView","viewId","googleAnalytics","event","resetView","defaultView","useAppStateInit","initAuth","initProj","setProjectTree","setActiveIds","setAuth","projectSymbologies","projectLayerPaths","setExpanded","useEffect","preFetchLayerTile","useRecoilCallback","snapshot","getLoadable","preFetchSymbology","sKey","useStyles","makeStyles","rootContainer","flexDirection","spacer","buttonContainer","logoContainer","ProjectNotFound","classes","Container","className","Paper","src","alt","paragraph","Link","stay","splitPane","resizer","opacity","boxSizing","backgroundClip","transition","borderTop","borderLeft","borderRight","borderColor","AppSplitter","open","child1","child2","defaultSize","minSize","maxSize","resizerClassName","pane1Style","pane2Style","appBar","tabs","tabContents","secondary","main","right","TreeDrawer","useState","activeTab","setValue","Tabs","value","onChange","newValue","indicatorColor","textColor","aria-label","tab","Tab","tid","useMapLayers","setError","removeLayer","addLayer","toggleLayer","normal","fontStyle","highlighted","fontWeight","TreeNodeLabel","query","sanitized","t","chunks","highlightWords","c","match","useLeafStyles","treeLeafLabel","innerLabel","metaIcon","fontSize","lineHeight","loadingSpinner","leafQUEUED","leafCREATING","leafTILING_ERROR","leafFETCH_ERROR","leafNOT_FOUND","leafINDEX_NOT_FOUND","leafLAYER_NOT_FOUND","leafUNKNOWN","leafFETCHING","leafSUCCESS","TreeLeaf","searchText","handleContext","handleClick","handleDoubleClick","tileStatusStr","QUEUED","CREATING","TILING_ERROR","INDEX_NOT_FOUND","LAYER_NOT_FOUND","TreeItem","nodeId","clsx","onClick","onDoubleClick","onContextMenu","preventDefault","clientX","clientY","icon","useBranchStyles","marginTop","iconContainer","TreeBranch","stopPropagation","container","folderIcon","paddingBottom","searchBox","searchBoxInput","TreeControl","lyrInfoOpen","setSearchText","expanded","ctxMenu","lyrInfo","setSelected","setSearchDebounced","debounce","stext","TextField","placeholder","target","InputProps","startAdornment","InputAdornment","TreeView","defaultCollapseIcon","defaultExpandIcon","onNodeToggle","nodeIds","onNodeSelect","isArray","item","TreeContextMenu","onClose","menuItems","Menu","keepMounted","anchorReference","anchorPosition","disabled","MenuItem","TreeContextMenuConnect","ctxState","leafId","setTreeInfoPaneId","setTreeeInfoPaneOpen","newWindow","opener","table","section","sectionHeader","metaKey","metaValue","SPECIAL_FORMATS","datecreated","val","valDate","dates","HTML5InputToTimestamp","formatDate","formatDateAgo","formatString","lwrKey","MetaData","meta","TableContainer","Table","TableBody","rowKey","TableRow","TableCell","scope","align","DONTSHOW","minimal","whNote","LayerMeta","sections","distill","rk","upstreamWarehouse","upstreamProject","upstreamLayer","Layer","makeSections","_rs_prj_projType","LayerTileInfo","Status","Started","started","lastStatus","duration","toFixed","originFile","numeral","format","rsLayer","path","lastModified","toolbar","minHeight","dark","layerTitle","layerIcon","layerMeta","overflowY","typeContainer","LayerInfo","handleClose","Toolbar","Tooltip","IconButton","edge","TreeLayerInfo","leafID","TreeBranchConnector","branchId","depth","branchState","d","TreeLeafConnector","treeLeafState","setCtxState","setInfoPaneId","TreeControlConnect","setFilterText","rootBranchId","expandedIds","setExpandedIds","setSelectedIds","infoPaneId","allIds","infoPaneOpen","setInfoPaneOpen","realExpanded","realSetExpanded","treeContrextMenu","rootBranch","MapTilesConnect","tLoad","useRecoilValueLoadable","updateBoundsState","set","getPromise","reqId","retryId","zoomBounds","oldZBounds","newZbounds","minZoom","maxZoom","setTimeout","EMPTY_VID","ViewList","activeView","projectViews","handleChange","realView","viewOptions","useMemo","viewOpts","v","defaultString","FormControl","InputLabel","htmlFor","Select","menuIcon","marginRight","menuItem","BaseLayerPicker","setBaseLayer","selectMenu","newBl","bl","LegendError","legendBox","border","borderRadius","boxShadow","subheaders","Legend","setViewId","List","dense","disablePadding","paddingLeft","row","colorBox","ramp","pRamp","percent","util","isNumeric","colors","slice","it","colorStr","parseFloat","parseRamp","ListItem","divider","disableGutters","idr","listItem","listItemAvatar","minWidth","expandIcon","expandDisabled","avatar","heading","layerItem","legendName","deleteButtonHover","legendColor","deleteButton","LegendLayerItem","loading","fgColor","bgColor","legendData","setOpen","bgColFinal","fgColFinal","toggle","hasRamp","subLabel","Fragment","ListItemIcon","ListItemAvatar","Avatar","iconProps","ListItemText","ListItemSecondaryAction","ColorRamp","LegendConnect","mapError","activeLeaves","_setBaseLayer","currentView","LegendItemConnect","rndColIdx","cols","sym","fallbackColor","defaultFg","defaultReturn","fg","bg","lineNode","s","line","fillNode","fill","circleNode","circleFill","legendColorFinder","symbologyJSON","stats","rasterStats","colorRamp","maximum","minimum","MapLoading","mapContainer","transform","drawerContents","drawerSpacer","drawerSpacerOpen","dialogContainer","justifyContent","loaderSpinner","bottom","dialog","dummyText","defaultViewport","debounceConsoleLog","_","Map","styleLoading","viewport","_setViewport","viewportRef","useRef","setViewport","inV","outV","pitch","bearing","longitude","latitude","baseStyle","bs","newViewport","mapLoader","mapStyle","clickRadius","onViewportChange","mapboxApiAccessToken","config","mapConfig","mapBoxToken","toggleDrawer","Fab","calculateOpacity","transparency","commonFeatures","layerId","lyrProps","minzoom","maxzoom","layout","subLayers","sublyr","sl","rndColor","paint","point","polygon","outline","MapLayers","retry","setRetry","React","useContext","MapContext","mapLoading","setMapLoading","renderableMapLayers","recalcMapLayers","useCallback","isStyleLoaded","lastId","getMapStyle","getStyle","mapLayers","mapSources","sources","renderablelayersDict","sourceId","newKey","symbologyName","addedLayers","addSource","scheme","getVectorSource","source","getRasterLayerProps","symbJSON","rndCol","defaultSymbology","symb","idStrIdx","getVectorLayerProps","lKey","addKey","moveLayer","currId","info","MapConnect","TreeToggleBtn","btnGroup","footerLogo","ProjectInfoTab","downloadZipFile","pendingZips","projectInfo","Title","Type","tags","createdOn","updatedOn","pendingSince","Divider","rel","useColourFallback","activeTreeLeaves","assignRndCol","colIds","currRndCol","nextCol","needRndCol","FOUND","cid","exFunc","AppConnect","programs","useProgram","hasViewAccess","WarehouseRoleEnum","useProject","isProjLoading","initialized","useDownloads","hash","plp","AppAuthConnect","authInfo","setAuthInfo","programsState","setProgramsState","isAppPreLoading","setIsAppPreLoading","useHosted","useHistory","currentPageView","authCheck","authResp","authVals","region","userPoolId","userPool","userPoolWebClientId","clientId","mandatorySignIn","oauth","redirectSignIn","redirectSignOut","responseType","storageUrl","localStorage","getItem","localUrl","pathname","isAuthenticated","isAuthComplete","setItem","removeItem","navigate","address","machineName","getPrograms","allPrograms","message","version","appWrapProps","render","props","signIn","mapboxgl","workerClass","require","setDefaultLevel","levels","DEBUG","ReactDOM","basename","hashHistory","document","getElementById","addEventListener","pushState","navigator","storage","persist","granted","warn"],"mappings":"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","file":"static/js/main.bee4a09c.chunk.js","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.config = exports.googleAnalytics = exports.themes = exports.hashHistory = exports.useQueryParams = exports.useProject = exports.useProgram = exports.useDownloads = exports.NotAllowedModal = exports.LoginScreen = exports.ShareDialog = exports.ProjectModal = exports.ProgramChooser = exports.WebRaveBtn = exports.WarehouseButton = exports.DownloadZipBtn = exports.WarehouseTags = exports.Topbar = exports.Footer = void 0;\nvar Footer_1 = require(\"./frame/Footer\");\nObject.defineProperty(exports, \"Footer\", { enumerable: true, get: function () { return __importDefault(Footer_1).default; } });\nvar Topbar_1 = require(\"./frame/Topbar\");\nObject.defineProperty(exports, \"Topbar\", { enumerable: true, get: function () { return __importDefault(Topbar_1).default; } });\nvar WarehouseTags_1 = require(\"./misc/WarehouseTags\");\nObject.defineProperty(exports, \"WarehouseTags\", { enumerable: true, get: function () { return __importDefault(WarehouseTags_1).default; } });\nvar DownloadZipBtn_1 = require(\"./misc/DownloadZipBtn\");\nObject.defineProperty(exports, \"DownloadZipBtn\", { enumerable: true, get: function () { return __importDefault(DownloadZipBtn_1).default; } });\nvar WarehouseButton_1 = require(\"./misc/WarehouseButton\");\nObject.defineProperty(exports, \"WarehouseButton\", { enumerable: true, get: function () { return __importDefault(WarehouseButton_1).default; } });\nvar WebRaveBtn_1 = require(\"./misc/WebRaveBtn\");\nObject.defineProperty(exports, \"WebRaveBtn\", { enumerable: true, get: function () { return __importDefault(WebRaveBtn_1).default; } });\nvar ProgramChooser_1 = require(\"./modals/ProgramChooser\");\nObject.defineProperty(exports, \"ProgramChooser\", { enumerable: true, get: function () { return __importDefault(ProgramChooser_1).default; } });\nvar ProjectModal_1 = require(\"./modals/ProjectModal/ProjectModal\");\nObject.defineProperty(exports, \"ProjectModal\", { enumerable: true, get: function () { return __importDefault(ProjectModal_1).default; } });\nvar ShareDialog_1 = require(\"./modals/ShareDialog\");\nObject.defineProperty(exports, \"ShareDialog\", { enumerable: true, get: function () { return __importDefault(ShareDialog_1).default; } });\nvar LoginScreen_1 = require(\"./modals/LoginScreen\");\nObject.defineProperty(exports, \"LoginScreen\", { enumerable: true, get: function () { return __importDefault(LoginScreen_1).default; } });\nvar NotAllowedModal_1 = require(\"./modals/NotAllowedModal\");\nObject.defineProperty(exports, \"NotAllowedModal\", { enumerable: true, get: function () { return __importDefault(NotAllowedModal_1).default; } });\nvar useDownloads_1 = require(\"./hooks/useDownloads\");\nObject.defineProperty(exports, \"useDownloads\", { enumerable: true, get: function () { return __importDefault(useDownloads_1).default; } });\nvar useProgram_1 = require(\"./hooks/useProgram\");\nObject.defineProperty(exports, \"useProgram\", { enumerable: true, get: function () { return __importDefault(useProgram_1).default; } });\nvar useProject_1 = require(\"./hooks/useProject\");\nObject.defineProperty(exports, \"useProject\", { enumerable: true, get: function () { return __importDefault(useProject_1).default; } });\nvar useQueryParams_1 = require(\"./hooks/useQueryParams\");\nObject.defineProperty(exports, \"useQueryParams\", { enumerable: true, get: function () { return __importDefault(useQueryParams_1).default; } });\nObject.defineProperty(exports, \"hashHistory\", { enumerable: true, get: function () { return useQueryParams_1.hashHistory; } });\nvar themes_1 = require(\"./themes\");\nObject.defineProperty(exports, \"themes\", { enumerable: true, get: function () { return __importDefault(themes_1).default; } });\nexports.googleAnalytics = __importStar(require(\"./googleAnalytics\"));\nexports.config = __importStar(require(\"./config\"));\n__exportStar(require(\"./types\"), exports);\n__exportStar(require(\"./constants\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.awsAuth = exports.googleAnalytics = exports.redirectUrl = exports.mandatoryMetaColors = exports.endpoints = exports.version = exports.mapConfig = exports.isDev = exports.tagColors = void 0;\nvar colors_1 = require(\"@material-ui/core/colors\");\nvar loglevel_1 = __importDefault(require(\"loglevel\"));\nexports.tagColors = {\n    tagColors: [\n        '#418CF0',\n        '#FCB441',\n        '#E0400A',\n        '#056492',\n        '#BFBFBF',\n        '#1A3B69',\n        '#FFE382',\n        '#129CDD',\n        '#CA6B4B',\n        '#005CDB',\n        '#F3D288',\n        '#506381',\n        '#F1B9A8',\n        '#E0830A',\n        '#7893BE'\n    ]\n};\nvar domain = process.env.REACT_APP_DOMAIN;\nif (process.env.NODE_ENV && process.env.NODE_ENV === 'development') {\n    domain = 'localhost';\n}\nloglevel_1.default.debug('config: ', { domain: domain });\nexports.isDev = process.env.NODE_ENV && process.env.NODE_ENV === 'development';\nexports.mapConfig = {\n    mapBoxToken: process.env.REACT_APP_MAPBOX_TOKEN\n};\nexports.version = process.env.REACT_APP_VERSION;\nexports.endpoints = {\n    graphql: process.env.REACT_APP_GRAPHQL,\n    cdn: process.env.REACT_APP_CDN\n};\nexports.mandatoryMetaColors = [colors_1.red, colors_1.green, colors_1.blue, colors_1.orange, colors_1.purple, colors_1.cyan, colors_1.lime, colors_1.brown];\nexports.redirectUrl = new URL(process.env.PUBLIC_URL.endsWith('/') ? process.env.PUBLIC_URL : process.env.PUBLIC_URL + '/', window.location.origin);\nconsole.log('RedirectUrl', { redirectUrl: exports.redirectUrl, publicUrl: process.env.PUBLIC_URL });\nexports.googleAnalytics = process.env.REACT_APP_GOOGLE_ANALYTICS;\nexports.awsAuth = {\n    Auth: {\n        region: process.env.REACT_APP_AWS_REGION_DEPLOY,\n        userPoolId: process.env.REACT_APP_AWS_USERPOOLID,\n        userPoolWebClientId: process.env.REACT_APP_AWS_USERPOOLWEBCLIENTID,\n        mandatorySignIn: true,\n        oauth: {\n            domain: process.env.REACT_APP_HOSTED_DOMAIN,\n            scope: ['email', 'profile', 'openid'],\n            redirectSignIn: exports.redirectUrl,\n            redirectSignOut: exports.redirectUrl,\n            responseType: 'code'\n        }\n    }\n};\n//# sourceMappingURL=config.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar TextField_1 = __importDefault(require(\"@material-ui/core/TextField\"));\nvar Dialog_1 = __importDefault(require(\"@material-ui/core/Dialog\"));\nvar Typography_1 = __importDefault(require(\"@material-ui/core/Typography\"));\nvar IconButton_1 = __importDefault(require(\"@material-ui/core/IconButton\"));\nvar Share_1 = __importDefault(require(\"@material-ui/icons/Share\"));\nvar Close_1 = __importDefault(require(\"@material-ui/icons/Close\"));\nvar DialogContent_1 = __importDefault(require(\"@material-ui/core/DialogContent\"));\nvar DialogContentText_1 = __importDefault(require(\"@material-ui/core/DialogContentText\"));\nvar DialogTitle_1 = __importDefault(require(\"@material-ui/core/DialogTitle\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar react_share_1 = require(\"react-share\");\nvar useStyles = styles_1.makeStyles(function (theme) { return ({\n    root: {},\n    shareIconTitle: {},\n    shareButtons: {\n        margin: theme.spacing(1, 0),\n        '&>*': {\n            marginRight: theme.spacing(1)\n        }\n    },\n    flexGrow: {\n        flexGrow: 1\n    },\n    dlgTitle: {\n        color: theme.palette.primary.contrastText,\n        backgroundColor: theme.palette.primary.main,\n        display: 'flex'\n    },\n    closeButton: {\n        flex: '0 0'\n    }\n}); });\nvar ShareDialog = function (_a) {\n    var open = _a.open, shareUrl = _a.shareUrl, handleClose = _a.handleClose;\n    var classes = useStyles();\n    return (react_1.default.createElement(Dialog_1.default, { open: open, onClose: handleClose, \"aria-labelledby\": \"form-dialog-title\" },\n        react_1.default.createElement(DialogTitle_1.default, { className: classes.dlgTitle, disableTypography: true },\n            react_1.default.createElement(IconButton_1.default, { color: \"inherit\" },\n                react_1.default.createElement(Share_1.default, { className: classes.shareIconTitle })),\n            react_1.default.createElement(Typography_1.default, { variant: \"h4\", className: classes.flexGrow }, \"Share\"),\n            react_1.default.createElement(\"div\", { className: classes.closeButton },\n                react_1.default.createElement(IconButton_1.default, { onClick: handleClose, color: \"inherit\" },\n                    react_1.default.createElement(Close_1.default, null)))),\n        react_1.default.createElement(DialogContent_1.default, null,\n            react_1.default.createElement(DialogContentText_1.default, null, \"Copy this link and share it using your preferred method.\"),\n            react_1.default.createElement(TextField_1.default, { value: shareUrl, margin: \"dense\", id: \"name\", variant: \"outlined\", fullWidth: true, inputProps: {\n                    onClick: function (e) {\n                        e.preventDefault();\n                        var target = e.target;\n                        target.select();\n                    }\n                } }),\n            react_1.default.createElement(\"div\", { className: classes.shareButtons },\n                react_1.default.createElement(react_share_1.EmailShareButton, { url: shareUrl },\n                    react_1.default.createElement(react_share_1.EmailIcon, { size: 32, round: true })),\n                react_1.default.createElement(react_share_1.TwitterShareButton, { url: shareUrl },\n                    react_1.default.createElement(react_share_1.TwitterIcon, { size: 32, round: true })),\n                react_1.default.createElement(react_share_1.LinkedinShareButton, { url: shareUrl },\n                    react_1.default.createElement(react_share_1.LinkedinIcon, { size: 32, round: true })),\n                react_1.default.createElement(react_share_1.FacebookShareButton, { url: shareUrl, quote: 'title' },\n                    react_1.default.createElement(react_share_1.FacebookIcon, { size: 32, round: true }))))));\n};\nexports.default = ShareDialog;\n//# sourceMappingURL=ShareDialog.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ProjectTreeLayerTileTypes = exports.ProjectTreeLayerTypes = exports.TileTypes = exports.SymbologyStatus = exports.TilingStatus = exports.AccessEnum = exports.WarehouseRoleEnum = exports.FieldTypeEnum = void 0;\nvar FieldTypeEnum;\n(function (FieldTypeEnum) {\n    FieldTypeEnum[\"string\"] = \"S\";\n    FieldTypeEnum[\"number\"] = \"N\";\n    FieldTypeEnum[\"boolean\"] = \"BOOL\";\n    FieldTypeEnum[\"stringArr\"] = \"SARR\";\n    FieldTypeEnum[\"numberArr\"] = \"NARR\";\n})(FieldTypeEnum = exports.FieldTypeEnum || (exports.FieldTypeEnum = {}));\nvar WarehouseRoleEnum;\n(function (WarehouseRoleEnum) {\n    WarehouseRoleEnum[\"SuperUser\"] = \"SUPER\";\n    WarehouseRoleEnum[\"Admin\"] = \"ADMIN\";\n    WarehouseRoleEnum[\"Observer\"] = \"OBSERVER\";\n    WarehouseRoleEnum[\"Participant\"] = \"PARTICIPANT\";\n})(WarehouseRoleEnum = exports.WarehouseRoleEnum || (exports.WarehouseRoleEnum = {}));\nvar AccessEnum;\n(function (AccessEnum) {\n    AccessEnum[\"Public\"] = \"PUBLIC\";\n    AccessEnum[\"Private\"] = \"PRIVATE\";\n    AccessEnum[\"Secret\"] = \"SECRET\";\n})(AccessEnum = exports.AccessEnum || (exports.AccessEnum = {}));\nvar TilingStatus;\n(function (TilingStatus) {\n    TilingStatus[\"QUEUED\"] = \"QUEUED\";\n    TilingStatus[\"UNKNOWN\"] = \"UNKNOWN\";\n    TilingStatus[\"FETCHING\"] = \"FETCHING\";\n    TilingStatus[\"CREATING\"] = \"CREATING\";\n    TilingStatus[\"TILING_ERROR\"] = \"TILING_ERROR\";\n    TilingStatus[\"INDEX_NOT_FOUND\"] = \"INDEX_NOT_FOUND\";\n    TilingStatus[\"LAYER_NOT_FOUND\"] = \"LAYER_NOT_FOUND\";\n    TilingStatus[\"FETCH_ERROR\"] = \"FETCH_ERROR\";\n    TilingStatus[\"SUCCESS\"] = \"SUCCESS\";\n})(TilingStatus = exports.TilingStatus || (exports.TilingStatus = {}));\nvar SymbologyStatus;\n(function (SymbologyStatus) {\n    SymbologyStatus[\"UNKNOWN\"] = \"UNKNOWN\";\n    SymbologyStatus[\"FETCHING\"] = \"FETCHING\";\n    SymbologyStatus[\"MISSING\"] = \"MISSING\";\n    SymbologyStatus[\"NOT_APPLICABLE\"] = \"NOT_APPLICABLE\";\n    SymbologyStatus[\"FOUND\"] = \"FOUND\";\n    SymbologyStatus[\"ERROR\"] = \"ERROR\";\n})(SymbologyStatus = exports.SymbologyStatus || (exports.SymbologyStatus = {}));\nvar TileTypes;\n(function (TileTypes) {\n    TileTypes[\"RASTER\"] = \"RASTER\";\n    TileTypes[\"HTML\"] = \"HTML\";\n    TileTypes[\"VECTOR_SHP\"] = \"VECTOR_SHP\";\n    TileTypes[\"VECTOR_GPKG\"] = \"VECTOR_GPKG\";\n})(TileTypes = exports.TileTypes || (exports.TileTypes = {}));\nvar ProjectTreeLayerTypes;\n(function (ProjectTreeLayerTypes) {\n    ProjectTreeLayerTypes[\"REPORT\"] = \"report\";\n    ProjectTreeLayerTypes[\"RASTER\"] = \"raster\";\n    ProjectTreeLayerTypes[\"LINE\"] = \"line\";\n    ProjectTreeLayerTypes[\"POLYGON\"] = \"polygon\";\n    ProjectTreeLayerTypes[\"POINT\"] = \"point\";\n    ProjectTreeLayerTypes[\"FILE\"] = \"file\";\n    ProjectTreeLayerTypes[\"TIN\"] = \"tin\";\n})(ProjectTreeLayerTypes = exports.ProjectTreeLayerTypes || (exports.ProjectTreeLayerTypes = {}));\nexports.ProjectTreeLayerTileTypes = [\n    ProjectTreeLayerTypes.RASTER,\n    ProjectTreeLayerTypes.POLYGON,\n    ProjectTreeLayerTypes.LINE,\n    ProjectTreeLayerTypes.POINT\n];\n//# sourceMappingURL=types.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar Typography_1 = __importDefault(require(\"@material-ui/core/Typography\"));\nvar Tooltip_1 = __importDefault(require(\"@material-ui/core/Tooltip\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar useStyles = styles_1.makeStyles(function (theme) { return ({\n    root: {\n        marginLeft: theme.spacing(1) / 2\n    },\n    tooltip: {\n        maxWidth: 220\n    }\n}); });\nvar WarehouseTags = function (_a) {\n    var tags = _a.tags, typographyProps = _a.typographyProps;\n    if (!tags)\n        return null;\n    return (react_1.default.createElement(react_1.default.Fragment, null, tags.reduce(function (acc, ts, idx) { return __spreadArray(__spreadArray([], acc), [\n        react_1.default.createElement(Typography_1.default, __assign({ variant: \"caption\" }, typographyProps, { key: \"sep-\" + idx }), idx > 0 && ', '),\n        react_1.default.createElement(Tooltip_1.default, { key: \"whTag-\" + idx, title: react_1.default.createElement(react_1.default.Fragment, null,\n                react_1.default.createElement(Typography_1.default, { variant: \"body1\" },\n                    \"Warehouse Tag: \",\n                    ts),\n                react_1.default.createElement(Typography_1.default, { variant: \"caption\" }, \"Warehouse tags can be added to delineate two identical projects in the warehouse\")) },\n            react_1.default.createElement(Typography_1.default, __assign({ variant: \"caption\", color: \"secondary\" }, typographyProps), ts))\n    ]); }, [])));\n};\nexports.default = WarehouseTags;\n//# sourceMappingURL=WarehouseTags.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar Typography_1 = __importDefault(require(\"@material-ui/core/Typography\"));\nvar Button_1 = __importDefault(require(\"@material-ui/core/Button\"));\nvar IconButton_1 = __importDefault(require(\"@material-ui/core/IconButton\"));\nvar Tooltip_1 = __importDefault(require(\"@material-ui/core/Tooltip\"));\nvar CircularProgress_1 = __importDefault(require(\"@material-ui/core/CircularProgress\"));\nvar CloudDownload_1 = __importDefault(require(\"@material-ui/icons/CloudDownload\"));\nvar moment_1 = __importDefault(require(\"moment\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar useStyles = styles_1.makeStyles(function () { return ({\n    root: {\n        '& *': {\n            cursor: 'pointer'\n        }\n    },\n    disabledButton: {\n        opacity: 0.5\n    }\n}); });\nvar DownloadZipBtn = function (_a) {\n    var title = _a.title, project = _a.project, pendingSince = _a.pendingSince, btnProps = _a.btnProps, downloadZipFile = _a.downloadZipFile;\n    var classes = useStyles();\n    var btnRender = (react_1.default.createElement(Tooltip_1.default, { title: react_1.default.createElement(react_1.default.Fragment, null,\n            react_1.default.createElement(Typography_1.default, { variant: \"body1\" }, \"Download Project Zip\"),\n            react_1.default.createElement(Typography_1.default, { variant: \"caption\", paragraph: true }, \"Click to download this project as a single zip file\"),\n            react_1.default.createElement(Typography_1.default, { variant: \"caption\", paragraph: true }, \"There may be a delay if the zip file needs to be built.\")) }, title ? (react_1.default.createElement(Button_1.default, __assign({ variant: \"contained\", color: \"primary\", onClick: function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            downloadZipFile(project);\n        }, startIcon: react_1.default.createElement(CloudDownload_1.default, null) }, btnProps), title || 'ZIP')) : (react_1.default.createElement(IconButton_1.default, __assign({ color: \"primary\", onClick: function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            downloadZipFile(project);\n        } }, btnProps),\n        react_1.default.createElement(CloudDownload_1.default, null)))));\n    if (pendingSince) {\n        btnRender = (react_1.default.createElement(Tooltip_1.default, { title: react_1.default.createElement(react_1.default.Fragment, null,\n                react_1.default.createElement(Typography_1.default, { variant: \"body1\" }, \"Preparing Zip\"),\n                react_1.default.createElement(Typography_1.default, { variant: \"caption\", paragraph: true }, \"The warehouse is building your zip file for you.\"),\n                react_1.default.createElement(Typography_1.default, { variant: \"caption\", paragraph: true },\n                    \"started \",\n                    moment_1.default(pendingSince, 'x').fromNow())) },\n            react_1.default.createElement(Button_1.default, __assign({ variant: \"outlined\", disableFocusRipple: true, disableRipple: true, disableTouchRipple: true, color: \"primary\", onClick: function (e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                }, className: classes.disabledButton, startIcon: react_1.default.createElement(CircularProgress_1.default, { color: btnProps && btnProps.color && btnProps.color === 'secondary' ? 'primary' : 'secondary', size: 24, thickness: 6 }) }, btnProps), title || 'ZIP')));\n    }\n    return react_1.default.createElement(\"div\", { className: classes.root }, btnRender);\n};\nexports.default = DownloadZipBtn;\n//# sourceMappingURL=DownloadZipBtn.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar Typography_1 = __importDefault(require(\"@material-ui/core/Typography\"));\nvar Button_1 = __importDefault(require(\"@material-ui/core/Button\"));\nvar IconButton_1 = __importDefault(require(\"@material-ui/core/IconButton\"));\nvar Tooltip_1 = __importDefault(require(\"@material-ui/core/Tooltip\"));\nvar Public_1 = __importDefault(require(\"@material-ui/icons/Public\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar __1 = require(\"..\");\nvar useStyles = styles_1.makeStyles(function () { return ({\n    root: {\n        '& *': {\n            cursor: 'pointer'\n        }\n    },\n    disabledButton: {\n        opacity: 0.5\n    }\n}); });\nvar WebRaveBtn = function (_a) {\n    var title = _a.title, project = _a.project, url = _a.url, btnProps = _a.btnProps;\n    var classes = useStyles();\n    if (!url || url.length === 0)\n        return null;\n    var webRaveUrl = url + \"#/\" + project.program + \"/\" + project.id;\n    var btnRender = (react_1.default.createElement(Tooltip_1.default, { title: react_1.default.createElement(react_1.default.Fragment, null,\n            react_1.default.createElement(Typography_1.default, { variant: \"body1\" }, \"Explore using map\"),\n            react_1.default.createElement(Typography_1.default, { variant: \"caption\", paragraph: true }, \"Explore this data set using an online map\")) }, title ? (react_1.default.createElement(Button_1.default, __assign({ variant: \"contained\", onClick: function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            __1.googleAnalytics.event('warehouse', 'open_webrave', 'open_webrave');\n            window.open(webRaveUrl);\n        }, color: \"primary\", startIcon: react_1.default.createElement(Public_1.default, null) }, btnProps), title || 'MAP')) : (react_1.default.createElement(IconButton_1.default, __assign({ color: \"primary\", onClick: function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            __1.googleAnalytics.event('warehouse', 'open_webrave', 'open_webrave');\n            window.open(webRaveUrl);\n        } }, btnProps),\n        react_1.default.createElement(Public_1.default, null)))));\n    return react_1.default.createElement(\"div\", { className: classes.root }, btnRender);\n};\nexports.default = WebRaveBtn;\n//# sourceMappingURL=WebRaveBtn.js.map","\"use strict\";\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.accessColors = void 0;\nvar common_1 = require(\"@riverscapes/common\");\nvar colors_1 = require(\"@material-ui/core/colors\");\nexports.accessColors = (_a = {},\n    _a[common_1.WarehouseRoleEnum.SuperUser] = colors_1.pink,\n    _a[common_1.WarehouseRoleEnum.Admin] = colors_1.red,\n    _a[common_1.WarehouseRoleEnum.Participant] = colors_1.lime,\n    _a[common_1.WarehouseRoleEnum.Observer] = colors_1.blue,\n    _a);\n//# sourceMappingURL=constants.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar Container_1 = __importDefault(require(\"@material-ui/core/Container\"));\nvar Typography_1 = __importDefault(require(\"@material-ui/core/Typography\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar useStyles = styles_1.makeStyles(function (theme) { return ({\n    root: {\n        display: 'flex',\n        zIndex: theme.zIndex.drawer + 1\n    },\n    text: {\n        flexGrow: 1\n    },\n    logo: {}\n}); });\nvar Footer = function (_a) {\n    var version = _a.version;\n    var classes = useStyles();\n    return (react_1.default.createElement(Container_1.default, { className: classes.root, maxWidth: \"md\" },\n        version && (react_1.default.createElement(Typography_1.default, { component: \"div\", className: classes.text, color: \"textSecondary\", variant: \"overline\" },\n            \"v.\",\n            version)),\n        react_1.default.createElement(\"img\", { className: classes.logo, alt: \"footer\", src: process.env.PUBLIC_URL + \"/cc-watermarks-riverscapes_orig.png\" })));\n};\nexports.default = Footer;\n//# sourceMappingURL=Footer.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isDisabled = void 0;\nvar react_1 = __importStar(require(\"react\"));\nvar Toolbar_1 = __importDefault(require(\"@material-ui/core/Toolbar\"));\nvar AppBar_1 = __importDefault(require(\"@material-ui/core/AppBar\"));\nvar Divider_1 = __importDefault(require(\"@material-ui/core/Divider\"));\nvar MenuItem_1 = __importDefault(require(\"@material-ui/core/MenuItem\"));\nvar Menu_1 = __importDefault(require(\"@material-ui/core/Menu\"));\nvar Share_1 = __importDefault(require(\"@material-ui/icons/Share\"));\nvar SupervisorAccount_1 = __importDefault(require(\"@material-ui/icons/SupervisorAccount\"));\nvar ListAlt_1 = __importDefault(require(\"@material-ui/icons/ListAlt\"));\nvar IconButton_1 = __importDefault(require(\"@material-ui/core/IconButton\"));\nvar MoreVert_1 = __importDefault(require(\"@material-ui/icons/MoreVert\"));\nvar common_1 = require(\"@riverscapes/common\");\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar core_1 = require(\"@material-ui/core\");\nvar Topbar_style_1 = __importDefault(require(\"./Topbar.style\"));\nvar ShareDialog_1 = __importDefault(require(\"../modals/ShareDialog\"));\nvar config_1 = require(\"../config\");\nvar useStyles = styles_1.makeStyles(Topbar_style_1.default);\nfunction isDisabled(prog) {\n    if (prog.meta && prog.meta.access && prog.meta.access === 'PUBLIC')\n        return false;\n    return prog.role === null;\n}\nexports.isDisabled = isDisabled;\nvar TopBar = function (_a) {\n    var title = _a.title, program = _a.program, programs = _a.programs, signOutHandler = _a.signOutHandler, toolbarItems = _a.toolbarItems, shareUrl = _a.shareUrl, history = _a.history;\n    var classes = useStyles();\n    var _b = react_1.useState(false), shareOpen = _b[0], setShareOpen = _b[1];\n    var _c = react_1.useState(null), mobileMoreAnchorEl = _c[0], setMobileMoreAnchorEl = _c[1];\n    var handleMobileMenuClose = function () { return setMobileMoreAnchorEl(null); };\n    var handleShareMenuOpen = function () { return setShareOpen(true); };\n    var handleNavigate = function (nm) {\n        handleMobileMenuClose();\n        if (history)\n            history.push(\"/\" + nm.machineName);\n    };\n    var isAdmin = history && history.location.pathname.indexOf('/admin') > -1;\n    var handleAdmin = function () {\n        if (history) {\n            if (isAdmin)\n                history.push(\"/\" + program.machineName);\n            else\n                history.push(\"/\" + program.machineName + \"/admin\");\n        }\n    };\n    var handleMobileMenuOpen = function (event) { return setMobileMoreAnchorEl(event.currentTarget); };\n    var renderMobileMenu = (signOutHandler || programs) && (react_1.default.createElement(Menu_1.default, { anchorEl: mobileMoreAnchorEl, anchorOrigin: { vertical: 'top', horizontal: 'right' }, keepMounted: true, transformOrigin: { vertical: 'top', horizontal: 'right' }, open: !!mobileMoreAnchorEl, onClose: handleMobileMenuClose },\n        programs && (react_1.default.createElement(MenuItem_1.default, null,\n            react_1.default.createElement(core_1.Typography, { variant: \"overline\", onClick: function () { return history.push(\"/\"); } }, \"Programs\"))),\n        programs && react_1.default.createElement(Divider_1.default, null),\n        programs &&\n            programs.length > 0 &&\n            programs.map(function (prog, idx) { return (react_1.default.createElement(MenuItem_1.default, { disabled: (program && program.machineName === prog.machineName) || isDisabled(prog), key: \"prog-\" + idx, onClick: function () { return handleNavigate(prog); }, value: prog.machineName }, prog.name)); }),\n        signOutHandler && react_1.default.createElement(Divider_1.default, null),\n        signOutHandler && react_1.default.createElement(MenuItem_1.default, { onClick: signOutHandler }, \"Log Out\")));\n    var showAdmin = program && (program.role === common_1.WarehouseRoleEnum.Admin || program.role === common_1.WarehouseRoleEnum.SuperUser);\n    return (react_1.default.createElement(react_1.default.Fragment, null,\n        react_1.default.createElement(AppBar_1.default, { position: \"static\", className: classes.appBar },\n            react_1.default.createElement(Toolbar_1.default, { className: classes.root, disableGutters: true },\n                react_1.default.createElement(\"a\", { href: \"http://riverscapes.xyz/\" },\n                    react_1.default.createElement(\"img\", { className: classes.logo, src: 'https://riverscapes.xyz/assets/images/RiverscapesLogo.png', alt: \"logo\" })),\n                program ? (react_1.default.createElement(\"div\", null,\n                    react_1.default.createElement(core_1.Typography, { variant: \"subtitle1\" }, program.name),\n                    react_1.default.createElement(core_1.Typography, { variant: \"caption\" }, title))) : (react_1.default.createElement(core_1.Typography, { variant: \"subtitle1\" }, title)),\n                react_1.default.createElement(\"div\", { className: classes.spacer }),\n                config_1.version && (react_1.default.createElement(core_1.Typography, { component: \"div\", className: classes.text, color: \"inherit\", variant: \"overline\" },\n                    \"v.\",\n                    config_1.version)),\n                showAdmin && (react_1.default.createElement(IconButton_1.default, { \"aria-haspopup\": \"true\", onClick: handleAdmin, color: \"inherit\" }, isAdmin ? react_1.default.createElement(ListAlt_1.default, null) : react_1.default.createElement(SupervisorAccount_1.default, null))),\n                toolbarItems,\n                shareUrl && (react_1.default.createElement(IconButton_1.default, { \"aria-haspopup\": \"true\", onClick: handleShareMenuOpen, color: \"inherit\" },\n                    react_1.default.createElement(Share_1.default, null))),\n                (signOutHandler || programs) && (react_1.default.createElement(IconButton_1.default, { \"aria-haspopup\": \"true\", onClick: handleMobileMenuOpen, color: \"inherit\" },\n                    react_1.default.createElement(MoreVert_1.default, null))))),\n        renderMobileMenu,\n        react_1.default.createElement(ShareDialog_1.default, { open: shareOpen, shareUrl: shareUrl, handleClose: function () { return setShareOpen(false); } })));\n};\nexports.default = TopBar;\n//# sourceMappingURL=Topbar.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.verifyMeta = exports.augmentXML = exports.parseProjectXML = exports.parseProgramXML = exports.parseXMLMeta = exports.getXML = void 0;\nvar xml2js_1 = require(\"xml2js\");\nvar axios_1 = __importDefault(require(\"axios\"));\nvar _1 = require(\"./\");\nvar xmldom_1 = __importDefault(require(\"xmldom\"));\nfunction getXML(url) {\n    return __awaiter(this, void 0, void 0, function () {\n        var result;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, axios_1.default({\n                        url: url,\n                        method: 'get'\n                    })];\n                case 1:\n                    result = _a.sent();\n                    if (!result.data)\n                        throw new Error('Error retrieving XML file');\n                    return [2, result.data];\n            }\n        });\n    });\n}\nexports.getXML = getXML;\nfunction parseXMLMeta(metaArr) {\n    try {\n        return metaArr.reduce(function (acc, _a) {\n            var _b;\n            var $ = _a.$, _ = _a._;\n            return (__assign(__assign({}, acc), (_b = {}, _b[$.name] = _ && _.trim(), _b)));\n        }, {});\n    }\n    catch (_a) {\n        return {};\n    }\n}\nexports.parseXMLMeta = parseXMLMeta;\nfunction _recursePaths(xmlDom, products, groups, collections) {\n    var HierarchyNode = xmlDom.getElementsByTagName('Hierarchy')[0];\n    var productsInHierarchy = Array.from(HierarchyNode.getElementsByTagName('Product'));\n    var retVal = [];\n    productsInHierarchy.forEach(function (prodEl) {\n        var pathArr = [];\n        var ref = prodEl.getAttribute('ref');\n        var product = products.find(function (o) { return o.id === ref; });\n        if (!product)\n            throw new Error(\"Product not found for ref='\" + ref + \"'\");\n        var currEl = prodEl.parentNode;\n        var _loop_1 = function () {\n            var ref_1 = currEl.getAttribute('ref');\n            var tag = currEl.tagName;\n            var def = tag === 'Group' ? groups.find(function (g) { return g.id === ref_1; }) : collections.find(function (g) { return g.id === ref_1; });\n            var folder = def.folder, name_1 = def.name;\n            pathArr.push({\n                type: tag,\n                id: ref_1,\n                folder: folder,\n                name: name_1\n            });\n            currEl = currEl.parentNode;\n        };\n        while (currEl && currEl.parentNode && currEl.tagName !== 'Hierarchy') {\n            _loop_1();\n        }\n        retVal.push(__assign(__assign({}, product), { pathArr: pathArr.reverse() }));\n    });\n    return retVal;\n}\nfunction parseProgramXML(rawXML) {\n    return __awaiter(this, void 0, void 0, function () {\n        var parsedProgramJSON, _a, projectFile, projectXSDs, meta, collections, groups, productsRaw, xmlDom, products;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0: return [4, xml2js_1.parseStringPromise(rawXML).catch(function (err) {\n                        throw new _1.ValidationError('Error parsing XML file. This likely means a broken or unclosed tag.', [err.message]);\n                    })];\n                case 1:\n                    parsedProgramJSON = _b.sent();\n                    _a = parseXMLMeta(parsedProgramJSON.Program.MetaData[0].Meta), projectFile = _a.projectFile, projectXSDs = _a.projectXSDs, meta = __rest(_a, [\"projectFile\", \"projectXSDs\"]);\n                    collections = parsedProgramJSON.Program.Definitions[0].Collections[0].Collection.map(function (_a) {\n                        var $ = _a.$, Allow = _a.Allow, AllowRegex = _a.AllowRegex;\n                        return (__assign(__assign({}, $), { Allow: Allow ? (Array.isArray(Allow) ? Allow.map(function (a) { return a.$; }) : [Allow]) : undefined, AllowRegex: AllowRegex\n                                ? Array.isArray(AllowRegex)\n                                    ? AllowRegex.map(function (a) { return a.$.pattern; })\n                                    : [AllowRegex.pattern]\n                                : undefined }));\n                    });\n                    groups = [];\n                    if (parsedProgramJSON.Program.Definitions[0].Groups[0].Group) {\n                        if (Array.isArray(parsedProgramJSON.Program.Definitions[0].Groups[0].Group))\n                            groups = parsedProgramJSON.Program.Definitions[0].Groups[0].Group.map(function (a) { return a.$; });\n                        else\n                            groups = [parsedProgramJSON.Program.Definitions[0].Groups[0].Group];\n                    }\n                    productsRaw = [];\n                    if (parsedProgramJSON.Program.Definitions[0].Products[0].Product) {\n                        if (Array.isArray(parsedProgramJSON.Program.Definitions[0].Products[0].Product))\n                            productsRaw = parsedProgramJSON.Program.Definitions[0].Products[0].Product.map(function (a) { return a.$; });\n                        else\n                            productsRaw = [parsedProgramJSON.Program.Definitions[0].Products[0].Product];\n                    }\n                    xmlDom = new xmldom_1.default.DOMParser().parseFromString(rawXML);\n                    products = _recursePaths(xmlDom, productsRaw, groups, collections);\n                    return [2, Promise.resolve(new _1.Program({\n                            name: parsedProgramJSON.Program.Name[0],\n                            machineName: parsedProgramJSON.Program.MachineName[0],\n                            projectXSDs: projectXSDs,\n                            projectFile: projectFile,\n                            meta: meta,\n                            products: products,\n                            collections: collections,\n                            groups: groups\n                        }))];\n            }\n        });\n    });\n}\nexports.parseProgramXML = parseProgramXML;\nfunction parseProjectXML(rawXML) {\n    return __awaiter(this, void 0, void 0, function () {\n        var parsedProjectJSON, retVal, whMeta, meta;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, xml2js_1.parseStringPromise(rawXML).catch(function (err) {\n                        throw new _1.ValidationError('Error parsing XML file. This likely means a broken or unclosed tag.', [err.message]);\n                    })];\n                case 1:\n                    parsedProjectJSON = _a.sent();\n                    retVal = parsedProjectJSON.Project;\n                    whMeta = {};\n                    if (retVal.Warehouse) {\n                        whMeta = parseXMLMeta(retVal.Warehouse[0].Meta);\n                    }\n                    meta = {};\n                    if (retVal.MetaData) {\n                        meta = parseXMLMeta(retVal.MetaData[0].Meta);\n                    }\n                    return [2, Promise.resolve({\n                            id: whMeta.id,\n                            name: retVal.Name[0],\n                            projType: retVal.ProjectType[0],\n                            Warehouse: whMeta,\n                            program: whMeta.program,\n                            meta: meta,\n                            tags: _1.Project.parseTagString(whMeta.tags),\n                            xml: rawXML,\n                            parsedProjectJSON: parsedProjectJSON,\n                            rawXML: rawXML\n                        })];\n            }\n        });\n    });\n}\nexports.parseProjectXML = parseProjectXML;\nfunction augmentXML(newMeta, xmlfile) {\n    var parsed = new xmldom_1.default.DOMParser().parseFromString(xmlfile);\n    var metadata = parsed.getElementsByTagName('MetaData')[0];\n    if (parsed.getElementsByTagName('Warehouse').length > 0) {\n        parsed.removeChild(parsed.getElementsByTagName('Warehouse')[0]);\n    }\n    var warehouseNode = parsed.createElement('Warehouse');\n    Object.keys(newMeta).forEach(function (k) {\n        var mNode = parsed.createElement('Meta');\n        mNode.setAttribute('name', k);\n        mNode.appendChild(parsed.createTextNode(newMeta[k]));\n        warehouseNode.appendChild(mNode);\n    });\n    parsed.insertBefore(warehouseNode, metadata);\n    var formatted = new xmldom_1.default.XMLSerializer().serializeToString(parsed);\n    return formatted;\n}\nexports.augmentXML = augmentXML;\nfunction verifyMeta(projType, projectMeta, program) {\n    var projectDef = program.products.find(function (p) { return p.id === projType; });\n    if (!projectDef) {\n        throw new Error(\"No project type '\" + projType + \"' found in program '\" + program.name + \"'\");\n    }\n    var collectionathArrs = projectDef.pathArr.filter(function (f) { return f.type === 'Collection'; });\n    return collectionathArrs.map(function (arrEl) { return ({\n        name: arrEl.name,\n        value: projectMeta[arrEl.name]\n    }); });\n}\nexports.verifyMeta = verifyMeta;\n//# sourceMappingURL=xml.js.map","\"use strict\";\nvar __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.adminGetUsers = exports.adminUpdateUserPermissions = exports.search = exports.deleteProject = exports.downloadZipFile = exports.getWebSymbology = exports.getLayerTiles = exports.downloadFile = exports.getUploadUrls = exports.getProject = exports.getProgram = exports.getPrograms = exports.validateProjectXML = exports.authCheck = exports.apiCall = void 0;\nvar axios_1 = __importDefault(require(\"axios\"));\nvar graphql_1 = require(\"graphql\");\nvar graphql_tag_1 = __importDefault(require(\"graphql-tag\"));\nvar loglevel_1 = __importDefault(require(\"loglevel\"));\nvar _1 = require(\"./\");\nvar apiCall = function (url, jwt, query, variables) {\n    return axios_1.default({\n        url: url,\n        method: 'post',\n        headers: jwt\n            ? {\n                Authorization: \"Bearer \" + jwt\n            }\n            : null,\n        data: {\n            query: graphql_1.print(query),\n            variables: variables\n        }\n    })\n        .then(function (_a) {\n        var axiosData = _a.data;\n        return axiosData;\n    })\n        .catch(function (err) {\n        if (err.response && err.response.status === 404) {\n            throw new Error(\"API Url not found: \" + url);\n        }\n        else if (err.code && err.code === 'ECONNREFUSED') {\n            throw new Error(\"Connection refused. Could not contact: '\" + url + \"'\");\n        }\n        else {\n            loglevel_1.default.error('apiCall Error', { url: url, jwt: jwt, query: graphql_1.print(query), variables: variables, err: err });\n            throw err;\n        }\n    });\n};\nexports.apiCall = apiCall;\nfunction authCheck(url, jwt) {\n    return exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n            query AuthCall {\\n                auth {\\n                    loggedIn\\n                    userPool\\n                    clientId\\n                    region\\n                    domain\\n                }\\n            }\\n        \"], [\"\\n            query AuthCall {\\n                auth {\\n                    loggedIn\\n                    userPool\\n                    clientId\\n                    region\\n                    domain\\n                }\\n            }\\n        \"]))), {});\n}\nexports.authCheck = authCheck;\nfunction validateProjectXML(url, jwt, xml, projType, program) {\n    return exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n            query validateProject($xml: String!, $projType: String!, $program: String!) {\\n                validate(xml: $xml, projType: $projType, program: $program) {\\n                    result\\n                    xmlErrors\\n                }\\n            }\\n        \"], [\"\\n            query validateProject($xml: String!, $projType: String!, $program: String!) {\\n                validate(xml: $xml, projType: $projType, program: $program) {\\n                    result\\n                    xmlErrors\\n                }\\n            }\\n        \"]))), { xml: xml, program: program, projType: projType });\n}\nexports.validateProjectXML = validateProjectXML;\nfunction getPrograms(url, jwt) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n            query programs {\\n                programs {\\n                    name\\n                    machineName\\n                    projectXSDs\\n                    projectFile\\n                    role\\n                    groups {\\n                        id\\n                        name\\n                        folder\\n                    }\\n                    collections {\\n                        id\\n                        name\\n                        AllowRegex\\n                        Allow {\\n                            id\\n                            name\\n                            aliases\\n                            folder\\n                        }\\n                    }\\n                    products {\\n                        id\\n                        name\\n                        folder\\n                        pathArr\\n                    }\\n                    hierarchy\\n                    meta\\n                }\\n            }\\n        \"], [\"\\n            query programs {\\n                programs {\\n                    name\\n                    machineName\\n                    projectXSDs\\n                    projectFile\\n                    role\\n                    groups {\\n                        id\\n                        name\\n                        folder\\n                    }\\n                    collections {\\n                        id\\n                        name\\n                        AllowRegex\\n                        Allow {\\n                            id\\n                            name\\n                            aliases\\n                            folder\\n                        }\\n                    }\\n                    products {\\n                        id\\n                        name\\n                        folder\\n                        pathArr\\n                    }\\n                    hierarchy\\n                    meta\\n                }\\n            }\\n        \"])))).then(function (gqlReturn) {\n                    return __assign(__assign({}, gqlReturn), { data: {\n                            programs: gqlReturn.data.programs.map(_1.Program.fromGraphQL)\n                        } });\n                })];\n        });\n    });\n}\nexports.getPrograms = getPrograms;\nfunction getProgram(url, jwt, programName) {\n    return __awaiter(this, void 0, void 0, function () {\n        var _a, program, errors;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0: return [4, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"\\n            query program($program: String!) {\\n                program(program: $program) {\\n                    name\\n                    machineName\\n                    projectXSDs\\n                    projectFile\\n                    role\\n                    groups {\\n                        id\\n                        name\\n                        folder\\n                    }\\n                    collections {\\n                        id\\n                        name\\n                        AllowRegex\\n                        Allow {\\n                            id\\n                            name\\n                            aliases\\n                            folder\\n                        }\\n                    }\\n                    products {\\n                        id\\n                        name\\n                        folder\\n                        pathArr\\n                    }\\n                    hierarchy\\n                    meta\\n                }\\n            }\\n        \"], [\"\\n            query program($program: String!) {\\n                program(program: $program) {\\n                    name\\n                    machineName\\n                    projectXSDs\\n                    projectFile\\n                    role\\n                    groups {\\n                        id\\n                        name\\n                        folder\\n                    }\\n                    collections {\\n                        id\\n                        name\\n                        AllowRegex\\n                        Allow {\\n                            id\\n                            name\\n                            aliases\\n                            folder\\n                        }\\n                    }\\n                    products {\\n                        id\\n                        name\\n                        folder\\n                        pathArr\\n                    }\\n                    hierarchy\\n                    meta\\n                }\\n            }\\n        \"]))), { program: programName })];\n                case 1:\n                    _a = _b.sent(), program = _a.data.program, errors = _a.errors;\n                    return [2, {\n                            data: {\n                                program: _1.Program.fromGraphQL(program)\n                            },\n                            errors: errors\n                        }];\n            }\n        });\n    });\n}\nexports.getProgram = getProgram;\nfunction getProject(url, jwt, id, program, files, tree) {\n    if (files === void 0) { files = false; }\n    if (tree === void 0) { tree = false; }\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_5 || (templateObject_5 = __makeTemplateObject([\"\\n            query getProject($id: ID!, $program: String!) {\\n                project(id: $id, program: $program) {\\n                    id\\n                    name\\n                    projType\\n                    totalSize\\n                    program\\n                    tags\\n                    createdBy\\n                    updatedBy\\n                    createdOn\\n                    updatedOn\\n                    meta\\n                    \", \"\\n                    \", \"\\n                }\\n            }\\n        \"], [\"\\n            query getProject($id: ID!, $program: String!) {\\n                project(id: $id, program: $program) {\\n                    id\\n                    name\\n                    projType\\n                    totalSize\\n                    program\\n                    tags\\n                    createdBy\\n                    updatedBy\\n                    createdOn\\n                    updatedOn\\n                    meta\\n                    \",\n                    \"\\n                    \",\n                    \"\\n                }\\n            }\\n        \"])), files\n                    ? \"\\n                    files {\\n                        key\\n                        md5\\n                        size\\n                        downloadUrl\\n                    }\"\n                    : '', tree\n                    ? \"\\n                        tree {\\n                            name\\n                            description\\n                            projectType\\n                            metaStr\\n                            leaves {\\n                                id\\n                                pid\\n                                label\\n                                layerId\\n                                blLayerId\\n                                layerType\\n                                layerPath\\n                                layerName\\n                                nodeExists\\n                                metaStr\\n                                symbology\\n                                transparency\\n                            }\\n                            branches {\\n                                label\\n                                collapsed\\n                                bid\\n                                pid\\n                            }\\n                            defaultView\\n                            views  {\\n                                id\\n                                name\\n                                description\\n                                layers{\\n                                id\\n                                visible\\n                                }\\n                            }\\n                        }\\n                    \"\n                    : ''), { id: id, program: program }).then(function (gqlReturn) { return (__assign(__assign({}, gqlReturn), { data: {\n                        project: _1.Project.fromGraphQL(gqlReturn.data.project)\n                    } })); })];\n        });\n    });\n}\nexports.getProject = getProject;\nfunction getUploadUrls(url, jwt, id, fileList, projectType, program) {\n    return __awaiter(this, void 0, void 0, function () {\n        var response;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_6 || (templateObject_6 = __makeTemplateObject([\"\\n            query requestUploadProject($id: ID, $files: [String!], $program: String!, $projectType: String!) {\\n                requestUpload(id: $id, files: $files, program: $program, projectType: $projectType) {\\n                    id\\n                    uploadUrls {\\n                        url\\n                        fields\\n                        origPath\\n                    }\\n                }\\n            }\\n        \"], [\"\\n            query requestUploadProject($id: ID, $files: [String!], $program: String!, $projectType: String!) {\\n                requestUpload(id: $id, files: $files, program: $program, projectType: $projectType) {\\n                    id\\n                    uploadUrls {\\n                        url\\n                        fields\\n                        origPath\\n                    }\\n                }\\n            }\\n        \"]))), { id: id, files: fileList, projectType: projectType, program: program })];\n                case 1:\n                    response = _a.sent();\n                    return [2, response];\n            }\n        });\n    });\n}\nexports.getUploadUrls = getUploadUrls;\nfunction downloadFile(url, jwt, projType, program, id, filePath) {\n    return __awaiter(this, void 0, void 0, function () {\n        var response;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_7 || (templateObject_7 = __makeTemplateObject([\"\\n            query downloadFileQuery($program: String!, $id: ID!, $projType: String!, $filePath: String!) {\\n                downloadFile(program: $program, id: $id, projType: $projType, filePath: $filePath) {\\n                    key\\n                    md5\\n                    contentType\\n                    size\\n                    downloadUrl\\n                }\\n            }\\n        \"], [\"\\n            query downloadFileQuery($program: String!, $id: ID!, $projType: String!, $filePath: String!) {\\n                downloadFile(program: $program, id: $id, projType: $projType, filePath: $filePath) {\\n                    key\\n                    md5\\n                    contentType\\n                    size\\n                    downloadUrl\\n                }\\n            }\\n        \"]))), { projType: projType, program: program, id: id, filePath: filePath })];\n                case 1:\n                    response = _a.sent();\n                    return [2, response];\n            }\n        });\n    });\n}\nexports.downloadFile = downloadFile;\nfunction getLayerTiles(url, jwt, projType, program, id, layerPath) {\n    return __awaiter(this, void 0, void 0, function () {\n        var res, retVal;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_8 || (templateObject_8 = __makeTemplateObject([\"\\n            query getLayerTilesQuery($program: String!, $id: ID!, $projType: String!, $layerPath: String!) {\\n                getLayerTiles(program: $program, id: $id, projType: $projType, layerPath: $layerPath) {\\n                    url\\n                    indexUrl\\n                    status\\n                    lastStatus\\n                    error\\n                    rsLayer\\n                    rasterStats\\n                    started\\n                    duration\\n                    format\\n                    bounds\\n                    maxZoom\\n                    minZoom\\n                    originFile {\\n                        lastModified\\n                        etag\\n                        size\\n                        key\\n                    }\\n                }\\n            }\\n        \"], [\"\\n            query getLayerTilesQuery($program: String!, $id: ID!, $projType: String!, $layerPath: String!) {\\n                getLayerTiles(program: $program, id: $id, projType: $projType, layerPath: $layerPath) {\\n                    url\\n                    indexUrl\\n                    status\\n                    lastStatus\\n                    error\\n                    rsLayer\\n                    rasterStats\\n                    started\\n                    duration\\n                    format\\n                    bounds\\n                    maxZoom\\n                    minZoom\\n                    originFile {\\n                        lastModified\\n                        etag\\n                        size\\n                        key\\n                    }\\n                }\\n            }\\n        \"]))), { projType: projType, program: program, id: id, layerPath: layerPath })];\n                case 1:\n                    res = _a.sent();\n                    if (!res.data)\n                        return [2, { errors: res.errors }];\n                    else {\n                        retVal = res.data.getLayerTiles;\n                        return [2, {\n                                errors: res.errors,\n                                data: {\n                                    getLayerTiles: __assign(__assign({}, retVal), { started: retVal && retVal.started && parseInt(retVal.started, 10), lastStatus: retVal && retVal.lastStatus && parseInt(retVal.lastStatus, 10), rasterStats: retVal && retVal.rasterStats && JSON.parse(retVal.rasterStats), rsLayer: retVal && retVal.rsLayer && JSON.parse(retVal.rsLayer), originFile: retVal &&\n                                            retVal.originFile && __assign(__assign({}, retVal.originFile), { lastModified: parseInt(retVal.originFile.lastModified, 10) }) })\n                                }\n                            }];\n                    }\n                    return [2];\n            }\n        });\n    });\n}\nexports.getLayerTiles = getLayerTiles;\nfunction getWebSymbology(url, jwt, projType, name, isRaster) {\n    return __awaiter(this, void 0, void 0, function () {\n        var res;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_9 || (templateObject_9 = __makeTemplateObject([\"\\n            query getWebSymbology($projType: String!, $name: String!, $isRaster: Boolean) {\\n                getWebSymbology(projType: $projType, name: $name, isRaster: $isRaster) {\\n                    name\\n                    symbologyJSON\\n                    colorRamp\\n                    url\\n                    error\\n                }\\n            }\\n        \"], [\"\\n            query getWebSymbology($projType: String!, $name: String!, $isRaster: Boolean) {\\n                getWebSymbology(projType: $projType, name: $name, isRaster: $isRaster) {\\n                    name\\n                    symbologyJSON\\n                    colorRamp\\n                    url\\n                    error\\n                }\\n            }\\n        \"]))), { projType: projType, name: name, isRaster: isRaster })];\n                case 1:\n                    res = _a.sent();\n                    if (!res.data)\n                        return [2, { errors: res.errors }];\n                    else {\n                        return [2, {\n                                errors: res.errors,\n                                data: {\n                                    getWebSymbology: res.data.getWebSymbology && __assign(__assign({}, res.data.getWebSymbology), { symbologyJSON: res.data.getWebSymbology.symbologyJSON && JSON.parse(res.data.getWebSymbology.symbologyJSON) })\n                                }\n                            }];\n                    }\n                    return [2];\n            }\n        });\n    });\n}\nexports.getWebSymbology = getWebSymbology;\nfunction downloadZipFile(url, jwt, projType, program, id) {\n    return __awaiter(this, void 0, void 0, function () {\n        var response;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_10 || (templateObject_10 = __makeTemplateObject([\"\\n            query downloadZipFileQuery($program: String!, $id: ID!, $projType: String!) {\\n                downloadZip(program: $program, id: $id, projType: $projType) {\\n                    key\\n                    md5\\n                    contentType\\n                    size\\n                    downloadUrl\\n                    pendingSince\\n                }\\n            }\\n        \"], [\"\\n            query downloadZipFileQuery($program: String!, $id: ID!, $projType: String!) {\\n                downloadZip(program: $program, id: $id, projType: $projType) {\\n                    key\\n                    md5\\n                    contentType\\n                    size\\n                    downloadUrl\\n                    pendingSince\\n                }\\n            }\\n        \"]))), { projType: projType, program: program, id: id })];\n                case 1:\n                    response = _a.sent();\n                    return [2, response];\n            }\n        });\n    });\n}\nexports.downloadZipFile = downloadZipFile;\nfunction deleteProject(url, jwt, id, program) {\n    return __awaiter(this, void 0, void 0, function () {\n        var response;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_11 || (templateObject_11 = __makeTemplateObject([\"\\n            mutation deleteProject($id: ID!, $program: String!) {\\n                deleteProject(id: $id, program: $program)\\n            }\\n        \"], [\"\\n            mutation deleteProject($id: ID!, $program: String!) {\\n                deleteProject(id: $id, program: $program)\\n            }\\n        \"]))), { program: program, id: id })];\n                case 1:\n                    response = _a.sent();\n                    return [2, response];\n            }\n        });\n    });\n}\nexports.deleteProject = deleteProject;\nfunction search(url, jwt, program, params) {\n    return __awaiter(this, void 0, void 0, function () {\n        var res, _a, nextToken, projects, total;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0: return [4, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_12 || (templateObject_12 = __makeTemplateObject([\"\\n            query searchQuery(\\n                $program: String!\\n                $projType: String\\n                $nameStr: String\\n                $metaStr: String\\n                $metaArr: String\\n                $tags: String\\n                $noTags: Boolean\\n                $limit: Int\\n                $nextToken: Int\\n            ) {\\n                search(\\n                    program: $program\\n                    projType: $projType\\n                    nameStr: $nameStr\\n                    metaStr: $metaStr\\n                    metaArr: $metaArr\\n                    tags: $tags\\n                    noTags: $noTags\\n                    limit: $limit\\n                    nextToken: $nextToken\\n                ) {\\n                    projects {\\n                        id\\n                        name\\n                        projType\\n                        program\\n                        tags\\n                        totalSize\\n                        createdBy\\n                        updatedBy\\n                        createdOn\\n                        updatedOn\\n                        meta\\n                        score\\n                    }\\n                    nextToken\\n                    total\\n                }\\n            }\\n        \"], [\"\\n            query searchQuery(\\n                $program: String!\\n                $projType: String\\n                $nameStr: String\\n                $metaStr: String\\n                $metaArr: String\\n                $tags: String\\n                $noTags: Boolean\\n                $limit: Int\\n                $nextToken: Int\\n            ) {\\n                search(\\n                    program: $program\\n                    projType: $projType\\n                    nameStr: $nameStr\\n                    metaStr: $metaStr\\n                    metaArr: $metaArr\\n                    tags: $tags\\n                    noTags: $noTags\\n                    limit: $limit\\n                    nextToken: $nextToken\\n                ) {\\n                    projects {\\n                        id\\n                        name\\n                        projType\\n                        program\\n                        tags\\n                        totalSize\\n                        createdBy\\n                        updatedBy\\n                        createdOn\\n                        updatedOn\\n                        meta\\n                        score\\n                    }\\n                    nextToken\\n                    total\\n                }\\n            }\\n        \"]))), __assign(__assign({}, params), { program: program }))];\n                case 1:\n                    res = _b.sent();\n                    if (!res.data)\n                        return [2, { errors: res.errors }];\n                    else {\n                        _a = res.data.search || {}, nextToken = _a.nextToken, projects = _a.projects, total = _a.total;\n                        return [2, {\n                                errors: res.errors,\n                                data: {\n                                    search: {\n                                        projects: Array.isArray(projects) ? projects.map(_1.Project.fromGraphQL) : projects,\n                                        nextToken: nextToken,\n                                        total: total\n                                    }\n                                }\n                            }];\n                    }\n                    return [2];\n            }\n        });\n    });\n}\nexports.search = search;\nfunction adminUpdateUserPermissions(url, jwt, id, program, permission) {\n    return __awaiter(this, void 0, void 0, function () {\n        var response;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_13 || (templateObject_13 = __makeTemplateObject([\"\\n            mutation project($id: ID!, $program: String!, $permission: String) {\\n                updateUser(id: $id, program: $program, permission: $permission) {\\n                    email\\n                    name\\n                    picture\\n                    username\\n                    createdOn\\n                    updatedOn\\n                    role\\n                }\\n            }\\n        \"], [\"\\n            mutation project($id: ID!, $program: String!, $permission: String) {\\n                updateUser(id: $id, program: $program, permission: $permission) {\\n                    email\\n                    name\\n                    picture\\n                    username\\n                    createdOn\\n                    updatedOn\\n                    role\\n                }\\n            }\\n        \"]))), { program: program, id: id, permission: permission })];\n                case 1:\n                    response = _a.sent();\n                    if (!response.data)\n                        return [2, { errors: response.errors }];\n                    else {\n                        return [2, {\n                                errors: response.errors,\n                                data: {\n                                    updateUser: response.data.updateUser\n                                        ? __assign(__assign({}, response.data.updateUser), { createdOn: parseInt(response.data.updateUser.createdOn, 10), updatedOn: parseInt(response.data.updateUser.updatedOn, 10) }) : null\n                                }\n                            }];\n                    }\n                    return [2];\n            }\n        });\n    });\n}\nexports.adminUpdateUserPermissions = adminUpdateUserPermissions;\nfunction adminGetUsers(url, jwt, program, limit, nextToken) {\n    return __awaiter(this, void 0, void 0, function () {\n        var response, _a, nextTokenNEW, users;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0: return [4, exports.apiCall(url, jwt, graphql_tag_1.default(templateObject_14 || (templateObject_14 = __makeTemplateObject([\"\\n            query getUsers($program: String!, $limit: Int, $nextToken: String) {\\n                getUsers(program: $program, limit: $limit, nextToken: $nextToken) {\\n                    users {\\n                        email\\n                        name\\n                        picture\\n                        username\\n                        createdOn\\n                        updatedOn\\n                        role\\n                    }\\n                    nextToken\\n                }\\n            }\\n        \"], [\"\\n            query getUsers($program: String!, $limit: Int, $nextToken: String) {\\n                getUsers(program: $program, limit: $limit, nextToken: $nextToken) {\\n                    users {\\n                        email\\n                        name\\n                        picture\\n                        username\\n                        createdOn\\n                        updatedOn\\n                        role\\n                    }\\n                    nextToken\\n                }\\n            }\\n        \"]))), { program: program, limit: limit, nextToken: nextToken })];\n                case 1:\n                    response = _b.sent();\n                    if (!response.data)\n                        return [2, { errors: response.errors }];\n                    else {\n                        _a = response.data.getUsers || {}, nextTokenNEW = _a.nextToken, users = _a.users;\n                        return [2, {\n                                errors: response.errors,\n                                data: {\n                                    getUsers: {\n                                        users: Array.isArray(users)\n                                            ? users.map(function (u) { return (__assign(__assign({}, u), { createdOn: parseInt(u.createdOn, 10), updatedOn: parseInt(u.updatedOn, 10) })); })\n                                            : users,\n                                        nextToken: nextTokenNEW\n                                    }\n                                }\n                            }];\n                    }\n                    return [2];\n            }\n        });\n    });\n}\nexports.adminGetUsers = adminGetUsers;\nvar templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8, templateObject_9, templateObject_10, templateObject_11, templateObject_12, templateObject_13, templateObject_14;\n//# sourceMappingURL=api.js.map","\"use strict\";\nvar __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar graphql_tag_1 = __importDefault(require(\"graphql-tag\"));\nvar types_1 = require(\"./types\");\nvar typeDefs = graphql_tag_1.default(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n    # Check out the cheat sheet:\\n    # https://raw.githubusercontent.com/sogko/graphql-shorthand-notation-cheat-sheet/master/graphql-shorthand-notation-cheat-sheet.png\\n\\n    schema {\\n        query: Query\\n        mutation: Mutation\\n    }\\n\\n    type Query {\\n        # Get a project and associated metadata\\n        auth: AuthParams\\n\\n        project(id: ID!, program: String!): Project\\n        projects(program: String!, projType: String, limit: Int, nextToken: String): PaginatedProjects\\n\\n        program(program: String!): Program\\n        programs: [Program]\\n\\n        downloadFile(program: String!, id: ID!, projType: String!, filePath: String!): FileDownloadMeta\\n\\n        downloadZip(program: String!, id: ID!, projType: String!): FileDownloadMeta\\n\\n        getWebSymbology(projType: String, name: String!, isRaster: Boolean): Symbology\\n        getLayerTiles(program: String!, id: ID!, projType: String!, layerPath: String!): TileService\\n\\n\\n        # Request an upload start. Writes a manifest file on the upload bucket\\n        # and creates upload urls for everything\\n        requestUpload(id: ID, files: [String!], program: String!, projectType: String!): FileUpload\\n\\n        search(\\n            program: String!\\n            projType: String\\n            nameStr: String\\n            metaStr: String\\n            metaArr: String\\n            tags: String\\n            noTags: Boolean\\n            limit: Int\\n            nextToken: Int\\n        ): PaginatedSearchResults\\n\\n        validate(xml: String!, projType: String!, program: String!): Validation\\n\\n        getUsers(program: String!, limit: Int, nextToken: String): PaginatedUsers\\n\\n        projectTree(id: ID!, program: String!, projType: String!): ProjectTree\\n    }\\n\\n    # this schema allows the following mutation:\\n    type Mutation {\\n        # signal a deletion of a project\\n        deleteProject(id: ID!, program: String!): ID!\\n        updateUser(id: ID!, program: String!, permission: String): User\\n        reIndexProject(id: ID!, program: String!, projType: String!): WatcherOutput\\n        queueTileRebuild(id: ID!, program: String!, projType: String!, filePath: String, symbologies: [String]): String\\n    }\\n\\n    type User {\\n        email: String\\n        name: String\\n        picture: String\\n        username: String!\\n        createdOn: String\\n        updatedOn: String\\n        role: String\\n    }\\n\\n    type PaginatedUsers {\\n        users: [User]\\n        nextToken: String\\n    }\\n\\n    type Validation {\\n        result: Boolean\\n        xmlErrors: [String]\\n    }\\n\\n    type AuthParams {\\n        loggedIn: Boolean\\n        userPool: String\\n        clientId: String\\n        region: String\\n        domain: String\\n    }\\n\\n    interface ProjectBase {\\n        id: ID!\\n        name: String\\n        meta: String\\n        tags: String\\n        projType: String\\n        program: String\\n        createdBy: ID!\\n        updatedBy: ID!\\n        createdOn: String!\\n        updatedOn: String!\\n    }\\n\\n    type Project implements ProjectBase {\\n        id: ID!\\n        name: String\\n        meta: String\\n        tags: String\\n        projType: String\\n        totalSize: String\\n        program: String\\n        createdBy: ID!\\n        updatedBy: ID!\\n        createdOn: String!\\n        updatedOn: String!\\n        files: [FileDownloadMeta]\\n        tree: ProjectTree\\n    }\\n\\n    type ProjectSearchResult implements ProjectBase {\\n        id: ID!\\n        name: String\\n        meta: String\\n        tags: String\\n        projType: String\\n        totalSize: String\\n        program: String\\n        createdBy: ID!\\n        updatedBy: ID!\\n        createdOn: String!\\n        updatedOn: String!\\n        score: Float\\n        files: [FileDownloadMeta]\\n    }\\n\\n    # This is mostly just JSON that's stringified\\n    type Product {\\n        id: ID!\\n        name: String!\\n        folder: String\\n        # Stringified JSON Array:\\n        pathArr: String\\n    }\\n    type Group {\\n        id: ID!\\n        name: String!\\n        folder: String\\n    }\\n    type NamedAllow {\\n        id: ID!\\n        name: String!\\n        aliases: String\\n        folder: String\\n    }\\n    type Collection {\\n        id: ID!\\n        name: String!\\n        AllowRegex: [String]\\n        Allow: [NamedAllow]\\n    }\\n    type Program {\\n        name: String\\n        machineName: String\\n        projectXSDs: String\\n        projectFile: String\\n        meta: String\\n        groups: [Group]\\n        collections: [Collection]\\n        products: [Product]\\n        hierarchy: String\\n        role: String\\n    }\\n\\n    type FileDownloadMeta {\\n        key: String!\\n        md5: String!\\n        size: String\\n        contentType: String\\n        downloadUrl: String!\\n        pendingSince: String\\n    }\\n\\n    type FileUpload {\\n        id: ID!\\n        uploadUrls: [UploadUrl]\\n    }\\n\\n    type UploadUrl {\\n        url: String\\n        fields: String\\n        origPath: String\\n    }\\n\\n    type FileUploadMeta {\\n        key: String!\\n        downloadUrl: String!\\n    }\\n\\n    # Series Connection allows us to implement pagination easily\\n    type PaginatedProjects {\\n        projects: [Project]\\n        nextToken: String\\n    }\\n\\n    type PaginatedSearchResults {\\n        projects: [ProjectSearchResult]\\n        nextToken: Int\\n        total: Int\\n    }\\n\\n    type NewProject {\\n        id: ID!\\n    }\\n\\n    \\\"\\\"\\\"\\n    ProjectTreeLayerTypes is an enumeration to help us display layers with the\\n    correct icon and assign them to the right slot\\n    \\\"\\\"\\\"\\n    enum ProjectTreeLayerTypes {\\n        \", \"\\n    }\\n    enum SymbologyStatus {\\n        \", \"\\n    }\\n    enum TilingStatus {\\n        \", \"\\n    }\\n\\n    type ProjectTreeBranch {\\n        label: String!\\n        collapsed: Boolean\\n        # Branch ID and parent ID\\n        bid: Int\\n        pid: Int\\n    }\\n    type ProjectTreeLeaf {\\n        id: Int # This is a global ID not an id within a branch\\n        pid: Int\\n        label: String!\\n        layerId: ID\\n        blLayerId: ID\\n        layerType: ProjectTreeLayerTypes!\\n        layerPath: String\\n        layerName: String\\n        nodeExists: Boolean\\n        # This is the path that helps u\\n        metaStr: String\\n        symbology: String\\n        transparency: Int\\n    }\\n\\n    # The project tree comes back as non-recursive list of layers.\\n    # The ProjectTree class will need to parse this into a typescript \\n    # Recursive type\\n    type ProjectTreeViewLayer {\\n        id: ID!\\n        visible: Boolean\\n    }\\n\\n    type ProjectTreeViews {\\n        id: ID!\\n        name: String!\\n        description: String\\n        layers: [ProjectTreeViewLayer]\\n    }\\n\\n    type ProjectTree {\\n        name: String\\n        description: String\\n        projectType: String\\n        metaStr: String\\n        leaves: [ProjectTreeLeaf]\\n        branches: [ProjectTreeBranch]\\n        defaultView: ID\\n        views: [ProjectTreeViews]\\n    }\\n\\n    type TileServiceOriginFile {\\n        lastModified: String\\n        etag: String\\n        size: Int\\n        key: String\\n    }\\n\\n    type TileService {\\n        url: String\\n        indexUrl: String\\n        status: TilingStatus!\\n        lastStatus: String\\n        error: String\\n        rasterStats: String\\n        rsLayer: String        # Arbitrary depth so stringify rsLayer\\n        started: String\\n        duration: Float\\n        format: String\\n        bounds: [Float]\\n        maxZoom: Int\\n        minZoom: Int\\n        originFile: TileServiceOriginFile\\n    }\\n    type Symbology {\\n        name: String!\\n        status: SymbologyStatus\\n        symbologyJSON: String\\n        colorRamp: [[String]]\\n        url: String\\n        error: String\\n    }\\n\\n    # Just a nice convenience type for our lambda invoke methods\\n    type WatcherOutput {\\n        message: String\\n        results: [String]\\n        errors: [String]\\n    }\\n\"], [\"\\n    # Check out the cheat sheet:\\n    # https://raw.githubusercontent.com/sogko/graphql-shorthand-notation-cheat-sheet/master/graphql-shorthand-notation-cheat-sheet.png\\n\\n    schema {\\n        query: Query\\n        mutation: Mutation\\n    }\\n\\n    type Query {\\n        # Get a project and associated metadata\\n        auth: AuthParams\\n\\n        project(id: ID!, program: String!): Project\\n        projects(program: String!, projType: String, limit: Int, nextToken: String): PaginatedProjects\\n\\n        program(program: String!): Program\\n        programs: [Program]\\n\\n        downloadFile(program: String!, id: ID!, projType: String!, filePath: String!): FileDownloadMeta\\n\\n        downloadZip(program: String!, id: ID!, projType: String!): FileDownloadMeta\\n\\n        getWebSymbology(projType: String, name: String!, isRaster: Boolean): Symbology\\n        getLayerTiles(program: String!, id: ID!, projType: String!, layerPath: String!): TileService\\n\\n\\n        # Request an upload start. Writes a manifest file on the upload bucket\\n        # and creates upload urls for everything\\n        requestUpload(id: ID, files: [String!], program: String!, projectType: String!): FileUpload\\n\\n        search(\\n            program: String!\\n            projType: String\\n            nameStr: String\\n            metaStr: String\\n            metaArr: String\\n            tags: String\\n            noTags: Boolean\\n            limit: Int\\n            nextToken: Int\\n        ): PaginatedSearchResults\\n\\n        validate(xml: String!, projType: String!, program: String!): Validation\\n\\n        getUsers(program: String!, limit: Int, nextToken: String): PaginatedUsers\\n\\n        projectTree(id: ID!, program: String!, projType: String!): ProjectTree\\n    }\\n\\n    # this schema allows the following mutation:\\n    type Mutation {\\n        # signal a deletion of a project\\n        deleteProject(id: ID!, program: String!): ID!\\n        updateUser(id: ID!, program: String!, permission: String): User\\n        reIndexProject(id: ID!, program: String!, projType: String!): WatcherOutput\\n        queueTileRebuild(id: ID!, program: String!, projType: String!, filePath: String, symbologies: [String]): String\\n    }\\n\\n    type User {\\n        email: String\\n        name: String\\n        picture: String\\n        username: String!\\n        createdOn: String\\n        updatedOn: String\\n        role: String\\n    }\\n\\n    type PaginatedUsers {\\n        users: [User]\\n        nextToken: String\\n    }\\n\\n    type Validation {\\n        result: Boolean\\n        xmlErrors: [String]\\n    }\\n\\n    type AuthParams {\\n        loggedIn: Boolean\\n        userPool: String\\n        clientId: String\\n        region: String\\n        domain: String\\n    }\\n\\n    interface ProjectBase {\\n        id: ID!\\n        name: String\\n        meta: String\\n        tags: String\\n        projType: String\\n        program: String\\n        createdBy: ID!\\n        updatedBy: ID!\\n        createdOn: String!\\n        updatedOn: String!\\n    }\\n\\n    type Project implements ProjectBase {\\n        id: ID!\\n        name: String\\n        meta: String\\n        tags: String\\n        projType: String\\n        totalSize: String\\n        program: String\\n        createdBy: ID!\\n        updatedBy: ID!\\n        createdOn: String!\\n        updatedOn: String!\\n        files: [FileDownloadMeta]\\n        tree: ProjectTree\\n    }\\n\\n    type ProjectSearchResult implements ProjectBase {\\n        id: ID!\\n        name: String\\n        meta: String\\n        tags: String\\n        projType: String\\n        totalSize: String\\n        program: String\\n        createdBy: ID!\\n        updatedBy: ID!\\n        createdOn: String!\\n        updatedOn: String!\\n        score: Float\\n        files: [FileDownloadMeta]\\n    }\\n\\n    # This is mostly just JSON that's stringified\\n    type Product {\\n        id: ID!\\n        name: String!\\n        folder: String\\n        # Stringified JSON Array:\\n        pathArr: String\\n    }\\n    type Group {\\n        id: ID!\\n        name: String!\\n        folder: String\\n    }\\n    type NamedAllow {\\n        id: ID!\\n        name: String!\\n        aliases: String\\n        folder: String\\n    }\\n    type Collection {\\n        id: ID!\\n        name: String!\\n        AllowRegex: [String]\\n        Allow: [NamedAllow]\\n    }\\n    type Program {\\n        name: String\\n        machineName: String\\n        projectXSDs: String\\n        projectFile: String\\n        meta: String\\n        groups: [Group]\\n        collections: [Collection]\\n        products: [Product]\\n        hierarchy: String\\n        role: String\\n    }\\n\\n    type FileDownloadMeta {\\n        key: String!\\n        md5: String!\\n        size: String\\n        contentType: String\\n        downloadUrl: String!\\n        pendingSince: String\\n    }\\n\\n    type FileUpload {\\n        id: ID!\\n        uploadUrls: [UploadUrl]\\n    }\\n\\n    type UploadUrl {\\n        url: String\\n        fields: String\\n        origPath: String\\n    }\\n\\n    type FileUploadMeta {\\n        key: String!\\n        downloadUrl: String!\\n    }\\n\\n    # Series Connection allows us to implement pagination easily\\n    type PaginatedProjects {\\n        projects: [Project]\\n        nextToken: String\\n    }\\n\\n    type PaginatedSearchResults {\\n        projects: [ProjectSearchResult]\\n        nextToken: Int\\n        total: Int\\n    }\\n\\n    type NewProject {\\n        id: ID!\\n    }\\n\\n    \\\"\\\"\\\"\\n    ProjectTreeLayerTypes is an enumeration to help us display layers with the\\n    correct icon and assign them to the right slot\\n    \\\"\\\"\\\"\\n    enum ProjectTreeLayerTypes {\\n        \", \"\\n    }\\n    enum SymbologyStatus {\\n        \", \"\\n    }\\n    enum TilingStatus {\\n        \", \"\\n    }\\n\\n    type ProjectTreeBranch {\\n        label: String!\\n        collapsed: Boolean\\n        # Branch ID and parent ID\\n        bid: Int\\n        pid: Int\\n    }\\n    type ProjectTreeLeaf {\\n        id: Int # This is a global ID not an id within a branch\\n        pid: Int\\n        label: String!\\n        layerId: ID\\n        blLayerId: ID\\n        layerType: ProjectTreeLayerTypes!\\n        layerPath: String\\n        layerName: String\\n        nodeExists: Boolean\\n        # This is the path that helps u\\n        metaStr: String\\n        symbology: String\\n        transparency: Int\\n    }\\n\\n    # The project tree comes back as non-recursive list of layers.\\n    # The ProjectTree class will need to parse this into a typescript \\n    # Recursive type\\n    type ProjectTreeViewLayer {\\n        id: ID!\\n        visible: Boolean\\n    }\\n\\n    type ProjectTreeViews {\\n        id: ID!\\n        name: String!\\n        description: String\\n        layers: [ProjectTreeViewLayer]\\n    }\\n\\n    type ProjectTree {\\n        name: String\\n        description: String\\n        projectType: String\\n        metaStr: String\\n        leaves: [ProjectTreeLeaf]\\n        branches: [ProjectTreeBranch]\\n        defaultView: ID\\n        views: [ProjectTreeViews]\\n    }\\n\\n    type TileServiceOriginFile {\\n        lastModified: String\\n        etag: String\\n        size: Int\\n        key: String\\n    }\\n\\n    type TileService {\\n        url: String\\n        indexUrl: String\\n        status: TilingStatus!\\n        lastStatus: String\\n        error: String\\n        rasterStats: String\\n        rsLayer: String        # Arbitrary depth so stringify rsLayer\\n        started: String\\n        duration: Float\\n        format: String\\n        bounds: [Float]\\n        maxZoom: Int\\n        minZoom: Int\\n        originFile: TileServiceOriginFile\\n    }\\n    type Symbology {\\n        name: String!\\n        status: SymbologyStatus\\n        symbologyJSON: String\\n        colorRamp: [[String]]\\n        url: String\\n        error: String\\n    }\\n\\n    # Just a nice convenience type for our lambda invoke methods\\n    type WatcherOutput {\\n        message: String\\n        results: [String]\\n        errors: [String]\\n    }\\n\"])), Object.values(types_1.ProjectTreeLayerTypes).join('\\n      '), Object.values(types_1.SymbologyStatus).join('\\n      '), Object.values(types_1.TilingStatus).join('\\n      '));\nexports.default = typeDefs;\nvar templateObject_1;\n//# sourceMappingURL=schema.graphql.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Program = void 0;\nvar Program = (function () {\n    function Program(programObj) {\n        Object.assign(this, programObj);\n    }\n    Program.fromGraphQL = function (input) {\n        if (!input)\n            return null;\n        var meta = JSON.parse(input.meta);\n        return new Program(__assign(__assign({}, input), { meta: meta, role: input.role, products: input.products.map(function (p) { return (__assign(__assign({}, p), { pathArr: JSON.parse(p.pathArr) })); }) }));\n    };\n    return Program;\n}());\nexports.Program = Program;\n//# sourceMappingURL=Program.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Project = void 0;\nvar path_1 = __importDefault(require(\"path\"));\nfunction fileSort(currFolder) {\n    currFolder.sort(function (a, b) {\n        if (a.children && !b.children)\n            return -1;\n        if (!a.children && b.children)\n            return 1;\n        if (a.name.toLowerCase() < b.name.toLowerCase())\n            return -1;\n        if (a.name.toLowerCase() > b.name.toLowerCase())\n            return 1;\n        return 0;\n    });\n}\nvar Project = (function () {\n    function Project(projectObj) {\n        var _this = this;\n        this.treeIzeFilePaths = function () {\n            var root = [];\n            _this.files.forEach(function (_a) {\n                var key = _a.key;\n                var pathArr = key.split('/');\n                if (pathArr.length === 1 && key.indexOf('\\\\') > -1) {\n                    pathArr = key.split('\\\\');\n                }\n                var currFolder = root;\n                var _loop_1 = function () {\n                    var folder = { name: pathArr.shift(), children: [] };\n                    var found = currFolder.find(function (f) { return f.name === folder.name; });\n                    if (found && found.children) {\n                        currFolder = found.children;\n                    }\n                    else {\n                        currFolder.push(folder);\n                        currFolder = folder.children;\n                    }\n                    fileSort(currFolder);\n                };\n                while (pathArr.length > 1) {\n                    _loop_1();\n                }\n                currFolder.push({ name: pathArr[0], path: key });\n            });\n            fileSort(root);\n            return root;\n        };\n        Object.assign(this, projectObj);\n        if (!this.files)\n            this.files = [];\n        if (this.tree && this.tree.leaves) {\n            this.tree.leaves = this.tree.leaves.map(function (lf) { return (__assign(__assign({}, lf), { meta: lf && lf.metaStr ? JSON.parse(lf.metaStr) : {} })); });\n        }\n    }\n    Project.fromGraphQL = function (input) {\n        if (!input)\n            return null;\n        return new Project(__assign(__assign({}, input), { createdOn: parseInt(input.createdOn, 10), updatedOn: parseInt(input.updatedOn, 10), meta: input.meta ? JSON.parse(input.meta) : {}, tags: input.tags ? input.tags.split(',') : [] }));\n    };\n    Project.diff = function (left, right) {\n        var different = [];\n        var same = [];\n        if (!right || right.length === 0) {\n            return {\n                leftOnly: left.map(function (f) { return f.key; }),\n                rightOnly: [],\n                different: [],\n                same: []\n            };\n        }\n        else if (!left || left.length === 0) {\n            return {\n                leftOnly: [],\n                rightOnly: right.map(function (f) { return f.key; }),\n                different: [],\n                same: []\n            };\n        }\n        var leftOnly = left\n            .filter(function (leftFile) {\n            var found = right.find(function (rightFile) { return leftFile.key === rightFile.key; });\n            if (found) {\n                if (found.md5 === leftFile.md5)\n                    same.push(leftFile.key);\n                else\n                    different.push(leftFile.key);\n            }\n            return !found;\n        })\n            .map(function (f) { return f.key; });\n        var rightOnly = right\n            .filter(function (rightFile) { return !left.find(function (leftFile) { return rightFile.key === leftFile.key; }); })\n            .map(function (f) { return f.key; });\n        return {\n            leftOnly: leftOnly,\n            rightOnly: rightOnly,\n            different: different,\n            same: same\n        };\n    };\n    Project.getProjectS3Keys = function (program, projectId, projType) {\n        var prefix = path_1.default.join(program.machineName, projType, projectId);\n        var zipKey = prefix + \".zip\";\n        var projFileKey = path_1.default.join(prefix, program.projectFile);\n        var zipKeyPending = path_1.default.join(program.machineName, projType, projectId + \".zip.pending\");\n        var downloadFolderName = \"\" + [program.machineName, projType, projectId].join('-');\n        var downloadZipFilename = downloadFolderName + \".zip\";\n        return {\n            prefix: prefix,\n            zipKey: zipKey,\n            projFileKey: projFileKey,\n            zipKeyPending: zipKeyPending,\n            downloadFolderName: downloadFolderName,\n            downloadZipFilename: downloadZipFilename\n        };\n    };\n    Project.parseDynamoMeta = function (dynObj) {\n        var metavals = Object.keys(dynObj)\n            .filter(function (k) { return k.indexOf('META_') === 0; })\n            .reduce(function (acc, k) {\n            var _a;\n            var newk = k.split('META_')[1];\n            return __assign(__assign({}, acc), (_a = {}, _a[newk] = dynObj[k], _a));\n        }, {});\n        return JSON.stringify(metavals);\n    };\n    Project.parseTagString = function (tagString) {\n        if (!tagString || tagString.trim().length === 0)\n            return [];\n        return tagString\n            .split(',')\n            .map(function (t) { return t.trim(); })\n            .filter(function (t) { return t.length > 0 && t !== 'null' && t !== 'undefined'; });\n    };\n    Project.parseS3Key = function (program, key) {\n        var keyArr = key.split('/');\n        if (keyArr.length < 3)\n            throw new Error('Not a valid project key');\n        var _a = key.split('/'), programMachineName = _a[0], projType = _a[1], id = _a[2];\n        if (program.machineName !== programMachineName) {\n            throw new Error(\"Program passed to parseS3 key \" + program.machineName + \" does not correspond to program in key: \" + programMachineName);\n        }\n        return Project.getProjectS3Keys(program, id, projType);\n    };\n    Project.parseS3KeyDUMB = function (key) {\n        var keyArr = key.split('/');\n        if (keyArr.length < 3)\n            throw new Error('Not a valid project key');\n        var programMachineName = keyArr[0], projType = keyArr[1], id = keyArr[2];\n        var prefix = path_1.default.join(programMachineName, projType, id);\n        var zipKey = prefix + \".zip\";\n        return {\n            programMachineName: programMachineName,\n            projType: projType,\n            id: id,\n            zipKey: zipKey,\n            prefix: prefix\n        };\n    };\n    return Project;\n}());\nexports.Project = Project;\n//# sourceMappingURL=Project.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ValidationError = void 0;\nvar ValidationError = (function (_super) {\n    __extends(ValidationError, _super);\n    function ValidationError(message, reasons) {\n        var _this = _super.call(this, message) || this;\n        _this.name = _this.constructor.name;\n        _this.reasons = reasons;\n        Error.captureStackTrace(_this, _this.constructor);\n        return _this;\n    }\n    return ValidationError;\n}(Error));\nexports.ValidationError = ValidationError;\n//# sourceMappingURL=errors.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TileServiceJSONClass = void 0;\nvar TileServiceJSONClass = (function () {\n    function TileServiceJSONClass(raw) {\n        Object.assign(this, raw);\n    }\n    return TileServiceJSONClass;\n}());\nexports.TileServiceJSONClass = TileServiceJSONClass;\n//# sourceMappingURL=TileServiceJSONClass.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar styles_1 = require(\"@material-ui/core/styles\");\nexports.default = (function (theme) {\n    var _a, _b, _c, _d;\n    return ({\n        appBar: {\n            zIndex: theme.zIndex.drawer + 1\n        },\n        root: {\n            display: 'flex',\n            alignItems: 'center',\n            width: '100%',\n            padding: theme.spacing(0, 1),\n            textShadow: '3px 3px 3px rgba(0,0,0,0.7)',\n            backgroundImage: \"url(\" + process.env.PUBLIC_URL + \"/HeaderBackground.png)\",\n            backgroundRepeat: 'no-repeat',\n            backgroundPosition: '0% 50%',\n            backgroundSize: 'cover',\n            backgroundColor: '#444444'\n        },\n        logo: {\n            height: 40,\n            width: 40,\n            marginRight: theme.spacing(2)\n        },\n        programChooser: {\n            margin: theme.spacing(0, 1),\n            color: theme.palette.primary.contrastText,\n            '& svg': {\n                color: theme.palette.primary.contrastText\n            },\n            '&:before': {\n                borderColor: theme.palette.primary.contrastText\n            },\n            '&:after': {\n                borderColor: theme.palette.primary.contrastText\n            }\n        },\n        transparent: {\n            backgroundColor: 'transparent',\n            background: 'none',\n            color: theme.palette.text.primary\n        },\n        search: (_a = {\n                position: 'relative',\n                borderRadius: theme.shape.borderRadius,\n                backgroundColor: styles_1.fade(theme.palette.common.white, 0.15),\n                '&:hover': {\n                    backgroundColor: styles_1.fade(theme.palette.common.white, 0.25)\n                },\n                marginRight: theme.spacing(2),\n                marginLeft: 0,\n                width: '100%',\n                flexGrow: 1\n            },\n            _a[theme.breakpoints.up('sm')] = {\n                marginLeft: theme.spacing(3),\n                width: 'auto'\n            },\n            _a),\n        searchIcon: {\n            width: theme.spacing(7),\n            height: '100%',\n            position: 'absolute',\n            pointerEvents: 'none',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center'\n        },\n        inputRoot: {\n            color: 'inherit'\n        },\n        spacer: {\n            flexGrow: 1\n        },\n        inputInput: (_b = {\n                padding: theme.spacing(1, 1, 1, 7),\n                transition: theme.transitions.create('width'),\n                width: '100%'\n            },\n            _b[theme.breakpoints.up('sm')] = {\n                width: 200\n            },\n            _b),\n        sectionDesktop: (_c = {\n                display: 'none'\n            },\n            _c[theme.breakpoints.up('sm')] = {\n                display: 'flex',\n                flexGrow: 1\n            },\n            _c),\n        sectionMobile: (_d = {\n                display: 'flex',\n                flexGrow: 1\n            },\n            _d[theme.breakpoints.up('sm')] = {\n                display: 'none'\n            },\n            _d)\n    });\n});\n//# sourceMappingURL=Topbar.style.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar Button_1 = __importDefault(require(\"@material-ui/core/Button\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar __1 = require(\"..\");\nvar useStyles = styles_1.makeStyles(function (theme) { return ({\n    root: {},\n    whBtnLogo: { height: 20, width: 20, marginRight: theme.spacing(1) },\n    whButton: {\n        maxWidth: 300\n    }\n}); });\nvar WarehouseButton = function (_a) {\n    var title = _a.title, href = _a.href, stay = _a.stay;\n    var classes = useStyles();\n    return (react_1.default.createElement(Button_1.default, { className: classes.whButton, target: stay ? undefined : '_blank', variant: \"contained\", href: href, onClick: function () {\n            __1.googleAnalytics.event('webrave', 'open_warehouse', 'open_warehouse');\n        }, color: \"secondary\", fullWidth: true },\n        react_1.default.createElement(\"img\", { className: classes.whBtnLogo, src: 'https://riverscapes.xyz/assets/images/RiverscapesLogo.png', alt: \"logo\" }),\n        title));\n};\nexports.default = WarehouseButton;\n//# sourceMappingURL=WarehouseButton.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isDisabled = void 0;\nvar react_1 = __importDefault(require(\"react\"));\nvar Paper_1 = __importDefault(require(\"@material-ui/core/Paper\"));\nvar Avatar_1 = __importDefault(require(\"@material-ui/core/Avatar\"));\nvar Typography_1 = __importDefault(require(\"@material-ui/core/Typography\"));\nvar List_1 = __importDefault(require(\"@material-ui/core/List\"));\nvar Chip_1 = __importDefault(require(\"@material-ui/core/Chip\"));\nvar ListItem_1 = __importDefault(require(\"@material-ui/core/ListItem\"));\nvar ListItemText_1 = __importDefault(require(\"@material-ui/core/ListItemText\"));\nvar ListItemAvatar_1 = __importDefault(require(\"@material-ui/core/ListItemAvatar\"));\nvar Face_1 = __importDefault(require(\"@material-ui/icons/Face\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar clsx_1 = __importDefault(require(\"clsx\"));\nvar constants_1 = require(\"../constants\");\nvar useStyles = styles_1.makeStyles(function (theme) { return ({\n    rootContainer: {\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'column'\n    },\n    spacer: {\n        flexGrow: 1\n    },\n    root: {\n        padding: theme.spacing(2, 4, 4, 4)\n    },\n    logoContainer: {\n        padding: theme.spacing(2),\n        textAlign: 'center'\n    },\n    logo: {},\n    accessChip: __assign({}, Object.keys(constants_1.accessColors).reduce(function (acc, ack) {\n        var _a;\n        return (__assign(__assign({}, acc), (_a = {}, _a[\"&.access_\" + ack] = {\n            color: theme.palette.getContrastText(constants_1.accessColors[ack][500]),\n            background: constants_1.accessColors[ack][500]\n        }, _a)));\n    }, {}))\n}); });\nfunction isDisabled(prog) {\n    if (prog.meta && prog.meta.access && prog.meta.access === 'PUBLIC')\n        return false;\n    return prog.role === null;\n}\nexports.isDisabled = isDisabled;\nvar ProgramChooser = function (_a) {\n    var programs = _a.programs, history = _a.history, navigate = _a.navigate;\n    var classes = useStyles();\n    return (react_1.default.createElement(\"div\", { className: classes.rootContainer },\n        react_1.default.createElement(\"div\", { className: classes.spacer }),\n        react_1.default.createElement(Paper_1.default, { className: classes.root, elevation: 1 },\n            react_1.default.createElement(\"div\", { className: classes.logoContainer },\n                react_1.default.createElement(\"img\", { className: classes.logo, src: process.env.PUBLIC_URL + '/RiverscapesLogo.png', alt: \"logo\" })),\n            react_1.default.createElement(Typography_1.default, { variant: \"h5\" }, \"Choose a program:\"),\n            react_1.default.createElement(List_1.default, null, programs &&\n                programs.map(function (p, idx) {\n                    var chip = (react_1.default.createElement(Chip_1.default, { icon: react_1.default.createElement(Face_1.default, null), className: clsx_1.default(classes.accessChip, \"access_\" + p.role), label: p.role || 'Observer', color: \"primary\" }));\n                    var disabled = isDisabled(p);\n                    if (disabled)\n                        chip = react_1.default.createElement(Chip_1.default, { label: \"No Access\", color: \"default\" });\n                    return (react_1.default.createElement(ListItem_1.default, { key: \"progKey-\" + idx, disabled: disabled, button: true, divider: true, onClick: function () { return navigate(history, p); } },\n                        react_1.default.createElement(ListItemAvatar_1.default, null,\n                            react_1.default.createElement(Avatar_1.default, { alt: \"programname\" }, p.name.substr(0, 1))),\n                        react_1.default.createElement(ListItemText_1.default, { primary: p.name, secondary: p.meta.description }),\n                        chip));\n                })),\n            react_1.default.createElement(Typography_1.default, { paragraph: true, variant: \"caption\" },\n                \"If there are programs labeled\",\n                ' ',\n                react_1.default.createElement(Chip_1.default, { label: \"No Access\", component: \"span\", color: \"default\", size: \"small\" }),\n                \" and you think you should be able to see them please contact your program administrator.\")),\n        react_1.default.createElement(\"div\", { className: classes.spacer })));\n};\nexports.default = ProgramChooser;\n//# sourceMappingURL=ProgramChooser.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importStar(require(\"react\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar Link_1 = __importDefault(require(\"@material-ui/core/Link\"));\nvar Tooltip_1 = __importDefault(require(\"@material-ui/core/Tooltip\"));\nvar Dialog_1 = __importDefault(require(\"@material-ui/core/Dialog\"));\nvar Button_1 = __importDefault(require(\"@material-ui/core/Button\"));\nvar ButtonGroup_1 = __importDefault(require(\"@material-ui/core/ButtonGroup\"));\nvar DialogTitle_1 = __importDefault(require(\"@material-ui/core/DialogTitle\"));\nvar DialogContent_1 = __importDefault(require(\"@material-ui/core/DialogContent\"));\nvar IconButton_1 = __importDefault(require(\"@material-ui/core/IconButton\"));\nvar Divider_1 = __importDefault(require(\"@material-ui/core/Divider\"));\nvar Close_1 = __importDefault(require(\"@material-ui/icons/Close\"));\nvar Typography_1 = __importDefault(require(\"@material-ui/core/Typography\"));\nvar Popover_1 = __importDefault(require(\"@material-ui/core/Popover\"));\nvar Share_1 = __importDefault(require(\"@material-ui/icons/Share\"));\nvar InsertDriveFile_1 = __importDefault(require(\"@material-ui/icons/InsertDriveFile\"));\nvar Photo_1 = __importDefault(require(\"@material-ui/icons/Photo\"));\nvar Terrain_1 = __importDefault(require(\"@material-ui/icons/Terrain\"));\nvar Assignment_1 = __importDefault(require(\"@material-ui/icons/Assignment\"));\nvar TreeView_1 = __importDefault(require(\"@material-ui/lab/TreeView\"));\nvar ExpandMore_1 = __importDefault(require(\"@material-ui/icons/ExpandMore\"));\nvar ChevronRight_1 = __importDefault(require(\"@material-ui/icons/ChevronRight\"));\nvar WarehouseTags_1 = __importDefault(require(\"../../misc/WarehouseTags\"));\nvar clsx_1 = __importDefault(require(\"clsx\"));\nvar filesize_1 = __importDefault(require(\"filesize\"));\nvar moment_1 = __importDefault(require(\"moment\"));\nvar WebRaveBtn_1 = __importDefault(require(\"../../misc/WebRaveBtn\"));\nvar DownloadZipBtn_1 = __importDefault(require(\"../../misc/DownloadZipBtn\"));\nvar ShareDialog_1 = __importDefault(require(\"../../modals/ShareDialog\"));\nvar RecurseTreeItem_1 = __importDefault(require(\"./RecurseTreeItem\"));\nvar ProjectModal_style_1 = __importDefault(require(\"./ProjectModal.style\"));\nvar useStyles = styles_1.makeStyles(ProjectModal_style_1.default);\nvar ProjectModal = function (_a) {\n    var onClose = _a.onClose, project = _a.project, downloadFile = _a.downloadFile, webRaveUrl = _a.webRaveUrl, program = _a.program, showFileTree = _a.showFileTree, pendingZips = _a.pendingZips, downloadZipFile = _a.downloadZipFile;\n    var classes = useStyles();\n    var _b = react_1.useState(null), popOver = _b[0], setPopover = _b[1];\n    var _c = react_1.useState(false), shareOpen = _c[0], setShareOpen = _c[1];\n    var pendingSince = pendingZips[project.id];\n    var iconMapping = [\n        { pattern: /.*\\.(png|gif|jpg|jpeg)$/i, icon: react_1.default.createElement(Photo_1.default, { className: classes.photoIcon }), classStr: 'photo' },\n        { pattern: /.*\\.(tif|img|shp)$/i, icon: react_1.default.createElement(Terrain_1.default, { className: classes.TerrainIcon }), classStr: 'terrain' },\n        {\n            pattern: /.*\\.(csv|pdf|doc)$/i,\n            icon: react_1.default.createElement(Assignment_1.default, { className: classes.documentIcon }),\n            classStr: 'assignment'\n        }\n    ];\n    var files = (project.files || []).reduce(function (acc, file) {\n        var _a;\n        var found = iconMapping.find(function (_a) {\n            var pattern = _a.pattern;\n            return file.key.match(pattern);\n        });\n        return __assign(__assign({}, acc), (_a = {}, _a[file.key] = __assign(__assign({}, file), { icon: found ? found.icon : react_1.default.createElement(InsertDriveFile_1.default, { className: classes.normalIcon }), classStr: found ? found.classStr : 'normalIcon' }), _a));\n    }, {});\n    var fileTree = project.treeIzeFilePaths();\n    var pType = program.products.find(function (p) { return p.id === project.projType; });\n    var pTypeName = pType ? pType.name : 'Unknown';\n    var descriptionTag = Object.keys(project.meta).find(function (k) { return k.toLowerCase() === 'description'; });\n    return (react_1.default.createElement(Dialog_1.default, { onClose: onClose, open: true, maxWidth: \"md\", fullWidth: true, className: classes.root, classes: {\n            scrollPaper: classes.scrollPaper\n        } },\n        react_1.default.createElement(ShareDialog_1.default, { open: shareOpen, shareUrl: window.location.href, handleClose: function () { return setShareOpen(false); } }),\n        react_1.default.createElement(DialogTitle_1.default, { disableTypography: true, className: classes.titlebar },\n            react_1.default.createElement(\"div\", { className: classes.titlebarLeft },\n                react_1.default.createElement(Tooltip_1.default, { title: react_1.default.createElement(Typography_1.default, { variant: \"body1\" }, project.name) },\n                    react_1.default.createElement(Typography_1.default, { variant: \"h5\", component: \"div\", className: clsx_1.default(classes.name, classes.allowSelect) }, project.name)),\n                react_1.default.createElement(\"div\", { className: classes.subHeader },\n                    react_1.default.createElement(\"div\", { className: classes.flexGrow },\n                        react_1.default.createElement(Typography_1.default, { variant: \"caption\", color: \"inherit\", component: \"div\" },\n                            \"ID: \",\n                            react_1.default.createElement(\"span\", { className: classes.allowSelect }, project.id))))),\n            onClose ? (react_1.default.createElement(\"div\", null,\n                react_1.default.createElement(IconButton_1.default, { \"aria-label\": \"close\", className: classes.closeButton, onClick: onClose, size: \"small\" },\n                    react_1.default.createElement(Close_1.default, null)))) : null),\n        react_1.default.createElement(DialogContent_1.default, { dividers: true },\n            react_1.default.createElement(\"div\", { className: clsx_1.default(classes.allowSelect) },\n                react_1.default.createElement(\"div\", { className: classes.header },\n                    react_1.default.createElement(\"div\", { className: classes.headerLeft },\n                        react_1.default.createElement(Typography_1.default, { variant: \"caption\", component: \"div\", color: \"inherit\" },\n                            react_1.default.createElement(\"strong\", null, \"Project Type\"),\n                            \": \",\n                            react_1.default.createElement(\"strong\", null, pTypeName),\n                            \" (\",\n                            pType && pType.id,\n                            \")\"),\n                        react_1.default.createElement(Typography_1.default, { variant: \"caption\", component: \"div\", color: \"inherit\" },\n                            react_1.default.createElement(\"strong\", null, \"Created\"),\n                            \": \",\n                            moment_1.default(project.createdOn, 'x').fromNow(),\n                            \" (\",\n                            moment_1.default(project.createdOn, 'x').format('lll'),\n                            \")\"),\n                        react_1.default.createElement(Typography_1.default, { variant: \"caption\", component: \"div\", color: \"inherit\" },\n                            react_1.default.createElement(\"strong\", null, \"Updated\"),\n                            \": \",\n                            moment_1.default(project.updatedOn, 'x').fromNow(),\n                            \" (\",\n                            moment_1.default(project.updatedOn, 'x').format('lll'),\n                            \")\"),\n                        react_1.default.createElement(Typography_1.default, { variant: \"caption\", component: \"div\", color: \"inherit\" },\n                            react_1.default.createElement(\"strong\", null, \"Warehouse tags: \"),\n                            react_1.default.createElement(WarehouseTags_1.default, { tags: project.tags })),\n                        react_1.default.createElement(Typography_1.default, { variant: \"caption\", component: \"div\", color: \"inherit\" },\n                            react_1.default.createElement(\"strong\", null, \"Size (Unzipped)\"),\n                            \":\",\n                            ' ',\n                            project.totalSize && project.totalSize > -1\n                                ? filesize_1.default(project.totalSize)\n                                : 'Not available')),\n                    react_1.default.createElement(\"div\", { className: classes.headerRight },\n                        react_1.default.createElement(ButtonGroup_1.default, { color: \"primary\" },\n                            webRaveUrl && (react_1.default.createElement(WebRaveBtn_1.default, __assign({ title: \"Map\", url: webRaveUrl }, { project: project }, { btnProps: {\n                                    variant: 'text'\n                                } }))),\n                            react_1.default.createElement(Button_1.default, { variant: \"text\", onClick: function () { return setShareOpen(true); }, style: {\n                                    cursor: 'pointer'\n                                }, startIcon: react_1.default.createElement(Share_1.default, null) }, \"Share\"),\n                            react_1.default.createElement(DownloadZipBtn_1.default, __assign({ title: \"Download\" }, { project: project, pendingSince: pendingSince, downloadZipFile: downloadZipFile }, { btnProps: {\n                                    variant: 'text'\n                                } }))))),\n                descriptionTag && (react_1.default.createElement(\"div\", null,\n                    react_1.default.createElement(Typography_1.default, { className: classes.title, color: \"inherit\", component: \"div\", variant: \"subtitle1\" }, \"Description\"),\n                    react_1.default.createElement(Typography_1.default, { color: \"textSecondary\", variant: \"body2\" }, project.meta[descriptionTag]))),\n                react_1.default.createElement(Typography_1.default, { className: classes.title, color: \"inherit\", variant: \"subtitle1\" }, \"Metadata\"),\n                react_1.default.createElement(Divider_1.default, null),\n                react_1.default.createElement(\"div\", { className: classes.metaDisplay }, Object.keys(project.meta)\n                    .filter(function (k) { return ['description'].indexOf(k.toLowerCase()) === -1; })\n                    .map(function (metaKey, idk) {\n                    var textComponent = project.meta[metaKey];\n                    if (project.meta[metaKey].indexOf('http') === 0) {\n                        textComponent = (react_1.default.createElement(Link_1.default, { href: project.meta[metaKey], target: \"_blank\" }, project.meta[metaKey]));\n                    }\n                    return (react_1.default.createElement(Tooltip_1.default, { key: \"result-\" + idk, placement: \"bottom\", title: react_1.default.createElement(react_1.default.Fragment, null,\n                            react_1.default.createElement(Typography_1.default, { variant: \"body1\", component: \"div\" },\n                                react_1.default.createElement(\"strong\", null, metaKey)),\n                            react_1.default.createElement(Typography_1.default, { variant: \"body2\", component: \"div\" }, textComponent)) },\n                        react_1.default.createElement(\"div\", { className: classes.metaDisplayItem },\n                            react_1.default.createElement(Typography_1.default, { variant: \"caption\", component: \"div\", color: \"textPrimary\" },\n                                react_1.default.createElement(\"strong\", null, metaKey)),\n                            react_1.default.createElement(Typography_1.default, { variant: \"caption\", component: \"div\", color: \"textPrimary\" }, textComponent))));\n                }))),\n            showFileTree && (react_1.default.createElement(react_1.default.Fragment, null,\n                react_1.default.createElement(Typography_1.default, { className: classes.title, color: \"inherit\", variant: \"subtitle1\" }, \"Files\"),\n                react_1.default.createElement(Divider_1.default, null),\n                react_1.default.createElement(TreeView_1.default, { className: classes.treeRoot, defaultExpanded: ['1'], disableSelection: true, defaultCollapseIcon: react_1.default.createElement(ExpandMore_1.default, { color: \"inherit\" }), defaultExpandIcon: react_1.default.createElement(ChevronRight_1.default, { color: \"inherit\" }) }, fileTree.map(function (ft, idx) { return (react_1.default.createElement(RecurseTreeItem_1.default, { project: project, key: \"treeNode-\" + idx, keyStr: \"treeNode-\" + idx, item: ft, fileDict: files, fileClick: downloadFile })); }))))),\n        react_1.default.createElement(Popover_1.default, { open: Boolean(popOver), anchorEl: popOver ? popOver[0] : null, onClose: function () { return setPopover(null); }, anchorOrigin: {\n                vertical: 'bottom',\n                horizontal: 'center'\n            }, transformOrigin: {\n                vertical: 'top',\n                horizontal: 'center'\n            } },\n            react_1.default.createElement(Typography_1.default, { className: classes.popOver }, popOver ? popOver[1] : ''))));\n};\nexports.default = ProjectModal;\n//# sourceMappingURL=ProjectModal.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar IconButton_1 = __importDefault(require(\"@material-ui/core/IconButton\"));\nvar Typography_1 = __importDefault(require(\"@material-ui/core/Typography\"));\nvar Tooltip_1 = __importDefault(require(\"@material-ui/core/Tooltip\"));\nvar CloudDownload_1 = __importDefault(require(\"@material-ui/icons/CloudDownload\"));\nvar TreeItem_1 = __importDefault(require(\"@material-ui/lab/TreeItem\"));\nvar filesize_1 = __importDefault(require(\"filesize\"));\nvar RecurseTreeItem_style_1 = __importDefault(require(\"./RecurseTreeItem.style\"));\nvar useStyles = styles_1.makeStyles(RecurseTreeItem_style_1.default);\nvar RecurseTreeItem = function (_a) {\n    var item = _a.item, fileDict = _a.fileDict, keyStr = _a.keyStr, project = _a.project, fileClick = _a.fileClick;\n    var classes = useStyles();\n    if (item.children) {\n        var childNodes = item.children.map(function (c, idx) { return (react_1.default.createElement(RecurseTreeItem, { keyStr: keyStr + \"-l\" + idx, key: keyStr + \"-l\" + idx, item: c, fileDict: fileDict, project: project, fileClick: fileClick })); });\n        return (react_1.default.createElement(TreeItem_1.default, { nodeId: keyStr, className: classes.treeFolder, classes: {\n                content: classes.treeFolderContent\n            }, label: react_1.default.createElement(\"div\", { className: classes.treeFolderText }, item.name) }, childNodes));\n    }\n    else {\n        var lookup = item.path ? fileDict[item.path] : { size: '0' };\n        return (react_1.default.createElement(TreeItem_1.default, { nodeId: keyStr, className: classes.treeFile, classes: {\n                root: classes.treeItemRoot,\n                content: classes.treeFileContent\n            }, label: react_1.default.createElement(\"div\", { className: classes.treeItemContainer },\n                react_1.default.createElement(\"div\", { className: classes.treeItemText },\n                    react_1.default.createElement(Typography_1.default, { color: \"textPrimary\", component: \"div\", variant: \"body1\" }, item.name),\n                    react_1.default.createElement(Typography_1.default, { color: \"textSecondary\", component: \"div\", variant: \"caption\" },\n                        filesize_1.default(parseInt(lookup.size, 10)),\n                        \" --\",\n                        ' ',\n                        react_1.default.createElement(\"span\", { className: classes.allowSelect }, item.path))),\n                react_1.default.createElement(Tooltip_1.default, { title: react_1.default.createElement(react_1.default.Fragment, null,\n                        react_1.default.createElement(Typography_1.default, { variant: \"body1\" },\n                            \"Download: \",\n                            item.path)) },\n                    react_1.default.createElement(IconButton_1.default, { disableRipple: true, className: classes.treeItemIcon, color: \"primary\", onClick: function () { return fileClick(project, item.path); } },\n                        react_1.default.createElement(CloudDownload_1.default, null)))), endIcon: lookup.icon }));\n    }\n};\nexports.default = RecurseTreeItem;\n//# sourceMappingURL=RecurseTreeItem.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = (function (theme) { return ({\n    treeItemRoot: {\n        backgroundColor: theme.palette.background.paper,\n        '&:nth-child(odd)': {\n            backgroundColor: theme.palette.background.default\n        }\n    },\n    treeItemContainer: {\n        display: 'flex'\n    },\n    treeItemText: {\n        marginLeft: theme.spacing(1),\n        padding: theme.spacing(1),\n        flexGrow: 1\n    },\n    treeItemIcon: {},\n    treeFile: {},\n    treeFileContent: {\n        borderBottom: \"1px solid \" + theme.palette.grey[100]\n    },\n    treeFolder: {},\n    treeFolderContent: {},\n    treeFolderText: {\n        padding: theme.spacing(1)\n    },\n    allowSelect: {\n        '&,& *': {\n            userSelect: 'text',\n            cursor: 'auto'\n        }\n    }\n}); });\n//# sourceMappingURL=RecurseTreeItem.style.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar colors_1 = require(\"@material-ui/core/colors\");\nexports.default = (function (theme) { return ({\n    root: {\n        margin: 0,\n        padding: theme.spacing(2)\n    },\n    allowSelect: {\n        '&,& *': {\n            userSelect: 'text',\n            cursor: 'auto'\n        }\n    },\n    scrollPaper: {\n        alignItems: 'baseline'\n    },\n    name: {\n        maxWidth: '95%',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        marginBottom: theme.spacing(1)\n    },\n    titlebar: {\n        backgroundColor: '#444444',\n        color: theme.palette.primary.contrastText,\n        display: 'flex'\n    },\n    titlebarLeft: {\n        flexGrow: 1\n    },\n    header: {\n        display: 'flex'\n    },\n    headerLeft: {\n        flex: '1 1 80%'\n    },\n    headerRight: {\n        textAlign: 'right',\n        flex: '1 0'\n    },\n    flexGrow: {\n        flexGrow: 1\n    },\n    closeButton: {\n        flex: '0 0',\n        color: theme.palette.grey[500]\n    },\n    normalIcon: {},\n    documentIcon: {\n        color: colors_1.red[500]\n    },\n    photoIcon: {\n        color: colors_1.purple[500]\n    },\n    TerrainIcon: {\n        color: colors_1.green[500]\n    },\n    metaDisplay: {\n        display: 'flex',\n        flexFlow: 'wrap'\n    },\n    title: {\n        marginTop: theme.spacing(2)\n    },\n    treeItemContainer: {\n        display: 'flex'\n    },\n    treeItemText: {\n        marginLeft: theme.spacing(1),\n        flexGrow: 1\n    },\n    treeItemIcon: {},\n    treeFileContent: {\n        borderBottom: \"1px solid \" + theme.palette.grey[100],\n        padding: theme.spacing(1)\n    },\n    treeFolder: {},\n    treeFolderContent: {\n        padding: theme.spacing(1)\n    },\n    metaDisplayItem: {\n        flex: '1 1',\n        borderRadius: theme.spacing(1),\n        backgroundColor: '#fafafa',\n        margin: theme.spacing(1, 0.5),\n        border: '#1px solid #e7e7e7',\n        padding: theme.spacing(1),\n        maxWidth: '25%',\n        minWidth: 150,\n        '&>*': {\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis'\n        }\n    },\n    prodChip: {\n        marginLeft: theme.spacing(1),\n        backgroundColor: theme.palette.primary.light,\n        color: 'white'\n    },\n    popOver: {\n        padding: theme.spacing(2)\n    },\n    subHeader: {\n        width: '100%',\n        display: 'flex'\n    }\n}); });\n//# sourceMappingURL=ProjectModal.style.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar Typography_1 = __importDefault(require(\"@material-ui/core/Typography\"));\nvar Button_1 = __importDefault(require(\"@material-ui/core/Button\"));\nvar Paper_1 = __importDefault(require(\"@material-ui/core/Paper\"));\nvar Container_1 = __importDefault(require(\"@material-ui/core/Container\"));\nvar LockOpen_1 = __importDefault(require(\"@material-ui/icons/LockOpen\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar useStyles = styles_1.makeStyles(function (theme) { return ({\n    rootContainer: {\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'column'\n    },\n    spacer: {\n        flexGrow: 1\n    },\n    root: {\n        padding: theme.spacing(2, 4, 4, 4)\n    },\n    logoContainer: {\n        padding: theme.spacing(2),\n        textAlign: 'center'\n    },\n    logo: {}\n}); });\nvar LoginScreen = function (_a) {\n    var title = _a.title, signIn = _a.signIn;\n    var classes = useStyles();\n    return (react_1.default.createElement(Container_1.default, { className: classes.rootContainer, maxWidth: \"md\" },\n        react_1.default.createElement(\"div\", { className: classes.spacer }),\n        react_1.default.createElement(Paper_1.default, { className: classes.root },\n            react_1.default.createElement(\"div\", { className: classes.logoContainer },\n                react_1.default.createElement(\"img\", { className: classes.logo, src: process.env.PUBLIC_URL + '/RiverscapesLogo.png', alt: \"logo\" })),\n            react_1.default.createElement(Typography_1.default, { paragraph: true, variant: \"body1\" },\n                \"Welcome to \",\n                react_1.default.createElement(\"strong\", null, title),\n                \". Please click the button below to log in.\"),\n            react_1.default.createElement(Typography_1.default, { paragraph: true, variant: \"body1\" }, \"If you don't have an account you will be prompted to use your Google account or create a new account using another email address.\"),\n            react_1.default.createElement(Button_1.default, { variant: \"contained\", onClick: signIn, color: \"primary\", fullWidth: true, size: \"large\", startIcon: react_1.default.createElement(LockOpen_1.default, null) }, \"Sign In\")),\n        react_1.default.createElement(\"div\", { className: classes.spacer })));\n};\nexports.default = LoginScreen;\n//# sourceMappingURL=LoginScreen.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar Dialog_1 = __importDefault(require(\"@material-ui/core/Dialog\"));\nvar DialogTitle_1 = __importDefault(require(\"@material-ui/core/DialogTitle\"));\nvar DialogContent_1 = __importDefault(require(\"@material-ui/core/DialogContent\"));\nvar DialogActions_1 = __importDefault(require(\"@material-ui/core/DialogActions\"));\nvar Button_1 = __importDefault(require(\"@material-ui/core/Button\"));\nvar Error_1 = __importDefault(require(\"@material-ui/icons/Error\"));\nvar Typography_1 = __importDefault(require(\"@material-ui/core/Typography\"));\nvar useStyles = styles_1.makeStyles(function (theme) { return ({\n    root: {\n        marginLeft: theme.spacing(1)\n    },\n    titlebar: {\n        display: 'flex',\n        background: theme.palette.error.main,\n        color: theme.palette.error.contrastText\n    },\n    closeButton: {},\n    name: {\n        paddingLeft: theme.spacing(1),\n        flexGrow: 1\n    }\n}); });\nvar ProjectModal = function (_a) {\n    var onClose = _a.onClose, program = _a.program;\n    var classes = useStyles();\n    return (react_1.default.createElement(Dialog_1.default, { onClose: onClose, open: true, maxWidth: \"xs\", fullWidth: true, className: classes.root, classes: {} },\n        react_1.default.createElement(DialogTitle_1.default, { disableTypography: true, className: classes.titlebar },\n            react_1.default.createElement(Error_1.default, { color: \"inherit\" }),\n            react_1.default.createElement(Typography_1.default, { className: classes.name }, \"Access Denied\")),\n        react_1.default.createElement(DialogContent_1.default, { dividers: true }, program ? (react_1.default.createElement(Typography_1.default, { variant: \"body1\", component: \"div\", color: \"inherit\" },\n            \"You don't have access to the program \",\n            react_1.default.createElement(\"strong\", null, program.name),\n            \".\",\n            'If you arrived here via URL you will be able to use the URL ',\n            'again once you have access.')) : (react_1.default.createElement(Typography_1.default, { variant: \"body1\", component: \"div\", color: \"inherit\" }, 'This URL is not valid. If you arrived here via URL you will be able to use the URL again once you have access.'))),\n        react_1.default.createElement(DialogActions_1.default, null,\n            react_1.default.createElement(Button_1.default, { onClick: onClose, color: \"primary\" }, 'Back'))));\n};\nexports.default = ProjectModal;\n//# sourceMappingURL=NotAllowedModal.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = require(\"react\");\nvar common_1 = require(\"@riverscapes/common\");\nvar lodash_1 = __importDefault(require(\"lodash\"));\nvar loglevel_1 = __importDefault(require(\"loglevel\"));\nvar config_1 = require(\"../config\");\nvar useDownload = function (auth, program) {\n    var _a = react_1.useState({}), pendingZips = _a[0], setPendingZips = _a[1];\n    var pendingZipsRef = react_1.useRef();\n    pendingZipsRef.current = pendingZips;\n    var downloadFileFn = react_1.useCallback(function (project, fkey) { return __awaiter(void 0, void 0, void 0, function () {\n        var jwt, res, error_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (!program)\n                        return [2, Promise.resolve()];\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 4, , 5]);\n                    return [4, auth.getCurrentToken()];\n                case 2:\n                    jwt = _a.sent();\n                    return [4, common_1.downloadFile(config_1.endpoints.graphql, jwt, project.projType, program.machineName, project.id, fkey)];\n                case 3:\n                    res = _a.sent();\n                    try {\n                        if (res.data)\n                            window.open(res.data.downloadFile.downloadUrl, '_self');\n                    }\n                    catch (err) {\n                        loglevel_1.default.error('DOWNLOAD err', err);\n                    }\n                    return [3, 5];\n                case 4:\n                    error_1 = _a.sent();\n                    loglevel_1.default.error('DOWNLOAD err', error_1);\n                    return [3, 5];\n                case 5: return [2];\n            }\n        });\n    }); }, [program, auth]);\n    var downloadZipFile = react_1.useCallback(function (project) {\n        if (!program)\n            return Promise.resolve();\n        var checkZipFunc = function () {\n            return auth\n                .getCurrentToken()\n                .then(function (jwt) {\n                return common_1.downloadZipFile(config_1.endpoints.graphql, jwt, project.projType, program.machineName, project.id);\n            })\n                .then(function (res) {\n                var _a;\n                try {\n                    if (res.data && !res.data.downloadZip.pendingSince) {\n                        setPendingZips(lodash_1.default.pickBy(pendingZipsRef.current, function (val, key) { return key !== project.id; }));\n                        window.open(res.data.downloadZip.downloadUrl, '_self');\n                    }\n                    else {\n                        setPendingZips(__assign(__assign({}, pendingZipsRef.current), (_a = {}, _a[project.id] = res.data ? res.data.downloadZip.pendingSince : Date.now(), _a)));\n                        setTimeout(checkZipFunc, 5000);\n                    }\n                }\n                catch (err) {\n                    loglevel_1.default.error('DOWNLOAD err', err);\n                }\n            })\n                .catch(function (err) {\n                loglevel_1.default.error('DOWNLOAD err', err);\n            });\n        };\n        return checkZipFunc();\n    }, [program, auth]);\n    return {\n        pendingZips: pendingZipsRef.current,\n        downloadFileFn: downloadFileFn,\n        downloadZipFile: downloadZipFile\n    };\n};\nexports.default = useDownload;\n//# sourceMappingURL=useDownloads.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = require(\"react\");\nvar react_router_dom_1 = require(\"react-router-dom\");\nvar config_1 = require(\"../config\");\nvar loglevel_1 = __importDefault(require(\"loglevel\"));\nvar useProgram = function (programs, onProgramChange) {\n    var _a = react_1.useState(), program = _a[0], setProgram = _a[1];\n    var programId = react_router_dom_1.useParams().programId;\n    var currProgramRef = react_1.useRef();\n    currProgramRef.current = program;\n    react_1.useEffect(function () {\n        if (!programId || programId.length < 0)\n            return;\n        try {\n            var newProg = programs === null || programs === void 0 ? void 0 : programs.find(function (p) { return p.machineName === programId; });\n            if (newProg && (!currProgramRef.current || currProgramRef.current.machineName !== newProg.machineName)) {\n                newProg.collections = newProg.collections.map(function (c, idx) { return (__assign(__assign({}, c), { color: config_1.mandatoryMetaColors[idx % config_1.mandatoryMetaColors.length] })); });\n                currProgramRef.current = newProg;\n                loglevel_1.default.debug('useProgram', { programId: programId, newProg: newProg, programs: programs });\n                setProgram(newProg);\n                if (onProgramChange)\n                    onProgramChange(newProg);\n            }\n        }\n        catch (_a) {\n            return;\n        }\n    }, [programs, programId, onProgramChange]);\n    return program;\n};\nexports.default = useProgram;\n//# sourceMappingURL=useProgram.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = require(\"react\");\nvar react_router_dom_1 = require(\"react-router-dom\");\nvar common_1 = require(\"@riverscapes/common\");\nvar config_1 = require(\"../config\");\nvar loglevel_1 = __importDefault(require(\"loglevel\"));\nvar useProject = function (auth, program, files, tree) {\n    if (files === void 0) { files = false; }\n    if (tree === void 0) { tree = false; }\n    var projectId = react_router_dom_1.useParams().projectId;\n    var _a = react_1.useState({ loading: false, initialized: false }), projState = _a[0], setProjState = _a[1];\n    var currProjectStateRef = react_1.useRef();\n    currProjectStateRef.current = projState;\n    react_1.useEffect(function () {\n        if (!projectId || projectId.length < 2) {\n            setProjState({ loading: false, initialized: true });\n            return;\n        }\n        try {\n            if (!program || !projectId)\n                return;\n            var progMachineName_1 = program.machineName;\n            var done_1 = false;\n            setTimeout(function () {\n                if (!done_1)\n                    setProjState(__assign(__assign({}, currProjectStateRef.current), { loading: true }));\n            }, 500);\n            auth.getCurrentToken()\n                .then(function (jwt) { return common_1.getProject(config_1.endpoints.graphql, jwt, projectId, progMachineName_1, files, tree); })\n                .then(function (res) {\n                var _a;\n                done_1 = true;\n                loglevel_1.default.debug('getProjectById::Response', res);\n                if (res.data &&\n                    res.data.project &&\n                    currProjectStateRef.current &&\n                    currProjectStateRef.current.project &&\n                    ((_a = currProjectStateRef.current) === null || _a === void 0 ? void 0 : _a.project.id) === res.data.project.id) {\n                    return;\n                }\n                else if (res.data) {\n                    setProjState({ project: res.data.project, loading: false, initialized: true });\n                }\n                else {\n                    setProjState({ project: undefined, loading: false, initialized: true });\n                }\n            })\n                .catch(function (err) {\n                done_1 = true;\n                setProjState({ project: undefined, loading: false, initialized: true });\n                loglevel_1.default.error('api.getProjectById error', err);\n            });\n        }\n        catch (_a) {\n            return;\n        }\n    }, [projectId, program, auth]);\n    return projState;\n};\nexports.default = useProject;\n//# sourceMappingURL=useProject.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.hashHistory = void 0;\nvar react_1 = require(\"react\");\nvar react_router_dom_1 = require(\"react-router-dom\");\nvar loglevel_1 = __importDefault(require(\"loglevel\"));\nvar base64url_1 = __importDefault(require(\"base64url\"));\nvar history_1 = require(\"history\");\nvar lodash_1 = require(\"lodash\");\nexports.hashHistory = history_1.createHashHistory();\nvar useQueryParams = function (pathPattern) {\n    var params = react_router_dom_1.useParams();\n    var _a = react_1.useState(), userQuery = _a[0], _setUserQuery = _a[1];\n    var _b = react_1.useState(), decoded = _b[0], setDecoded = _b[1];\n    var setQuery = function (input) {\n        var changes = {};\n        Object.keys(input).forEach(function (k) {\n            var stringVal = encode(input[k]);\n            if (!params[k] || params[k] !== stringVal) {\n                changes[k] = stringVal;\n            }\n        });\n        if (Object.keys(changes).length > 0) {\n            loglevel_1.default.debug('DEBUG::useQueryParams setQuery', { input: input, params: params, changes: changes });\n            setDecoded(__assign(__assign({}, params), input));\n            exports.hashHistory.replace(react_router_dom_1.generatePath(pathPattern, __assign(__assign({}, params), changes)));\n        }\n    };\n    react_1.useEffect(function () {\n        var newDecoded = decode(params);\n        if (!lodash_1.isEqual(decoded, newDecoded)) {\n            loglevel_1.default.debug('DEBUG::useQueryParams setDecoded', { newDecoded: newDecoded, params: params });\n            setDecoded(newDecoded);\n            _setUserQuery(newDecoded);\n        }\n    }, [params]);\n    return { query: decoded, userQuery: userQuery, setQuery: setQuery };\n};\nexports.default = useQueryParams;\nfunction encode(qry) {\n    if (qry === null || lodash_1.isUndefined(qry))\n        return null;\n    switch (typeof qry) {\n        case 'string':\n            return qry;\n        default:\n            if (typeof qry === 'object' && Object.keys(qry).length === 0) {\n                return '';\n            }\n            else {\n                return '~' + base64url_1.default(JSON.stringify(qry));\n            }\n    }\n}\nfunction decode(input) {\n    return Object.keys(input).reduce(function (acc, k) {\n        var _a;\n        var output = null;\n        try {\n            if (input[k].length > 0) {\n                if (input[k][0] === '~')\n                    output = JSON.parse(base64url_1.default.decode(input[k].slice(1)));\n                else\n                    output = input[k];\n            }\n        }\n        catch (_b) {\n            output = input[k];\n        }\n        return __assign(__assign({}, acc), (_a = {}, _a[k] = output, _a));\n    }, {});\n}\n//# sourceMappingURL=useQueryParams.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar colors_1 = require(\"@material-ui/core/colors\");\nvar home = {\n    palette: {\n        primary: {\n            main: colors_1.indigo[500]\n        },\n        secondary: {\n            main: colors_1.orange[600],\n            contrastText: '#FFFFFF'\n        },\n        text: {}\n    }\n};\nvar homeDark = __assign(__assign({}, home), { palette: __assign(__assign({}, home.palette), { type: 'dark' }) });\nexports.default = {\n    home: styles_1.createMuiTheme(home),\n    homeDark: styles_1.createMuiTheme(homeDark)\n};\n//# sourceMappingURL=themes.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.event = exports.currentPageView = exports.init = void 0;\nvar react_ga_1 = __importDefault(require(\"react-ga\"));\nvar config_1 = require(\"./config\");\nvar loglevel_1 = __importDefault(require(\"loglevel\"));\nvar init = function () {\n    if (config_1.googleAnalytics)\n        react_ga_1.default.initialize(config_1.googleAnalytics, {\n            debug: true,\n            titleCase: false\n        });\n    else\n        loglevel_1.default.error('Google Analytics: no UA- code found');\n};\nexports.init = init;\nvar currentPageView = function () {\n    react_ga_1.default.pageview(window.location.pathname + window.location.hash);\n};\nexports.currentPageView = currentPageView;\nvar event = function (category, action, label) {\n    react_ga_1.default.event({\n        category: category,\n        action: action,\n        label: label\n    });\n};\nexports.event = event;\n//# sourceMappingURL=googleAnalytics.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar createSvgIcon_1 = __importDefault(require(\"@material-ui/icons/utils/createSvgIcon\"));\nexports.default = createSvgIcon_1.default(react_1.default.createElement(react_1.default.Fragment, null,\n    react_1.default.createElement(\"circle\", { vectorEffect: \"non-scaling-stroke\", cx: \"5.5\", cy: \"5.5\", r: \"2.5\" }),\n    react_1.default.createElement(\"circle\", { vectorEffect: \"non-scaling-stroke\", cx: \"5.5\", cy: \"18.5\", r: \"2.5\" }),\n    react_1.default.createElement(\"circle\", { vectorEffect: \"non-scaling-stroke\", cx: \"12\", cy: \"12\", r: \"2.5\" }),\n    react_1.default.createElement(\"circle\", { vectorEffect: \"non-scaling-stroke\", cx: \"18.5\", cy: \"10\", r: \"2.5\" }),\n    react_1.default.createElement(\"circle\", { vectorEffect: \"non-scaling-stroke\", cx: \"17.5\", cy: \"16.5\", r: \"2.5\" })), 'Multidot');\n//# sourceMappingURL=Multidot.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar createSvgIcon_1 = __importDefault(require(\"@material-ui/icons/utils/createSvgIcon\"));\nexports.default = createSvgIcon_1.default(react_1.default.createElement(react_1.default.Fragment, null,\n    react_1.default.createElement(\"path\", { d: \" M 5.932 4.519 C 5.976 4.353 6 4.179 6 4 C 6 2.896 5.104 2 4 2 C 2.896 2 2 2.896 2 4 L 2 4 L 2 4 L 2 4 L 2 4 C 2 4.74 2.402 5.386 3 5.732 L 3 18.268 C 2.402 18.614 2 19.26 2 20 L 2 20 L 2 20 L 2 20 L 2 20 C 2 21.104 2.896 22 4 22 C 4.74 22 5.386 21.598 5.732 21 L 18.268 21 L 18.268 21 C 18.614 21.598 19.26 22 20 22 C 21.104 22 22 21.104 22 20 C 22 19.26 21.598 18.614 21 18.268 L 21 9.732 L 21 9.732 C 21.598 9.386 22 8.74 22 8 C 22 6.896 21.104 6 20 6 C 18.937 6 18.067 6.831 18.004 7.878 L 13.1 10.33 C 12.784 10.121 12.406 10 12 10 C 11.822 10 11.65 10.023 11.486 10.067 L 5.932 4.519 Z  M 5 18.268 C 5.303 18.444 5.556 18.697 5.732 19 L 18.268 19 C 18.444 18.697 18.697 18.444 19 18.268 L 19 9.732 C 18.966 9.712 18.933 9.692 18.9 9.67 L 13.996 12.122 C 13.933 13.169 13.063 14 12 14 C 10.896 14 10 13.104 10 12 L 10 12 C 10 11.822 10.023 11.649 10.067 11.485 L 5 6.41 L 5 18.268 Z \", fillRule: \"evenodd\" })), 'Polygon');\n//# sourceMappingURL=Polygon.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar createSvgIcon_1 = __importDefault(require(\"@material-ui/icons/utils/createSvgIcon\"));\nexports.default = createSvgIcon_1.default(react_1.default.createElement(react_1.default.Fragment, null,\n    react_1.default.createElement(\"circle\", { vectorEffect: \"non-scaling-stroke\", cx: \"4\", cy: \"13\", r: \"2\" }),\n    react_1.default.createElement(\"circle\", { vectorEffect: \"non-scaling-stroke\", cx: \"12\", cy: \"9\", r: \"2\" }),\n    react_1.default.createElement(\"circle\", { vectorEffect: \"non-scaling-stroke\", cx: \"20\", cy: \"13\", r: \"2\" }),\n    react_1.default.createElement(\"path\", { d: \" M 4.45 13.89 L 3.55 14.34 L 2.66 12.55 L 3.55 12.11 L 12 7.88 L 20.45 12.11 L 21.34 12.55 L 20.45 14.34 L 19.55 13.89 L 12 10.12 L 4.45 13.89 Z \" })), 'Polyline');\n//# sourceMappingURL=Polyline.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar createSvgIcon_1 = __importDefault(require(\"@material-ui/icons/utils/createSvgIcon\"));\nexports.default = createSvgIcon_1.default(react_1.default.createElement(react_1.default.Fragment, null,\n    react_1.default.createElement(\"path\", { d: \"M22,2l0,20l-20,0l0,-20l20,0Zm-2,2l-16,0l0,16l16,0l0,-16Z\" }),\n    react_1.default.createElement(\"rect\", { x: \"5\", y: \"5\", width: \"4\", height: \"4\" }),\n    react_1.default.createElement(\"rect\", { x: \"15\", y: \"5\", width: \"4\", height: \"4\" }),\n    react_1.default.createElement(\"rect\", { x: \"5\", y: \"15\", width: \"4\", height: \"4\" }),\n    react_1.default.createElement(\"rect\", { x: \"10\", y: \"10\", width: \"1\", height: \"5\" }),\n    react_1.default.createElement(\"rect\", { x: \"11\", y: \"10\", width: \"6\", height: \"2\" }),\n    react_1.default.createElement(\"rect\", { x: \"11\", y: \"12\", width: \"2\", height: \"2\" }),\n    react_1.default.createElement(\"rect\", { x: \"13\", y: \"7\", width: \"1\", height: \"2\" }),\n    react_1.default.createElement(\"rect\", { x: \"14\", y: \"9\", width: \"1\", height: \"1\" }),\n    react_1.default.createElement(\"rect\", { x: \"8\", y: \"10\", width: \"1\", height: \"4\" }),\n    react_1.default.createElement(\"rect\", { x: \"7\", y: \"11\", width: \"1\", height: \"3\" }),\n    react_1.default.createElement(\"rect\", { x: \"9\", y: \"11\", width: \"1\", height: \"1\" }),\n    react_1.default.createElement(\"rect\", { x: \"10\", y: \"6\", width: \"2\", height: \"3\" }),\n    react_1.default.createElement(\"rect\", { x: \"12\", y: \"7\", width: \"1\", height: \"1\" }),\n    react_1.default.createElement(\"rect\", { x: \"15\", y: \"14\", width: \"2\", height: \"4\" }),\n    react_1.default.createElement(\"rect\", { x: \"14\", y: \"14\", width: \"1\", height: \"1\" }),\n    react_1.default.createElement(\"rect\", { x: \"17\", y: \"15\", width: \"2\", height: \"2\" }),\n    react_1.default.createElement(\"rect\", { x: \"11\", y: \"16\", width: \"1\", height: \"3\" }),\n    react_1.default.createElement(\"rect\", { x: \"12\", y: \"15\", width: \"2\", height: \"2\" }),\n    react_1.default.createElement(\"rect\", { x: \"10\", y: \"18\", width: \"1\", height: \"1\" })), 'QRCode');\n//# sourceMappingURL=QRCode.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar createSvgIcon_1 = __importDefault(require(\"@material-ui/icons/utils/createSvgIcon\"));\nexports.default = createSvgIcon_1.default(react_1.default.createElement(react_1.default.Fragment, null,\n    react_1.default.createElement(\"g\", null,\n        react_1.default.createElement(\"g\", { transform: \"matrix(1,0,0,1,-1.77636e-15,3.97768)\" },\n            react_1.default.createElement(\"rect\", { x: \"4\", y: \"4.022\", width: \"4\", height: \"3.978\" })),\n        react_1.default.createElement(\"g\", { transform: \"matrix(1,0,0,1,0,11.9777)\" },\n            react_1.default.createElement(\"rect\", { x: \"4\", y: \"4.022\", width: \"4\", height: \"3.978\" })),\n        react_1.default.createElement(\"g\", { transform: \"matrix(1,0,0,1,8,4)\" },\n            react_1.default.createElement(\"rect\", { x: \"4\", y: \"4.022\", width: \"4\", height: \"3.978\" })),\n        react_1.default.createElement(\"g\", { transform: \"matrix(1,0,0,1,8,12)\" },\n            react_1.default.createElement(\"rect\", { x: \"4\", y: \"4.022\", width: \"4\", height: \"3.978\" })),\n        react_1.default.createElement(\"g\", { transform: \"matrix(1,0,0,1,4,-0.0223232)\" },\n            react_1.default.createElement(\"rect\", { x: \"4\", y: \"4.022\", width: \"4\", height: \"3.978\" })),\n        react_1.default.createElement(\"g\", { transform: \"matrix(1,0,0,1,4,7.97768)\" },\n            react_1.default.createElement(\"rect\", { x: \"4\", y: \"4.022\", width: \"4\", height: \"3.978\" })),\n        react_1.default.createElement(\"g\", { transform: \"matrix(1,0,0,1,12,0)\" },\n            react_1.default.createElement(\"rect\", { x: \"4\", y: \"4.022\", width: \"4\", height: \"3.978\" })),\n        react_1.default.createElement(\"g\", { transform: \"matrix(1,0,0,1,12,8)\" },\n            react_1.default.createElement(\"rect\", { x: \"4\", y: \"4.022\", width: \"4\", height: \"3.978\" }))),\n    react_1.default.createElement(\"g\", { id: \"Raster\" },\n        react_1.default.createElement(\"path\", { d: \"M21,5.432C21,4.09 19.91,3 18.568,3L5.432,3C4.09,3 3,4.09 3,5.432L3,18.568C3,19.91 4.09,21 5.432,21L18.568,21C19.91,21 21,19.91 21,18.568L21,5.432Z\", style: { fillOpacity: 0 } }),\n        react_1.default.createElement(\"path\", { d: \"M22,5.432C22,3.538 20.462,2 18.568,2L5.432,2C3.538,2 2,3.538 2,5.432L2,18.568C2,20.462 3.538,22 5.432,22L18.568,22C20.462,22 22,20.462 22,18.568L22,5.432ZM20,5.432L20,18.568C20,19.358 19.358,20 18.568,20C18.568,20 5.432,20 5.432,20C4.642,20 4,19.358 4,18.568C4,18.568 4,5.432 4,5.432C4,4.642 4.642,4 5.432,4C5.432,4 18.568,4 18.568,4C19.358,4 20,4.642 20,5.432Z\" }))), 'Multidot');\n//# sourceMappingURL=Raster.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(require(\"react\"));\nvar common_1 = require(\"@riverscapes/common\");\nvar styles_1 = require(\"@material-ui/core/styles\");\nvar InsertDriveFile_1 = __importDefault(require(\"@material-ui/icons/InsertDriveFile\"));\nvar Description_1 = __importDefault(require(\"@material-ui/icons/Description\"));\nvar _1 = require(\"./\");\nvar useStyles = styles_1.makeStyles(function () { return ({\n    root: {}\n}); });\nvar LayerIcon = function (_a) {\n    var layerType = _a.layerType, iconProps = _a.iconProps, className = _a.className;\n    var classes = useStyles();\n    var Icon = _1.Multidot;\n    switch (layerType) {\n        case common_1.ProjectTreeLayerTypes.POINT:\n            Icon = _1.Multidot;\n            break;\n        case common_1.ProjectTreeLayerTypes.LINE:\n            Icon = _1.Polyline;\n            break;\n        case common_1.ProjectTreeLayerTypes.POLYGON:\n            Icon = _1.Polygon;\n            break;\n        case common_1.ProjectTreeLayerTypes.RASTER:\n            Icon = _1.Raster;\n            break;\n        case common_1.ProjectTreeLayerTypes.FILE:\n            Icon = InsertDriveFile_1.default;\n            break;\n        case common_1.ProjectTreeLayerTypes.REPORT:\n            Icon = Description_1.default;\n            break;\n        default:\n            break;\n    }\n    return react_1.default.createElement(Icon, __assign({ className: className || classes.root }, iconProps));\n};\nexports.default = LayerIcon;\n//# sourceMappingURL=LayerIcon.js.map","import React from 'react'\nimport { History, useHistory } from 'react-router-dom'\nimport log from 'loglevel'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport { AppFrame } from '@northarrowresearch/react-common'\nimport { ContainerProps } from '@material-ui/core/Container'\n\nimport { Topbar, themes } from '@riverscapes/react-common'\n\ninterface Props {\n    title: string\n    children: React.ReactChild | React.ReactChildren | React.ReactElement\n    history?: History\n    containerProps?: Partial<ContainerProps>\n    signOut?: () => Promise<void>\n}\n\n/**\n * Note: We keep this as a separate component in case WebRAVE needs a second screen\n * (like a settings screen or something)\n * It's basically the screen template with topbar and app frame all set up\n * @param param0\n * @returns\n */\nconst AppWrapper: React.FC<Props> = ({ title, children, history, signOut, containerProps }: Props) => {\n    return (\n        <ThemeProvider theme={themes.home}>\n            <AppFrame\n                containerProps={{ maxWidth: 'md', ...containerProps }}\n                noScroll\n                fullWidth\n                topbar={\n                    <Topbar history={history} title={title} signOutHandler={signOut} shareUrl={window.location.href} />\n                }\n                // footer={<Footer version={config.version as string} />}\n            >\n                <>{children}</>\n            </AppFrame>\n        </ThemeProvider>\n    )\n}\nexport default AppWrapper\n\n/**\n * The cosmos wrapper is here to make our cosmos experience prettier\n * @param param0\n * @returns\n */\nexport const CosmosAppWrapper: React.FC<Props> = ({ children, containerProps }: Props) => {\n    const signOut = (): Promise<void> => Promise.resolve(log.info('logging out'))\n    const history = useHistory()\n    return (\n        <ThemeProvider theme={themes.home}>\n            <AppFrame\n                containerProps={{ maxWidth: 'md', ...containerProps }}\n                noScroll\n                fullWidth\n                topbar={\n                    <Topbar\n                        history={history}\n                        title=\"Riverscapes Warehouse\"\n                        signOutHandler={signOut}\n                        shareUrl={window.location.href}\n                    />\n                }\n            >\n                {children}\n            </AppFrame>\n        </ThemeProvider>\n    )\n}\n","import React from 'react'\n// import log from 'loglevel'\n// import { useHosted } from '@northarrowresearch/react-auth'\nimport { Typography, CircularProgress } from '@material-ui/core'\nimport { Loading } from '@northarrowresearch/react-common'\n\ninterface Props {\n    title?: string\n}\n\nconst ProjectLoading: React.FC<Props> = ({ title }: Props) => {\n    return (\n        <Loading\n            logoSVG={<CircularProgress size=\"7rem\" thickness={7} />}\n            status={\n                <Typography variant=\"h5\" component=\"div\">\n                    {title || 'Loading...'}\n                </Typography>\n            }\n            containerProps={{\n                maxWidth: 'xl',\n                style: {\n                    position: 'absolute',\n                    zIndex: 1000,\n                    top: 0,\n                    left: 0,\n                    width: '100%',\n                    height: '100%',\n                    background: '#FFFFFF77'\n                }\n            }}\n        />\n    )\n}\n\nexport default ProjectLoading\n","import Satellite from './SatStreets.json'\n// import Satellite from './Satellite.json'\nimport BasicMap from './BasicMap.json'\n// import TopoMap from './TopoMap.json'\nimport GrayscaleHS from './GrayscaleHS.json'\nimport { BaseLayer } from '../types'\n\nimport {\n    // Satellite as SatIcon,\n    SatelliteOutlined,\n    // Terrain,\n    // DirectionsCar,\n    DirectionsCarOutlined,\n    TerrainOutlined\n} from '@material-ui/icons'\n\nconst mapStyles: BaseLayer[] = [\n    {\n        id: 'SATELLITE',\n        title: 'Satellite Imagery',\n        toolTip: 'Satellite Imagery',\n        Icon: SatelliteOutlined,\n        color: 'green',\n        style: Satellite\n    },\n    {\n        id: 'STREET',\n        title: 'Street Map',\n        toolTip: 'Street Map',\n        Icon: DirectionsCarOutlined,\n        color: 'blue',\n        style: BasicMap\n    },\n    {\n        id: 'HILLSHADE',\n        title: 'Hillshade',\n        toolTip: 'Hillshade',\n        Icon: TerrainOutlined,\n        color: 'blue',\n        style: GrayscaleHS\n    }\n]\n\nexport default mapStyles\n","import { red, green, blue, orange, purple, cyan, lime, brown } from '@material-ui/core/colors'\nimport { Color } from '@material-ui/core'\nimport log from 'loglevel'\nimport baseLayers from './mapStyles'\n\nlet domain = process.env.REACT_APP_DOMAIN\nif (process.env.NODE_ENV && process.env.NODE_ENV === 'development') {\n    domain = 'localhost'\n    // basename = ''\n}\nlog.debug('config: ', { domain })\nexport const isDev = process.env.NODE_ENV && process.env.NODE_ENV === 'development'\nexport const version = process.env.REACT_APP_VERSION\n\nexport const endpoints = {\n    graphql: `${process.env.REACT_APP_GRAPHQL}`\n}\n\nexport const warehouseIconUrl = process.env.PUBLIC_URL + '/RiverscapesLogo.png'\nexport const warehouseUrl = process.env.REACT_APP_WAREHOUSE_URL\n\n/**\n * Here are the App defaults we might want to change\n */\nexport const appDefaults = {\n    appName: 'Riverscapes Project Viewer (webRAVE)',\n    zoomRange: [2, 18], // Think of this like the min and max possible zooms\n    worldBounds: [-180, -90, 180, 90], // the maximum possible bounds\n    baseLayer: baseLayers[0],\n    drawerOpen: true,\n    init: false,\n    minFilterTextLength: 3,\n    maxMapLayers: 5,\n    retryDelayS: 2,\n    refreshDelayS: 20\n}\n\nexport const appRouterPath = '/:programId/:projectId/:config?'\n\nexport const mandatoryMetaColors: Color[] = [red, green, blue, orange, purple, cyan, lime, brown]\n// These are used if the symbology fails to load\nexport const legendColors: Color[] = [red, green, blue, orange, purple, cyan, lime, brown]\n\nexport const redirectUrl = new URL(\n    process.env.PUBLIC_URL.endsWith('/') ? process.env.PUBLIC_URL : process.env.PUBLIC_URL + '/',\n    window.location.origin\n)\n\nconsole.log('RedirectUrl', { redirectUrl, publicUrl: process.env.PUBLIC_URL })\n","import { appDefaults } from '../config'\nimport { Project, SymbologyJSON, ProjectTreeLeaf, ProjectTreeLayerTypes } from '@riverscapes/common'\nimport { Color } from '@material-ui/core'\nimport { decomposeColor, recomposeColor } from '@material-ui/core/styles/colorManipulator'\n\nexport type FallbackColor = { fg: string; bg: string }\n\n// It's annoying that MaterialUI doesn't expose Alpha function\n// Hopefully this stays put over the next few versions\nexport function addColorAlpha(inColor: string, alpha: number): string {\n    const bgTmp = decomposeColor(inColor)\n    if (bgTmp.type === 'rgb' || bgTmp.type === 'hsl') {\n        bgTmp.type += 'a'\n    }\n    bgTmp.values[3] = alpha\n    const bg = recomposeColor(bgTmp)\n    return bg\n}\n\n/**\n * Tricky problem. Return a string color hex value from a symbology file\n * @param sym\n */\n//  [\n//     {\n//         \"id\": \"bratreachgeometry-bv59z4\",\n//         \"type\": \"line\",\n//         \"source\": \"composite\",\n//         \"source-layer\": \"bratReachGeometry-bv59z4\",\n//         \"layout\": {},\n//         \"paint\": {\"line-color\": \"hsl(0, 100%, 44%)\", \"line-width\": 10}\n//     },\n//     {\n//         \"id\": \"bratreachgeometry-bv59z4 copy\",\n//         \"type\": \"symbol\",\n//         \"source\": \"composite\",\n//         \"source-layer\": \"bratReachGeometry-bv59z4\",\n//         \"layout\": {\"text-field\": [\"get\", \"NHDPlusID\"]},\n//         \"paint\": {\"text-color\": \"hsl(0, 0%, 100%)\"}\n//     }\n//   ]\n\nexport function legendColorFinder(sym?: SymbologyJSON, fallbackColor?: Color): FallbackColor {\n    const defaultFg = fallbackColor ? fallbackColor[500] : '#44444400' // dark grey lines\n    const defaultBg = addColorAlpha(defaultFg, 0.5)\n    const defaultReturn = { fg: defaultFg, bg: defaultBg }\n\n    if (!sym) return defaultReturn\n\n    // For now just return the first color we find\n    try {\n        // Start with line work\n        const lineNode = sym.find((s) => s.type === 'line')\n        const line = lineNode && (lineNode['line-color'] as string)\n\n        const fillNode = sym.find((s) => s.type === 'fill')\n        const fill = fillNode && (fillNode['fill-color'] as string)\n\n        const circleNode = sym.find((s) => s.type === 'circle')\n        const circleFill = circleNode && (circleNode['circle-color'] as string)\n\n        // Foreground prioritizes lines over fills\n        const fg = line || fill || circleFill || defaultFg\n        const bg = addColorAlpha(line || fill || circleFill || defaultFg, 0.5)\n        return { fg, bg }\n    } catch {\n        return defaultReturn\n    }\n}\n\n/**\n * Just a function to grow a bounding rectangle around\n * @param oldBounds [minx, miny, maxx, maxy]\n * @param newRect\n * @returns\n */\nexport function newBounds(\n    oldBounds: [number, number, number, number] | null,\n    newRect?: [number, number, number, number]\n): [number, number, number, number] {\n    const fallback = appDefaults.worldBounds as [number, number, number, number]\n    if (!newRect && !oldBounds) return fallback\n    else if (newRect && !oldBounds) return newRect\n    else if (oldBounds && !newRect) return oldBounds\n    else if (oldBounds && newRect) {\n        return [\n            // Note the extra wrapper function. We do this to keep really wonky values out\n            Math.max(appDefaults.worldBounds[0], Math.min(newRect[0], oldBounds[0])),\n            Math.max(appDefaults.worldBounds[1], Math.min(newRect[1], oldBounds[1])),\n            Math.min(appDefaults.worldBounds[2], Math.max(newRect[2], oldBounds[2])),\n            Math.min(appDefaults.worldBounds[3], Math.max(newRect[3], oldBounds[3]))\n        ]\n    }\n    return fallback\n}\n\nexport function newZoomBounds(\n    oldZBounds: [number, number],\n    newZbounds?: [number | undefined, number | undefined]\n): [number, number] {\n    const fallback = appDefaults.zoomRange as [number, number]\n    if (!oldZBounds && !newZbounds) return fallback\n    else if (!newZbounds) return oldZBounds\n\n    // The min zoom is always set at the APP level\n    const min = oldZBounds ? oldZBounds[0] : appDefaults.zoomRange[0]\n    const max = Math.min(appDefaults.zoomRange[1], Math.max(oldZBounds[1], newZbounds[1] || oldZBounds[1]))\n\n    return [min, max]\n}\n\nexport type TreeNodeID = { branches: number[]; leaves: number[] }\n\n/**\n * MAterial UI uses strings as treenodes. This is a bit awkward for us trying to differentiate branches and leaves\n * @param ids\n */\nexport function treeNodeIDsParse(rawIds: string[]): TreeNodeID {\n    return {\n        branches: rawIds.filter((ids) => ids.indexOf('b-') > -1).map((ids) => parseInt(ids.replace('b-', ''), 10)),\n        leaves: rawIds.filter((ids) => ids.indexOf('l-') > -1).map((ids) => parseInt(ids.replace('l-', ''), 10))\n    }\n}\n\n/**\n * This is the return trip function for taking our TreeNodeID and squooshing it back to an array of strings\n * @param betterIds\n * @returns\n */\nexport function treeNodeIDCreate(betterIds: TreeNodeID): string[] {\n    return [...betterIds.branches.map((bid) => `b-${bid}`), ...betterIds.leaves.map((lid) => `l-${lid}`)]\n}\n\n/**\n * Create an ancestry array with search text we can use to filter the tree\n * it is ordered deepest (current) --> shallowest (root)\n * @param project\n * @param bid\n * @returns\n */\nexport function projectLeafSearchAncestry(project: Project, leaf: ProjectTreeLeaf): [number, string][] {\n    let parent = leaf.pid\n    // Let's just track what we've already found so we don't get circles\n    const ancestry: number[] = []\n    const searchStrings: string[] = []\n\n    // The touchedIds is basically just to insulate against\n    // Everything in  a tree can only have one parent so work down\n    while (parent > -1 && ancestry.length < project.tree.branches.length) {\n        const foundBranch = project.tree.branches.find((br) => br.bid === parent)\n        // If we've found a valid parent then add its label to the search terms\n        if (foundBranch && ancestry.indexOf(foundBranch.bid) < 0) {\n            ancestry.push(foundBranch.bid)\n            searchStrings.push(foundBranch.label.toLowerCase().trim())\n            parent = foundBranch.pid\n        }\n        // Insulate ourselves from endless searching\n        else {\n            parent = -1\n        }\n    }\n    // We put it back int\n    return ancestry.map((bid, idx) => [bid, searchStrings[idx]])\n}\n\nconst SORT_ORDER = [\n    ProjectTreeLayerTypes.POINT,\n    ProjectTreeLayerTypes.LINE,\n    ProjectTreeLayerTypes.POLYGON,\n    ProjectTreeLayerTypes.TIN,\n    ProjectTreeLayerTypes.RASTER\n]\n\nexport function layerSort(leaves: ProjectTreeLeaf[]): ProjectTreeLeaf[] {\n    const newArr = [...leaves]\n    newArr.sort((lyrA, lyrB) => {\n        // First we sort by the layer type\n        if (lyrA.layerType !== lyrB.layerType)\n            return SORT_ORDER.indexOf(lyrA.layerType) - SORT_ORDER.indexOf(lyrB.layerType)\n        // Then we sort by the treePath id order. The way the BusinessLogic file is parsed should be the\n        // same as tree order (TODO: Verify this?!?)\n        else {\n            return lyrA.id - lyrB.id\n        }\n    })\n    return newArr\n}\n","import { atom, selector } from 'recoil'\nimport { appDefaults } from '../config'\nimport { Project, ProjectTreeLeaf, ProjectTreeLayerTileTypes } from '@riverscapes/common'\nimport { UseHostedReturn } from '@northarrowresearch/react-auth'\nimport { layerSort } from '../lib/util'\n// import log from 'loglevel'\n\n/**\n * This is the SOURCE OF TRUTH for the project tree. In some ways it's the MOST IMPORTANT ATOM\n */\nexport const projectAtom = atom<Project | null>({\n    key: 'project',\n    default: null\n})\n\nexport const authAtom = atom<UseHostedReturn | null>({\n    key: 'auth',\n    default: null\n})\n\n/**\n * Whether the tree pane is open or closed.\n * TODO: this might be way better using useState. Not sure any other components need this\n */\nexport const drawerOpenAtom = atom<boolean>({\n    key: 'drawerOpen',\n    default: appDefaults.drawerOpen\n})\n\n/**\n * When setting active layers or when order isn't important use this one\n */\nexport const activeIdsAtom = atom<number[]>({\n    key: 'map/activeLayerIds',\n    default: []\n})\n\n/**\n * Which layer ids are currently on the map and highlighted in the tree\n */\n\nexport const activeTreeLeavesSelector = selector<ProjectTreeLeaf[]>({\n    key: 'activeTreeLeaves',\n    get: ({ get }) => {\n        const proj = get(projectAtom)\n        const activeIds = get(activeIdsAtom)\n        return proj?.tree.leaves.filter((leaf) => activeIds.indexOf(leaf.id) > -1) || []\n    }\n})\n\n/**\n * Get the active map layer ids in the correct order. Use this in the map or legend, anywhere order\n * is important\n */\nexport const activeLeavesSortedSelector = selector<ProjectTreeLeaf[]>({\n    key: 'map/activeLeavesSorted',\n    get: ({ get }) => {\n        const activeTreeLeaves = get(activeTreeLeavesSelector)\n        const sorted = layerSort(activeTreeLeaves)\n        return sorted\n    }\n})\n\n/**\n * Utility selector for getting just the leaves we can add to a map\n */\nexport const projectMapLayerLeafsSelector = selector<ProjectTreeLeaf[]>({\n    key: 'project/mapLayerLeaves',\n    get: ({ get }) => {\n        const proj = get(projectAtom)\n        if (!proj) return []\n        return proj.tree.leaves.filter(\n            ({ layerType, layerPath, nodeExists }) =>\n                ProjectTreeLayerTileTypes.indexOf(layerType) > -1 && nodeExists && layerPath && layerPath.length > 0\n        )\n    }\n})\n\n/**\n * Get all the unique layer paths in a project\n * Use to initilize project-level downloader\n */\nexport const projectLayerPathsSelector = selector<string[]>({\n    key: 'project/layerPaths',\n    get: ({ get }) => {\n        const mapLyrs = get(projectMapLayerLeafsSelector)\n        return mapLyrs.reduce<string[]>(\n            (acc, leaf) => (!leaf.layerPath || acc.indexOf(leaf.layerPath) > -1 ? acc : [...acc, leaf.layerPath]),\n            []\n        )\n    }\n})\n","import { atom, selector, selectorFamily } from 'recoil'\nimport { appDefaults } from '../config'\nimport { ProjectTreeLeaf, TilingStatus, ProjectTreeBranch, ProjectTreeLayerTypes } from '@riverscapes/common'\nimport { treeNodeIDsParse, TreeNodeID, projectLeafSearchAncestry } from '../lib/util'\n// import log from 'loglevel'\n\nimport { projectAtom, activeIdsAtom } from './project'\nimport { layerStateSelectorFamily } from './layers'\n\nexport const treeFilterTextAtom = atom<string>({\n    key: 'treeFilterText',\n    default: ''\n})\n\nexport const projectLeafHierarchySelector = selector<Record<number, [number, string][]>>({\n    key: 'projectLeafHierarchy',\n    get: ({ get }) => {\n        const proj = get(projectAtom)\n        if (!proj) return {}\n        const leafHier = proj.tree.leaves.reduce<Record<number, [number, string][]>>((acc, leaf) => {\n            return {\n                ...acc,\n                [leaf.id]: projectLeafSearchAncestry(proj, leaf)\n            }\n        }, {})\n        return leafHier\n    }\n})\n\nexport const treeInfoPaneIdAtom = atom<number | null>({\n    key: 'tree/treeInfoPaneId',\n    default: null\n})\nexport const treeInfoPaneOpenAtom = atom<boolean>({\n    key: 'tree/treeInfoPaneOpen',\n    default: false\n})\n\n/**\n * Keep track of all the ProjectTreeLeaf objects in the system\n */\nexport const treeLeafSelectorFamily = selectorFamily<ProjectTreeLeaf, number>({\n    key: 'treeLeafSelectorFamily',\n    get:\n        (ptid) =>\n        ({ get }) => {\n            const proj = get(projectAtom)\n            if (!proj) throw new Error('treeLeafSelectorFamily: No project found')\n\n            const leaf = proj.tree.leaves.find(({ id }) => id === ptid)\n            if (!leaf) throw new Error('treeLeafSelectorFamily: No leaf found')\n\n            return leaf\n        }\n})\n\n/**\n * Keep track of the selected tree item.\n * MAterial tree control uses strings for ids so we use the convention 'b-##' and 'l-##' to separate leaves and branches\n */\nexport const treeSelectedIdsAtom = atom<string[]>({\n    key: 'tree/selectedIds',\n    default: []\n})\n\n// This is a convenience selector because the above ids are hard to parse\nexport const treeSelectedSelector = selector<TreeNodeID>({\n    key: 'tree/selectedIdsSelect',\n    get: ({ get }) => {\n        const selectedIds = get(treeSelectedIdsAtom)\n        return treeNodeIDsParse(selectedIds)\n    }\n})\n\n/**\n * Precalc the hidden nodes every time the search text changes\n */\nexport type HiddenNodes = { branches: number[]; leaves: number[] }\nexport const projectHiddenNodesSelector = selector<HiddenNodes>({\n    key: 'projectHiddenNodes',\n    get: ({ get }) => {\n        const proj = get(projectAtom)\n        const retVal: HiddenNodes = { branches: [], leaves: [] }\n        if (!proj) return retVal\n        const hierarchy = get(projectLeafHierarchySelector)\n        const filterText = get(treeFilterTextAtom).toLowerCase().trim()\n\n        // Return nothing if the search text is less than (n) characters\n        if (filterText.length < appDefaults.minFilterTextLength) return retVal\n\n        // Split words by spaces and filter out anything empties\n        const filterTextArr = filterText.split(' ').filter((w) => w.length > 0)\n\n        // Return nothing if there aren't any words\n        if (filterTextArr.length < 1) return retVal\n\n        // First we figure out which leaves are left\n        const allowedLeaves = proj.tree.leaves\n            .filter((leaf) => {\n                const leafHierarchy = hierarchy[leaf.id]\n                // Figure out if all our search words are present somewhere in the leaf's ancestry\n                return filterTextArr.every((word) => {\n                    // Easy case: the leaf contains the word\n                    if (leaf.label.toLowerCase().indexOf(word) > -1) return true\n                    // Harder case: the branch contains the work\n                    return leafHierarchy.find(([, bText]) => bText.indexOf(word) > -1)\n                })\n            })\n            .map(({ id }) => id)\n\n        // Now we figure out which branches have children that re allowed\n        const allowedBranches = Array.from(\n            new Set(allowedLeaves.reduce<number[]>((acc, lid) => [...acc, ...hierarchy[lid].map(([bid]) => bid)], []))\n        )\n        // Then we remove everything else\n        retVal.leaves = proj.tree.leaves.map(({ id }) => id).filter((lid) => allowedLeaves.indexOf(lid) < 0)\n        retVal.branches = proj.tree.branches.map(({ bid }) => bid).filter((bid) => allowedBranches.indexOf(bid) < 0)\n        return retVal\n    }\n})\n\nexport type TreeLeafState = {\n    leaf: ProjectTreeLeaf\n    reportUrl?: string\n    tilesState: TilingStatus\n    treeAllowed: boolean\n    renderable: boolean\n    hidden: boolean\n    active: boolean\n}\n\nexport const treeLeafStateSelector = selectorFamily<TreeLeafState, number>({\n    key: 'treeLeafStateFamily',\n    get:\n        (ptid) =>\n        ({ get }) => {\n            const layer = get(layerStateSelectorFamily(ptid))\n            const hidden = get(projectHiddenNodesSelector).leaves.indexOf(ptid) > -1\n            const active = get(activeIdsAtom).indexOf(ptid) > -1\n            const reportUrl =\n                layer.leaf.layerType === ProjectTreeLayerTypes.REPORT &&\n                layer.tileStatus === TilingStatus.SUCCESS &&\n                layer.tiles?.url + 'index.html'\n            return {\n                leaf: layer.leaf,\n                tilesState: layer.tileStatus,\n                treeAllowed: true,\n                reportUrl: reportUrl || undefined,\n                renderable: layer.renderable,\n                hidden,\n                active\n            }\n        }\n})\n\nexport const treeRootBranchId = selector<number | null>({\n    key: 'tree/rootBranchId',\n    get: ({ get }) => {\n        const proj = get(projectAtom)\n        const branch = proj?.tree.branches.find((br) => br.pid === -1) as ProjectTreeBranch\n        if (!branch) return null\n        return branch.bid\n    }\n})\n\n/**\n * This is going to let us build a tree in a lazy-loading way\n */\n/**\n * This is just the raw, static treebranch\n */\nexport type TreeBranchSelectorReturn = {\n    branch: ProjectTreeBranch\n    children: {\n        // We store these as ids to keep the memory footprint small\n        branches: number[]\n        leaves: number[]\n    }\n}\n\nexport const treeBranchSelectorFamily = selectorFamily<TreeBranchSelectorReturn, number>({\n    key: 'tree/branches',\n    get:\n        (bid) =>\n        ({ get }) => {\n            const proj = get(projectAtom)\n            const branch = proj?.tree.branches.find((br) => br.bid === bid) as ProjectTreeBranch\n\n            if (!proj) throw new Error('treeBranchSelectorFamily: No project found')\n            if (!branch) throw new Error('treeBranchSelectorFamily: No branch found')\n\n            return {\n                branch,\n                children: {\n                    branches: proj.tree.branches.filter((br) => br.pid === bid).map((br) => br.bid),\n                    leaves: proj.tree.leaves.filter((lf) => lf.pid === bid).map(({ id }) => id)\n                }\n            }\n        }\n})\n\n/**\n * Branch state is things like collapsed and selected. We keep that separete so we don't need to worry about re-recursing the tree\n */\nexport type TreeBranchStateReturn = {\n    branch: TreeBranchSelectorReturn\n    hidden: boolean\n    selected: boolean\n    collapsed: boolean\n}\nexport const treeBranchStateSelectorFamily = selectorFamily<TreeBranchStateReturn, number>({\n    key: 'tree/branchState',\n    get:\n        (bid) =>\n        ({ get }) => {\n            const selectedIds = get(treeSelectedSelector)\n            const branch = get(treeBranchSelectorFamily(bid))\n            const hiddenNodes = get(projectHiddenNodesSelector)\n\n            const collapsed = Boolean(get(treeExpandedSelector).indexOf(bid) > -1)\n\n            const selected = Boolean(selectedIds.branches.indexOf(bid) > -1)\n\n            // Testing to see if this tree node should be hidden\n            const hidden = hiddenNodes.branches.indexOf(bid) > -1\n\n            return {\n                branch,\n                hidden,\n                selected,\n                collapsed\n            }\n        }\n})\n\n/****************************************\n * Misc Tree State\n ****************************************/\n\nexport type TreeCtxState = { leafId: number; position: { top: number; left: number } }\n\nexport const treeContextMenuAtom = atom<TreeCtxState | null>({\n    key: 'tree/contextMenu',\n    default: null\n})\n\n/**\n * Keep track of which branches are expanded\n * NOTE: We use 'collapsed' in the xml so this is inverted and a little messy\n * TODO: Not sure this needs to be externalized. Might be a good case for useState\n */\nexport const treeExpandedIdsAtom = atom<string[]>({\n    key: 'tree/expandedIds',\n    default: []\n})\n// This is a convenience selector because the above ids are hard to parse\nexport const treeExpandedSelector = selector<number[]>({\n    key: 'tree/expandedIdsSelect',\n    get: ({ get }) => {\n        return get(treeExpandedIdsAtom)\n            .filter((ids) => ids.indexOf('b-') > -1)\n            .map((ids) => parseInt(ids.replace('b-', ''), 10))\n    }\n})\n// Just get all ids in the project\nexport const treeAllIdsSelector = selector<string[]>({\n    key: 'tree/treeAllIds',\n    get: ({ get }) => {\n        const proj = get(projectAtom)\n        if (!proj) return []\n        return [...proj.tree.branches.map(({ bid }) => `b-${bid}`), ...proj.tree.leaves.map(({ id }) => `l-${id}`)]\n    }\n})\n","import Bottleneck from 'bottleneck'\n\nconst QUEUE = new Bottleneck({\n    maxConcurrent: 5\n})\n\nexport default QUEUE\n","import { atom, atomFamily, selectorFamily } from 'recoil'\nimport { endpoints } from '../config'\n// import { orange } from '@material-ui/core/colors'\nimport { TileService, TilingStatus, getLayerTiles } from '@riverscapes/common'\nimport downloadQueue from '../lib/downloadQueue'\n// import log from 'loglevel'\n\nimport { authAtom, projectAtom } from './project'\n\n/****************************************\n * Tile Service Library\n ****************************************/\n// This is using the requestId pattern found here: https://recoiljs.org/docs/guides/asynchronous-data-queries/\n// This atom does nothign but track the requests made\nexport const tilesRequestIdAtomFamily = atomFamily<number, string>({\n    key: 'tiles/tileReq',\n    default: 0\n})\n// Request and retry are subtly different. Requests can be used as a generic way to refresh data (valid or not)\n// Retries get incremented only when there's an error\nexport const tilesRetriesAtomFamily = atomFamily<number, string>({\n    key: 'tiles/tileRetries',\n    default: 0\n})\n\nexport const usableIdsAtom = atom<number[]>({\n    key: 'tiles/usableIds',\n    default: []\n})\n\nexport const tilesSelectorFamily = selectorFamily<TileService, string>({\n    key: 'tiles/tiles',\n    get:\n        (layerPath) =>\n        async ({ get }) => {\n            // By just including this here (even if we don't assign it) we add tilesRequestIdAtomFamily\n            // as a rippling dependency so updating tilesRequestIdAtomFamily will cause this query to refresh\n            get(tilesRequestIdAtomFamily(layerPath))\n            // Retries are for errors\n            get(tilesRetriesAtomFamily(layerPath))\n\n            const auth = get(authAtom)\n            const proj = get(projectAtom)\n\n            // TODO: Set Priority here\n            // ATOM LOOKUP PRIORITY\n            let retVal: TileService = {\n                status: TilingStatus.UNKNOWN\n            }\n            if (!proj || !auth || !layerPath) return retVal\n\n            // Make the Asynchronous call to the API here\n            // A priority between 0 and 9. A job with a priority of 4 will be queued ahead of a job with a priority of 5\n            // Default is 5\n            try {\n                const apiRes = await downloadQueue.schedule({ priority: 5 }, () =>\n                    auth\n                        .getCurrentToken()\n                        .then((jwt) =>\n                            getLayerTiles(endpoints.graphql, jwt, proj.projType, proj?.program, proj?.id, layerPath)\n                        )\n                )\n                if (!apiRes || apiRes.errors || !apiRes.data) {\n                    // Tiling errors don't get retried. We reached the server correctly so\n                    // Any further request will likely be met with a similar result\n                    retVal.status = TilingStatus.FETCH_ERROR\n                    if (apiRes.errors && apiRes.errors.length > 0) {\n                        retVal.error = apiRes.errors.map((e) => JSON.stringify(e)).join(', \\n')\n                    }\n                }\n                retVal = {\n                    ...retVal,\n                    ...apiRes.data?.getLayerTiles\n                }\n            } catch (err) {\n                retVal.status = TilingStatus.FETCH_ERROR\n                retVal.error = err.toString()\n            }\n            return retVal\n        }\n})\n","import { selector, selectorFamily } from 'recoil'\nimport { endpoints } from '../config'\n// import { orange } from '@material-ui/core/colors'\nimport {\n    Symbology,\n    SymbologyStatus,\n    getWebSymbology,\n    ProjectTreeLayerTypes,\n    ProjectTreeLeaf\n} from '@riverscapes/common'\nimport downloadQueue from '../lib/downloadQueue'\nimport { authAtom, projectAtom, activeTreeLeavesSelector, projectMapLayerLeafsSelector } from './project'\nimport log from 'loglevel'\nimport { isEqual } from 'lodash'\n\n/****************************************\n * Tile Vector Symbology Library\n ****************************************/\n/**\n * Selector for all the unique symbologies currently on the map\n */\nexport type SymbologyKey = [string, boolean]\n\nconst createSymbologyKeys = (leaves: ProjectTreeLeaf[]): SymbologyKey[] => {\n    return leaves.reduce<SymbologyKey[]>((acc, leaf) => {\n        if (!leaf.symbology) return acc\n        const symbKey: SymbologyKey = [leaf.symbology, leaf.layerType === ProjectTreeLayerTypes.RASTER]\n        if (!acc.find((sk) => isEqual(sk, symbKey))) return [...acc, symbKey]\n        else return acc\n    }, [])\n}\n\n/**\n * Selector for all the unique symbologies in the whole project\n * Use to initilize project-level downloader\n */\nexport const projectSymbologiesSelector = selector<SymbologyKey[]>({\n    key: 'symbology/uniqueSymb',\n    get: ({ get }) => {\n        const mapLyrs = get(projectMapLayerLeafsSelector)\n        return createSymbologyKeys(mapLyrs)\n    }\n})\n\n// A unique symbology key consists of a string name and whether or not it is a raster\nexport const activeMapSymbologiesSelector = selector<SymbologyKey[]>({\n    key: 'symbology/activeSymbologies',\n    get: ({ get }) => {\n        const activeSymb = get(activeTreeLeavesSelector)\n        return createSymbologyKeys(activeSymb)\n    }\n})\n\nexport const symbologySelectorFamily = selectorFamily<Symbology | null, SymbologyKey>({\n    key: 'symbology/symbology',\n    get:\n        ([name, isRaster]) =>\n        async ({ get }) => {\n            const proj = get(projectAtom)\n            const auth = get(authAtom)\n            if (!proj || !auth || !name) return null\n            const retVal: Symbology = {\n                name,\n                status: SymbologyStatus.UNKNOWN\n            }\n            // Make the Asynchronous call to the API here\n            // A priority between 0 and 9. A job with a priority of 4 will be queued ahead of a job with a priority of 5\n            // Default is 5\n            const apiRes = await downloadQueue.schedule({ priority: 5 }, () =>\n                auth\n                    .getCurrentToken()\n                    .then((jwt) => getWebSymbology(endpoints.graphql, jwt, proj.projType, name, isRaster))\n                    .catch((err) => {\n                        log.debug('symbologySelectorFamily', err)\n                    })\n            )\n\n            if (!apiRes || apiRes.errors) {\n                retVal.status = SymbologyStatus.ERROR\n                retVal.error = 'Error downloading symbology'\n                return retVal\n            }\n            return apiRes.data?.getWebSymbology || retVal\n        }\n})\n","import { atom, atomFamily, selector, selectorFamily, noWait } from 'recoil'\nimport {\n    ProjectTreeLeaf,\n    TileService,\n    Symbology,\n    SymbologyStatus,\n    TilingStatus,\n    ProjectTreeLayerTypes\n} from '@riverscapes/common'\n// import log from 'loglevel'\nimport { projectAtom, activeIdsAtom } from './project'\nimport { treeLeafSelectorFamily, treeSelectedSelector } from './tree'\nimport { tilesSelectorFamily } from './tiles'\nimport { symbologySelectorFamily } from './symbology'\nimport { legendColors } from '../config'\n\nexport const assignedRandomColorsAtom = atom<number[]>({\n    key: 'map/assignedColors',\n    default: []\n})\nexport const leafRandomColAtomFamily = atomFamily<number | null, number>({\n    key: 'map/leafRandomCol',\n    default: null\n})\nexport const selectNextColor = selector<number>({\n    key: 'map/selectNextColor',\n    get: ({ get }) => {\n        const current = get(assignedRandomColorsAtom)\n        // Little sloppy here but after all the colours are used up we just get the same color over and over\n        // This shouldn't be an issue because we can't have more than 5 map layers active at a time usually.\n        for (let idx = 0; idx < legendColors.length; idx++) {\n            if (current.indexOf(idx) < 0) return idx\n        }\n        return 0\n    }\n})\n\n/**\n * Layers are derivative state objects with things that are commonly grouped together\n * THis is used PRETTY MUCH EVERYWHERE\n */\n\nexport type MapLayerState = {\n    leaf: ProjectTreeLeaf\n    tiles?: TileService\n    // Symbology can be null for rasters\n    symbology?: Symbology | null\n    treeSelected: boolean\n    legendActive: boolean\n    renderable: boolean\n    symbologyStatus: SymbologyStatus\n    tileStatus: TilingStatus\n}\nexport const layerStateSelectorFamily = selectorFamily<MapLayerState, number>({\n    key: 'map/layers',\n    get:\n        (leafid) =>\n        ({ get }): MapLayerState => {\n            const leaf = get(treeLeafSelectorFamily(leafid)) as ProjectTreeLeaf\n            const selectedIds = get(treeSelectedSelector)\n            const tileServLoadable = get(noWait(tilesSelectorFamily(leaf.layerPath as string)))\n            const symbologyLoadable = get(\n                noWait(\n                    symbologySelectorFamily([leaf.symbology as string, leaf.layerType === ProjectTreeLayerTypes.RASTER])\n                )\n            )\n\n            // It can be active on the legend without being renderable\n            const legendActive = get(activeIdsAtom).indexOf(leafid) > -1\n\n            const treeSelected = Boolean(selectedIds.leaves && selectedIds.leaves.indexOf(leafid) > -1)\n\n            const tileStatus =\n                tileServLoadable.state !== 'hasValue' ? TilingStatus.FETCHING : tileServLoadable.contents.status\n            // Files are a direct download so they just get an automatic pass because there's nothing to tile\n            // NOTE: THis is not true for TilingStatus.REPORT that still needs to be copied\n            if (leaf.layerType === ProjectTreeLayerTypes.FILE) tileStatus === TilingStatus.SUCCESS\n\n            const symbologyStatus =\n                symbologyLoadable.state !== 'hasValue'\n                    ? SymbologyStatus.FETCHING\n                    : symbologyLoadable.contents?.status || SymbologyStatus.NOT_APPLICABLE\n            const renderable = tileStatus === TilingStatus.SUCCESS && symbologyStatus !== SymbologyStatus.FETCHING\n\n            const retVal: MapLayerState = {\n                leaf,\n                treeSelected,\n                legendActive,\n                renderable,\n                tileStatus,\n                symbologyStatus\n            }\n            if (tileServLoadable.state === 'hasValue') retVal.tiles = tileServLoadable.contents\n            if (symbologyLoadable.state === 'hasValue') retVal.symbology = symbologyLoadable.contents\n\n            return retVal\n        }\n})\n\n/**\n * Pull out the map leaf ids for a given view\n */\nexport const viewProjLeafIdsSelector = selector<Record<string, number[]>>({\n    key: 'map/viewProjLeafIds',\n    get: ({ get }): Record<string, number[]> => {\n        const proj = get(projectAtom)\n        if (!proj || !proj.tree.views) return {}\n        const retVal = proj.tree.views.reduce<Record<string, number[]>>((acc, view) => {\n            const viewIds = view.layers.reduce<number[]>((acc, vl) => {\n                const ptl = proj.tree.leaves.find(({ blLayerId }) => blLayerId && blLayerId === vl.id)\n                if (!ptl) return acc\n                else return [...acc, ptl.id]\n            }, [])\n            return {\n                ...acc,\n                [view.id]: viewIds\n            }\n        }, {})\n\n        return retVal\n    }\n})\n","import { TilingStatus } from '@riverscapes/common'\nimport { atom, selector } from 'recoil'\nimport { appDefaults } from '../config'\nimport { BaseLayer } from '../types'\nimport { layerStateSelectorFamily, leafRandomColAtomFamily, MapLayerState } from './layers'\nimport { activeLeavesSortedSelector } from './project'\n// import log from 'loglevel'\n\n/****************************************\n * Misc Map State\n ****************************************/\n\nexport const baseLayerAtom = atom<BaseLayer>({\n    key: 'map/baseLayer',\n    default: appDefaults.baseLayer\n})\n\n/**\n * What state the viewport is currently in. I'd like this to be ZOOM and LAT/LNG so we can code it into the url\n */\nexport const viewportAtom = atom({\n    key: 'map/viewport',\n    default: null\n})\n\nexport const mapErrorAtom = atom<string>({\n    key: 'map/mapError',\n    default: ''\n})\n\nexport const mapLoadingAtom = atom<boolean>({\n    key: 'map/mapLoading',\n    default: false\n})\n\nexport interface RenderableMapLayer extends MapLayerState {\n    randomColor: number | null\n    lid: number\n    idStr: string\n    beforeId?: string\n}\n\n/**\n * This selector aims to find the difference between what's requested on the map and return only\n * what's actually renderable. This is important because if 'beforeId' references a dud layer\n * there can be problems so it's important that Mapbox only try to render layers we can actually show\n */\nexport const renderableMapLayersSelector = selector<RenderableMapLayer[]>({\n    key: 'map/renderableMapLayers',\n    get: ({ get }) => {\n        const activeLeavesSorted = get(activeLeavesSortedSelector)\n        const usableLayers = activeLeavesSorted\n            .map(({ id }) => get(layerStateSelectorFamily(id)))\n            .filter(({ tileStatus }) => tileStatus === TilingStatus.SUCCESS)\n        const rndCols = usableLayers.map(({ leaf: { id } }) => get(leafRandomColAtomFamily(id)))\n\n        const retVal = usableLayers.reduce<RenderableMapLayer[]>((acc, lyr, idx) => {\n            const id = lyr.leaf.id\n            const retVal: RenderableMapLayer = {\n                ...lyr,\n                randomColor: rndCols[idx],\n                lid: id,\n                idStr: `mapLayer-${id}`\n            }\n            // Anything lower in the stack gets a beforeId tag\n            if (acc.length > 0) retVal.beforeId = acc[acc.length - 1].idStr\n            return [...acc, retVal]\n        }, [])\n        return retVal\n    }\n})\n\n/**\n * Which view is currently active.\\\n */\nexport const activeViewAtom = atom<string | null>({\n    key: 'map/view',\n    default: null\n})\n\n/**\n * The bound fence of the map\n * [minx, miny, maxx, maxy]\n */\nexport const boundsAtom = atom<[number, number, number, number] | null>({\n    key: 'map/bounds',\n    default: null\n})\n\n/**\n * The zoom bound limits [minz, maxz]\n */\nexport const zoomBoundsAtom = atom<[number, number]>({\n    key: 'map/zoomBounds',\n    default: [appDefaults.zoomRange[0], appDefaults.zoomRange[1]]\n})\n/**\n * THis selector is what the map will use to read the bounds. It has two functions\n * 1. It will always return something valid (even though bounds can be null)\n * 2. it groups bounds and zoombounds together since we use them that way a lot\n */\nexport const boundsSelector = selector<{ zoom: [number, number]; bounds: [number, number, number, number] }>({\n    key: 'bounds',\n    get: ({ get }) => {\n        return {\n            zoom: get(zoomBoundsAtom),\n            bounds: get(boundsAtom) || [-180, -90, 180, 90]\n        }\n    }\n})\n","import { googleAnalytics } from '@riverscapes/react-common'\nimport { useRecoilState, useRecoilValue, useSetRecoilState } from 'recoil'\nimport { viewProjLeafIdsSelector, activeViewAtom, activeIdsAtom, projectAtom } from '../recoil'\n\nexport interface UseViewsReturn {\n    setView: (viewId: string) => void\n    resetView: () => void\n}\n\nconst useViews = (): UseViewsReturn => {\n    const [currView, setCurrView] = useRecoilState(activeViewAtom)\n    const viewLeafIds = useRecoilValue(viewProjLeafIdsSelector)\n    const proj = useRecoilValue(projectAtom)\n    const setActiveMapIds = useSetRecoilState(activeIdsAtom)\n\n    const setView = (viewId: string) => {\n        if (viewId === null || currView === viewId || !viewLeafIds[viewId]) return\n        googleAnalytics.event('webrave', 'set_view')\n        setCurrView(viewId)\n        setActiveMapIds(viewLeafIds[viewId])\n    }\n    const resetView = () => {\n        googleAnalytics.event('webrave', 'set_default_view')\n        if (proj && proj.tree.defaultView) setView(proj.tree.defaultView)\n    }\n\n    return { setView, resetView }\n}\n\nexport default useViews\n","import { useEffect } from 'react'\nimport { useRecoilCallback, useRecoilValue, useSetRecoilState, useRecoilState } from 'recoil'\nimport { UseHostedReturn } from '@northarrowresearch/react-auth'\nimport useViews from './useViews'\nimport {\n    authAtom,\n    projectAtom,\n    activeIdsAtom,\n    tilesSelectorFamily,\n    symbologySelectorFamily,\n    projectLayerPathsSelector,\n    projectSymbologiesSelector,\n    treeExpandedIdsAtom,\n    SymbologyKey\n} from '../recoil'\nimport { Project } from '@riverscapes/common'\n// import log from 'loglevel'\n\n/**\n * This custom hook does all the state setup we need to initialize the project once it is loaded\n */\nconst useAppStateInit = (initAuth?: UseHostedReturn, initProj?: Project): void => {\n    const [project, setProjectTree] = useRecoilState(projectAtom)\n    const setActiveIds = useSetRecoilState(activeIdsAtom)\n    const setAuth = useSetRecoilState(authAtom)\n    const projectSymbologies = useRecoilValue(projectSymbologiesSelector)\n    const projectLayerPaths = useRecoilValue(projectLayerPathsSelector)\n    const setExpanded = useSetRecoilState(treeExpandedIdsAtom)\n    const { resetView } = useViews()\n\n    // This just basically stuffs our project into Recoil\n    // TODO: This may not be needed later when the common library uses recoil too\n    useEffect(() => setProjectTree(initProj || null), [initProj])\n    useEffect(() => setAuth(initAuth || null), [initAuth])\n\n    const preFetchLayerTile = useRecoilCallback(({ snapshot }) => (layerPath: string) => {\n        snapshot.getLoadable(tilesSelectorFamily(layerPath)) // pre-fetch user info\n    })\n\n    const preFetchSymbology = useRecoilCallback(({ snapshot }) => (sKey: SymbologyKey) => {\n        snapshot.getLoadable(symbologySelectorFamily(sKey)) // pre-fetch symbology\n    })\n\n    // TODO:\n    // - load url params\n\n    // Here we set the default expanded nodes when the project loads\n    useEffect(() => {\n        if (!project) setExpanded([])\n        else {\n            setActiveIds([])\n            resetView() // reset to the default view\n            setExpanded(project.tree.branches.filter((br) => !br.collapsed).map((br) => `b-${br.bid}`))\n        }\n    }, [project])\n\n    // When the symbologies change, preload them\n    useEffect(() => {\n        projectSymbologies.map(preFetchSymbology)\n    }, [projectSymbologies])\n    // When the unique layer paths change preload them\n    useEffect(() => {\n        projectLayerPaths.map(preFetchLayerTile)\n    }, [projectLayerPaths])\n}\n\nexport default useAppStateInit\n","import React from 'react'\nimport Typography from '@material-ui/core/Typography'\nimport Paper from '@material-ui/core/Paper'\nimport Container from '@material-ui/core/Container'\nimport Link from '@material-ui/core/Link'\nimport { warehouseUrl } from '../config'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { WarehouseButton } from '@riverscapes/react-common'\n\nconst useStyles = makeStyles((theme) => ({\n    rootContainer: {\n        // maxWidth: '50em',\n        // margin: '0 auto',\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'column'\n    },\n    spacer: {\n        flexGrow: 1\n    },\n    root: {\n        padding: theme.spacing(2, 4, 4, 4)\n    },\n    buttonContainer: {\n        textAlign: 'center'\n    },\n    logoContainer: {\n        padding: theme.spacing(2),\n        textAlign: 'center'\n    },\n    logo: {}\n}))\n\n// interface Props {\n//     title: string\n// }\n\nconst ProjectNotFound: React.FC = () => {\n    const classes = useStyles()\n\n    return (\n        <Container className={classes.rootContainer} maxWidth=\"sm\">\n            <div className={classes.spacer} />\n            <Paper className={classes.root}>\n                <div className={classes.logoContainer}>\n                    <img className={classes.logo} src={process.env.PUBLIC_URL + '/RiverscapesLogo.png'} alt=\"logo\" />\n                </div>\n                <Typography paragraph variant=\"body1\">\n                    The project you are looking for could not be found.\n                </Typography>\n                <Typography paragraph variant=\"body1\">\n                    Please go back to the <Link href={`${warehouseUrl}/#/`}>Riverscapes Data Warehouse</Link> and choose\n                    a new project\n                </Typography>\n                <div className={classes.buttonContainer}>\n                    <WarehouseButton title={`Warehouse`} href={`${warehouseUrl}/#/`} stay />\n                </div>\n            </Paper>\n            <div className={classes.spacer} />\n        </Container>\n    )\n}\nexport default ProjectNotFound\n","import React from 'react'\nimport SplitPane, { Size } from 'react-split-pane'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(() => ({\n    root: {\n        height: '100%',\n        position: 'relative'\n        // marginLeft: theme.spacing(1)\n    },\n    splitPane: {},\n    resizer: {\n        background: '#000',\n        opacity: 0.2,\n        zIndex: 1,\n        boxSizing: 'border-box',\n        backgroundClip: 'padding-box',\n        '&:hover': {\n            transition: 'all 2s ease'\n        },\n        '&.horizontal': {\n            height: 11,\n            margin: '-5px 0',\n            borderTop: '5px solid rgba(255, 255, 255, 0)',\n            borderBottom: '5px solid rgba(255, 255, 255, 0)',\n            cursor: 'row-resize',\n            width: '100%',\n            '&:hover': {\n                borderTop: '5px solid rgba(0, 0, 0, 0.5)',\n                borderBottom: '5px solid rgba(0, 0, 0, 0.5)'\n            }\n        },\n        '&.vertical': {\n            width: 11,\n            margin: '0 -5px',\n            borderLeft: '5px solid rgba(255, 255, 255, 0)',\n            borderRight: '5px solid rgba(255, 255, 255, 0)',\n            cursor: 'col-resize',\n            height: '100%',\n            '&:hover': {\n                borderLeft: '5px solid rgba(0, 0, 0, 0.5)',\n                borderRight: '5px solid rgba(0, 0, 0, 0.5)'\n            }\n        },\n        '&.disabled': {\n            cursor: 'not-allowed',\n            '&:hover': {\n                borderColor: 'transparent'\n            }\n        }\n    }\n}))\n\nexport interface AppSplitterProps {\n    open: boolean\n    child1: React.ReactChild\n    child2: React.ReactChild\n    split?: 'horizontal' | 'vertical'\n    primary?: 'first' | 'second'\n    defaultSize?: Size\n    minSize?: Size\n    maxSize?: Size\n}\n\nconst AppSplitter: React.FC<AppSplitterProps> = ({\n    open,\n    child1,\n    child2,\n    split,\n    primary,\n    defaultSize,\n    minSize,\n    maxSize\n}: AppSplitterProps) => {\n    const classes = useStyles()\n    if (!open) return <div className={classes.root}>{!primary || primary === 'first' ? child1 : child2}</div>\n    else {\n        return (\n            <div className={classes.root}>\n                <SplitPane\n                    className={classes.splitPane}\n                    resizerClassName={classes.resizer}\n                    split={split}\n                    primary={primary}\n                    defaultSize={defaultSize}\n                    minSize={minSize}\n                    maxSize={maxSize}\n                    pane1Style={{ overflow: 'hidden' }}\n                    pane2Style={{ overflow: 'hidden' }}\n                >\n                    {child1}\n                    {child2}\n                </SplitPane>\n            </div>\n        )\n    }\n}\n\nexport default AppSplitter\n","import React, { useState } from 'react'\n\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'column',\n        overflow: 'hidden'\n    },\n    appBar: {\n        flex: '0 0'\n    },\n    tabs: {},\n    tabContents: {\n        position: 'relative',\n        overflow: 'hidden',\n        flexGrow: 1\n    },\n    closeButton: {\n        zIndex: 1000,\n        background: theme.palette.secondary.main,\n        color: theme.palette.secondary.contrastText,\n        position: 'absolute',\n        top: 0,\n        right: 0\n    }\n}))\n\ninterface TreeDrawerProps {\n    tabs: { label: string; value: React.ReactChild }[]\n}\n\nconst TreeDrawer: React.FC<TreeDrawerProps> = ({ tabs }: TreeDrawerProps) => {\n    const classes = useStyles()\n    const [activeTab, setValue] = useState<number>(0)\n\n    const handleChange = (event: React.ChangeEvent<Record<string, unknown>>, newValue: number) => {\n        setValue(newValue)\n    }\n    return (\n        <div className={classes.root}>\n            <Tabs\n                value={activeTab}\n                className={classes.tabs}\n                onChange={handleChange}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n                variant=\"fullWidth\"\n                aria-label=\"full width tabs example\"\n            >\n                {tabs.map((tab, idx) => (\n                    <Tab key={`tab-${idx}`} label={tab.label} value={idx} />\n                ))}\n            </Tabs>\n            {tabs.map(({ value }, tid) => (\n                <div\n                    key={`tab-${tid}`}\n                    className={classes.tabContents}\n                    style={{ display: tid === activeTab ? 'block' : 'none' }}\n                >\n                    {value}\n                </div>\n            ))}\n        </div>\n    )\n}\n\nexport default TreeDrawer\n","import { useRecoilState } from 'recoil'\nimport { activeIdsAtom, activeViewAtom, mapErrorAtom } from '../recoil'\nimport { appDefaults } from '../config'\nimport { googleAnalytics } from '@riverscapes/react-common'\n\ninterface UseMapLayersReturn {\n    removeLayer: (lid: number) => void\n    addLayer: (lid: number) => void\n    toggleLayer: (lid: number) => void\n}\n\n/**\n * This is everything you'd ever want to do to manipulate layers on the map\n * @returns\n */\nconst useMapLayers = (): UseMapLayersReturn => {\n    const [currView, setCurrView] = useRecoilState(activeViewAtom)\n    const [activeIds, setActiveIds] = useRecoilState(activeIdsAtom)\n    const [error, setError] = useRecoilState(mapErrorAtom)\n\n    const removeLayer = (lid: number): void => {\n        googleAnalytics.event('webrave', 'remove_layer')\n        if (error) setError('')\n        if (currView !== null) setCurrView(null)\n        setActiveIds(activeIds.filter((id) => id !== lid))\n    }\n    const addLayer = (lid: number): void => {\n        googleAnalytics.event('webrave', 'add_layer')\n        if (activeIds.length === appDefaults.maxMapLayers) {\n            googleAnalytics.event('error', 'too_many_layers')\n            setError(`Only ${appDefaults.maxMapLayers} layers are allowed at a time.`)\n            return\n        }\n\n        if (error) setError('')\n        if (currView !== null) setCurrView(null)\n        setActiveIds(Array.from(new Set([...activeIds, lid])))\n    }\n    const toggleLayer = (lid: number): void => {\n        if (activeIds.indexOf(lid) > -1) removeLayer(lid)\n        else addLayer(lid)\n    }\n\n    return { removeLayer, addLayer, toggleLayer }\n}\n\nexport default useMapLayers\n","import React from 'react'\nimport highlightWords from 'highlight-words'\nimport { makeStyles } from '@material-ui/core/styles'\n\ninterface TreeNodeLabelProps {\n    text: string\n    query?: string\n}\n\nconst useStyles = makeStyles(() => ({\n    normal: {\n        fontStyle: 'italic',\n        opacity: 0.8\n    },\n    highlighted: {\n        fontWeight: 'bold'\n    }\n}))\n\nexport const TreeNodeLabel: React.FC<TreeNodeLabelProps> = ({ text, query }: TreeNodeLabelProps) => {\n    const classes = useStyles()\n    if (!query || query.length === 0) return <span>{text}</span>\n    const sanitized = query\n        .split(' ')\n        .map((t) => t.trim())\n        .filter((t) => t && t.length > 0)\n        .join(' ')\n    const chunks = highlightWords({ text, query: sanitized })\n\n    return (\n        <span>\n            {chunks.map((c, idx) => (\n                <span key={`textMatch-${idx}`} className={c.match ? classes.highlighted : classes.normal}>\n                    {c.text}\n                </span>\n            ))}\n        </span>\n    )\n}\n\nexport default TreeNodeLabel\n","import React from 'react'\nimport { TilingStatus, ProjectTreeLayerTypes } from '@riverscapes/common'\n// import log from 'loglevel'\nimport TreeItem from '@material-ui/lab/TreeItem'\nimport { makeStyles } from '@material-ui/core/styles'\nimport Typography from '@material-ui/core/Typography'\nimport CircularProgress from '@material-ui/core/CircularProgress'\n\nimport TreeNodeLabel from './TreeNodeLabel'\n\nimport { LayerIcon } from '@riverscapes/react-icons'\nimport clsx from 'clsx'\n// import log from 'loglevel'\n\nexport interface TreeLeafProps {\n    id: number\n    layerType: ProjectTreeLayerTypes\n    label: string\n    tilesState: TilingStatus\n    active?: boolean\n    hidden?: boolean\n    searchText?: string\n    handleContext: (lid: number, mousex: number, mousey: number) => void\n    handleClick: (lid: number) => void\n    handleDoubleClick: (lid: number) => void\n}\n// const FADE_TIME = 500\n\nconst useLeafStyles = makeStyles((theme) => ({\n    leaf: {\n        cursor: 'context-menu',\n        marginLeft: theme.spacing(2)\n    },\n    active: {\n        fontWeight: 'bold'\n    },\n    treeLeafLabel: {\n        display: 'flex'\n    },\n    innerLabel: {\n        flexGrow: 0\n    },\n    spacer: {\n        flexGrow: 1\n    },\n    metaIcon: {\n        margin: theme.spacing(0.25),\n        opacity: 0.2,\n        fontSize: theme.spacing(2),\n        lineHeight: '1rem'\n    },\n    loadingSpinner: {\n        color: theme.palette.text.secondary\n    },\n    tileStatus: {\n        flexGrow: 0,\n        fontStyle: 'italic'\n    },\n    leafQUEUED: {\n        color: '#999999',\n        fontStyle: 'italic'\n    },\n    leafCREATING: {\n        color: 'orange'\n    },\n    leafTILING_ERROR: {\n        color: 'red',\n        fontStyle: 'italic'\n    },\n    leafFETCH_ERROR: {\n        color: 'red',\n        fontStyle: 'italic'\n    },\n    leafNOT_FOUND: {\n        color: 'red',\n        fontStyle: 'italic'\n    },\n    leafINDEX_NOT_FOUND: {\n        color: 'red',\n        fontStyle: 'italic'\n    },\n    leafLAYER_NOT_FOUND: {\n        color: 'red',\n        fontStyle: 'italic'\n    },\n    leafUNKNOWN: {\n        color: theme.palette.text.secondary,\n        fontStyle: 'italic'\n    },\n    leafFETCHING: {\n        color: theme.palette.text.secondary,\n        fontStyle: 'italic'\n    },\n    leafSUCCESS: {}\n}))\n\nexport const TreeLeaf: React.FC<TreeLeafProps> = ({\n    id,\n    layerType,\n    label,\n    active,\n    hidden,\n    searchText,\n    tilesState,\n    handleContext,\n    handleClick,\n    handleDoubleClick\n}: TreeLeafProps) => {\n    const classes = useLeafStyles()\n\n    const onCtxMenu = (event) => {\n        event.preventDefault()\n        handleContext(id, event.clientX - 2, event.clientY - 4)\n    }\n    let tileStatusStr: React.ReactElement | string | null = null\n    switch (tilesState) {\n        case TilingStatus.SUCCESS:\n            // tileStatusStr = 'Available'\n            break\n        case TilingStatus.QUEUED:\n            tileStatusStr = 'Queued...'\n            break\n        case TilingStatus.CREATING:\n            tileStatusStr = 'Building...'\n            break\n        case TilingStatus.TILING_ERROR:\n            tileStatusStr = 'Tile Error'\n            break\n        case TilingStatus.INDEX_NOT_FOUND:\n            tileStatusStr = 'Index Error'\n            break\n        case TilingStatus.LAYER_NOT_FOUND:\n            tileStatusStr = 'Layer Missing'\n            break\n        case TilingStatus.FETCH_ERROR:\n            tileStatusStr = 'Fetch Error'\n            break\n        case TilingStatus.UNKNOWN:\n            tileStatusStr = (\n                <CircularProgress className={classes.loadingSpinner} color=\"inherit\" thickness={3} size={15} />\n            )\n            break\n        case TilingStatus.FETCHING:\n            tileStatusStr = (\n                <CircularProgress className={classes.loadingSpinner} color=\"inherit\" thickness={3} size={15} />\n            )\n            break\n        default:\n            break\n    }\n\n    return (\n        <TreeItem\n            // this is IMPORTANT! 'l-##' denotes a branch\n            nodeId={`l-${id}`}\n            className={clsx(classes.leaf, tilesState && classes[`leaf${tilesState}`])}\n            // TODO: Temproarily hide layers\n            hidden={hidden}\n            onClick={() => handleClick(id)}\n            onDoubleClick={() => handleDoubleClick(id)}\n            label={\n                <div className={classes.treeLeafLabel}>\n                    <Typography\n                        variant=\"body2\"\n                        color=\"inherit\"\n                        className={clsx(classes.innerLabel, active && classes.active)}\n                    >\n                        <TreeNodeLabel text={label} query={searchText} />\n                    </Typography>\n                    <div className={classes.spacer} />\n                    {tileStatusStr && (\n                        <Typography\n                            variant=\"caption\"\n                            color=\"inherit\"\n                            className={clsx(classes.innerLabel, active && classes.active)}\n                        >\n                            {tileStatusStr}\n                        </Typography>\n                    )}\n                </div>\n            }\n            onContextMenu={onCtxMenu}\n            icon={<LayerIcon layerType={layerType} />}\n        />\n    )\n}\n\nexport default TreeLeaf\n","import React from 'react'\n\nimport TreeItem from '@material-ui/lab/TreeItem'\nimport { makeStyles } from '@material-ui/core/styles'\nimport Typography from '@material-ui/core/Typography'\nimport TreeNodeLabel from './TreeNodeLabel'\nimport clsx from 'clsx'\n\nexport interface TreeBranchProps {\n    id: number\n    label: string\n    hidden?: boolean\n    searchText?: string\n    children?: React.ReactChild[]\n}\n\nconst useBranchStyles = makeStyles((theme) => ({\n    branch: {\n        marginTop: theme.spacing(0.5)\n    },\n    iconContainer: {\n        width: theme.spacing(4)\n    },\n    label: {\n        // paddingLeft: theme.spacing(1.5)\n    }\n}))\n\nexport const TreeBranch: React.FC<TreeBranchProps> = ({ id, hidden, label, searchText, children }: TreeBranchProps) => {\n    const classes = useBranchStyles()\n    return (\n        <TreeItem\n            // this is IMPORTANT! 'b-##' denotes a branch\n            nodeId={`b-${id}`}\n            className={clsx(classes.branch)}\n            classes={{\n                label: classes.label,\n                iconContainer: classes.iconContainer\n            }}\n            onDoubleClick={(e) => {\n                e.preventDefault()\n                e.stopPropagation()\n            }}\n            onContextMenu={(e) => {\n                e.preventDefault()\n                e.stopPropagation()\n            }}\n            hidden={hidden}\n            label={\n                <Typography variant=\"body1\">\n                    <TreeNodeLabel text={label} query={searchText} />\n                </Typography>\n            }\n        >\n            {children}\n        </TreeItem>\n    )\n}\n\nexport default TreeBranch\n","import React from 'react'\n\nimport TreeView from '@material-ui/lab/TreeView'\nimport { makeStyles } from '@material-ui/core/styles'\nimport TextField from '@material-ui/core/TextField'\nimport InputAdornment from '@material-ui/core/InputAdornment'\n\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight'\nimport FolderIcon from '@material-ui/icons/Folder'\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen'\nimport SearchIcon from '@material-ui/icons/Search'\n\nimport AppSplitter from '../AppSplitter'\nimport { debounce } from 'lodash'\n// import log from 'loglevel'\n\nconst useStyles = makeStyles((theme) => ({\n    container: {\n        height: '100%',\n        width: '100%',\n        display: 'flex',\n        flexDirection: 'column'\n    },\n    folderIcon: {\n        color: theme.palette.secondary.main\n    },\n    tree: {\n        flexGrow: 1,\n        overflow: 'scroll',\n        paddingBottom: theme.spacing(5)\n    },\n    searchBox: {\n        flexGrow: 0,\n        padding: theme.spacing(0.5)\n    },\n    searchBoxInput: {\n        padding: theme.spacing(0.75, 0.5)\n    }\n}))\n\ninterface TreeControlProps {\n    lyrInfoOpen: boolean\n    setSearchText: (text: string) => void\n    expanded: string[]\n    ctxMenu: React.ReactElement | null\n    lyrInfo: React.ReactElement | null\n    selected: string[]\n    setExpanded: (ids: string[]) => void\n    setSelected: (id: string[]) => void\n    children: React.ReactChild | React.ReactChild[]\n}\n\nconst TreeControl: React.FC<TreeControlProps> = ({\n    lyrInfoOpen,\n    setSearchText,\n    expanded,\n    ctxMenu,\n    lyrInfo,\n    selected,\n    setExpanded,\n    setSelected,\n    children\n}: TreeControlProps) => {\n    const classes = useStyles()\n\n    const onNodeToggle = (event: React.ChangeEvent<Record<string, unknown>>, nodeIds: string[]) => {\n        setExpanded(nodeIds)\n    }\n\n    const onNodeSelect = (event: React.ChangeEvent<Record<string, unknown>>, nodeIds: string | string[]) => {\n        setSelected(Array.isArray(nodeIds) ? nodeIds : [nodeIds])\n    }\n    const setSearchDebounced = debounce((stext: string) => setSearchText(stext), 100)\n\n    return (\n        <AppSplitter\n            open={lyrInfoOpen}\n            split=\"horizontal\"\n            primary=\"first\"\n            defaultSize=\"60%\"\n            maxSize=\"80%\"\n            minSize=\"30%\"\n            child1={\n                <div className={classes.container}>\n                    <TextField\n                        fullWidth\n                        className={classes.searchBox}\n                        placeholder=\"Filter Project Layers...\"\n                        variant=\"outlined\"\n                        onChange={(event) => {\n                            setSearchDebounced((event.target.value as string).toLowerCase().trim())\n                        }}\n                        InputProps={{\n                            classes: { input: classes.searchBoxInput },\n                            startAdornment: (\n                                <InputAdornment position=\"start\">\n                                    <SearchIcon />\n                                </InputAdornment>\n                            )\n                        }}\n                    />\n                    <TreeView\n                        className={classes.tree}\n                        defaultCollapseIcon={\n                            <>\n                                <ExpandMoreIcon />\n                                <FolderOpenIcon className={classes.folderIcon} />\n                            </>\n                        }\n                        defaultExpandIcon={\n                            <>\n                                <ChevronRightIcon />\n                                <FolderIcon className={classes.folderIcon} />\n                            </>\n                        }\n                        onNodeToggle={onNodeToggle}\n                        onNodeSelect={onNodeSelect}\n                        selected={selected}\n                        expanded={expanded}\n                    >\n                        {children}\n                    </TreeView>\n                    {ctxMenu}\n                </div>\n            }\n            child2={lyrInfo || <div />}\n        />\n    )\n}\n\nexport default TreeControl\n","import React from 'react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport clsx from 'clsx'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {},\n    item: {},\n    error: {\n        color: theme.palette.error.main\n    }\n}))\n\nexport type CtxMenuItemType = {\n    label: string\n    error?: boolean\n    handleClick?: () => void\n    disabled?: boolean\n}[]\n\nexport interface TreeControlProps {\n    position?: { top: number; left: number }\n    open: boolean\n    onClose: () => void\n    menuItems: CtxMenuItemType\n}\n\nconst TreeContextMenu: React.FC<TreeControlProps> = ({ open, position, onClose, menuItems }: TreeControlProps) => {\n    const classes = useStyles()\n    return (\n        <Menu\n            keepMounted\n            open={open}\n            onClose={onClose}\n            anchorReference=\"anchorPosition\"\n            anchorPosition={position}\n            className={classes.root}\n        >\n            {menuItems.map(({ label, handleClick, disabled, error }, idx) => (\n                <MenuItem\n                    key={`ctxMenuIt-${idx}`}\n                    onClick={handleClick}\n                    disabled={disabled}\n                    className={clsx(classes.item, error && classes.error)}\n                >\n                    {label}\n                </MenuItem>\n            ))}\n        </Menu>\n    )\n}\n\nexport default TreeContextMenu\n","import React from 'react'\nimport TreeContextMenu, { CtxMenuItemType } from '../components/tree/TreeContextMenu'\nimport { useRecoilValue, useSetRecoilState } from 'recoil'\nimport { layerStateSelectorFamily, TreeCtxState, treeInfoPaneIdAtom, treeInfoPaneOpenAtom } from '../recoil'\nimport { ProjectTreeLayerTypes, SymbologyStatus, TilingStatus } from '@riverscapes/common'\nimport useMapLayers from '../hooks/useMapLayers'\n\ninterface Props {\n    ctxState: TreeCtxState\n    onClose: () => void\n}\n\nconst TreeContextMenuConnect: React.FC<Props> = ({ ctxState, onClose }: Props) => {\n    const layer = useRecoilValue(layerStateSelectorFamily(ctxState.leafId))\n    const setTreeInfoPaneId = useSetRecoilState(treeInfoPaneIdAtom)\n    const setTreeeInfoPaneOpen = useSetRecoilState(treeInfoPaneOpenAtom)\n    const { addLayer, removeLayer } = useMapLayers()\n    const menuItems: CtxMenuItemType = []\n    if (layer.leaf.layerType === ProjectTreeLayerTypes.REPORT) {\n        if (layer.tileStatus === TilingStatus.FETCHING || layer.tileStatus === TilingStatus.QUEUED) {\n            menuItems.push({\n                label: 'Report queued for upload...',\n                disabled: true\n            })\n        } else {\n            menuItems.push({\n                label: 'Open Report',\n                disabled: !(layer.tiles?.url && layer.tileStatus === TilingStatus.SUCCESS),\n                handleClick: (): void => {\n                    const newWindow = window.open(layer.tiles?.url + 'index.html', '_blank', 'noopener,noreferrer')\n                    if (newWindow) newWindow.opener = null\n                    onClose()\n                }\n            })\n        }\n    } else if (layer.tileStatus === TilingStatus.FETCHING || layer.symbologyStatus === SymbologyStatus.FETCHING) {\n        menuItems.push({\n            label: 'Loading tile data...',\n            disabled: true\n        })\n    } else {\n        // Now we add some layers\n        if (layer.legendActive) {\n            menuItems.push({\n                label: 'Remove from map',\n                handleClick: (): void => {\n                    removeLayer(layer.leaf.id)\n                    onClose()\n                }\n            })\n        } else if (!layer.legendActive && layer.renderable) {\n            menuItems.push({\n                label: 'Add to map',\n                handleClick: (): void => {\n                    addLayer(layer.leaf.id)\n                    onClose()\n                }\n            })\n        } else if (layer.tileStatus === TilingStatus.QUEUED) {\n            menuItems.push({\n                label: 'Queued for tiling...',\n                disabled: true\n            })\n        } else if (layer.tileStatus === TilingStatus.CREATING) {\n            menuItems.push({\n                label: 'Currently building tiles...',\n                disabled: true\n            })\n        } else if (layer.tileStatus === TilingStatus.TILING_ERROR) {\n            menuItems.push({\n                label: 'Tiles did not build',\n                disabled: true,\n                error: true\n            })\n        } else if (layer.tileStatus === TilingStatus.INDEX_NOT_FOUND) {\n            menuItems.push({\n                label: 'Error fetching tile info',\n                disabled: true,\n                error: true\n            })\n        } else if (layer.tileStatus === TilingStatus.LAYER_NOT_FOUND) {\n            menuItems.push({\n                label: 'The original GIS layer is missing',\n                disabled: true,\n                error: true\n            })\n        } else if (layer.tileStatus === TilingStatus.FETCH_ERROR) {\n            menuItems.push({\n                label: 'Error fetching tile info',\n                disabled: true,\n                error: true\n            })\n        }\n        menuItems.push({\n            label: 'Layer Information',\n            handleClick: (): void => {\n                setTreeInfoPaneId(ctxState.leafId)\n                setTreeeInfoPaneOpen(true)\n                onClose()\n            }\n        })\n    }\n\n    return (\n        <TreeContextMenu\n            open={Boolean(ctxState)}\n            position={ctxState.position}\n            onClose={onClose}\n            menuItems={menuItems}\n        />\n    )\n}\n\nexport default TreeContextMenuConnect\n","import React from 'react'\n\nimport Table from '@material-ui/core/Table'\nimport TableBody from '@material-ui/core/TableBody'\nimport TableCell from '@material-ui/core/TableCell'\nimport TableContainer from '@material-ui/core/TableContainer'\nimport TableRow from '@material-ui/core/TableRow'\nimport { dates } from '@northarrowresearch/common'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Typography } from '@material-ui/core'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        padding: theme.spacing(1)\n    },\n    table: {},\n    section: {\n        marginBottom: theme.spacing(3)\n    },\n    sectionHeader: {\n        borderBottom: '1px solid'\n    },\n    metaKey: { fontWeight: 'bold' },\n    metaValue: {\n        color: theme.palette.text.secondary\n    }\n}))\n\ninterface MetaDataProps {\n    title: string\n    meta: Record<string, string>\n}\n\nconst SPECIAL_FORMATS: Record<string, (val: string) => string> = {\n    datecreated: (val) => {\n        const valDate = dates.HTML5InputToTimestamp(val)\n        return valDate > 0 ? `${dates.formatDate(valDate, 'lll')} (${dates.formatDateAgo(valDate)})` : 'unknown'\n    }\n}\nconst formatString = (key: string, val: string): string => {\n    const lwrKey = key.toLowerCase()\n    if (Object.keys(SPECIAL_FORMATS).indexOf(lwrKey) > -1) {\n        return SPECIAL_FORMATS[lwrKey](val)\n    } else return val\n}\n\nconst MetaData: React.FC<MetaDataProps> = ({ title, meta }: MetaDataProps) => {\n    const classes = useStyles()\n    if (Object.keys(meta).length === 0) return null\n    return (\n        <div className={classes.section}>\n            <Typography variant=\"subtitle1\" className={classes.sectionHeader}>\n                {title}\n            </Typography>\n            <TableContainer>\n                <Table className={classes.table} size=\"small\" aria-label=\"a dense table\">\n                    <TableBody>\n                        {Object.keys(meta).map((rowKey) => (\n                            <TableRow key={rowKey}>\n                                <TableCell component=\"th\" scope=\"row\" className={classes.metaKey}>\n                                    {rowKey}\n                                </TableCell>\n                                <TableCell align=\"right\" className={classes.metaValue}>\n                                    {formatString(rowKey, meta[rowKey])}\n                                </TableCell>\n                            </TableRow>\n                        ))}\n                    </TableBody>\n                </Table>\n            </TableContainer>\n        </div>\n    )\n}\n\nexport default MetaData\n","import React from 'react'\n\nimport Paper from '@material-ui/core/Paper'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Typography } from '@material-ui/core'\nimport { WarehouseButton } from '@riverscapes/react-common'\n\nimport MetaData from './MetaData'\n\n// TODO: Maybe this isn't the best but I don't want to pass it through the whole system\n// Maybe a connector for WarehouseButton????\nimport { warehouseUrl } from '../../config'\n\nconst DONTSHOW = ['_rs_lyr_origin_url']\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        padding: theme.spacing(1)\n    },\n    minimal: {\n        // background:\n    },\n    whNote: {\n        padding: theme.spacing(2, 1)\n    }\n}))\n\ninterface LayerMetaProps {\n    meta: Record<string, string>\n    minimal?: boolean\n}\n\nfunction makeSections(meta: Record<string, string>): Record<string, Record<string, string>> {\n    const keys = Object.keys(meta).filter((k) => DONTSHOW.indexOf(k) < 0)\n\n    const distill = (key) =>\n        keys.filter((k) => k.indexOf(key) === 0).reduce((acc, rk) => ({ ...acc, [rk.replace(key, '')]: meta[rk] }), {})\n\n    return {\n        upstreamWarehouse: distill('_rs_wh_'),\n        upstreamProject: distill('_rs_prj_'),\n        upstreamLayer: distill('_rs_lyr_'),\n        Layer: keys.filter((k) => k.indexOf('_rs') !== 0).reduce((acc, rk) => ({ ...acc, [rk]: meta[rk] }), {})\n    }\n}\n\nconst LayerMeta: React.FC<LayerMetaProps> = ({ meta, minimal }: LayerMetaProps) => {\n    const classes = useStyles()\n    const sections = makeSections(meta)\n    return (\n        <Paper className={minimal ? classes.minimal : classes.root}>\n            {Object.keys(sections.Layer).length > 0 && <MetaData title=\"Layer Metadata\" meta={sections.Layer} />}\n            {!minimal && Object.keys(sections.upstreamWarehouse).length > 0 && (\n                <div className={classes.whNote}>\n                    <Typography variant=\"caption\" component=\"div\">\n                        This layer was imported from a {meta._rs_prj_projType} project in the Riverscapes warehouse. You\n                        can visit the original project using the button below.\n                    </Typography>\n                    <WarehouseButton\n                        title={`Original ${meta._rs_prj_projType} Project`}\n                        href={`${warehouseUrl}#/${meta['_rs_wh_program']}/${meta['_rs_wh_id']}`}\n                    />\n                </div>\n            )}\n            {Object.keys(sections.upstreamProject).length > 0 && (\n                <MetaData title=\"Original Project Metadata\" meta={sections.upstreamProject} />\n            )}\n            {Object.keys(sections.upstreamLayer).length > 0 && (\n                <MetaData title=\"Original Layer Metadata\" meta={sections.upstreamLayer} />\n            )}\n        </Paper>\n    )\n}\n\nexport default LayerMeta\n","import React from 'react'\n\nimport Paper from '@material-ui/core/Paper'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { dates } from '@northarrowresearch/common'\nimport { TileService } from '@riverscapes/common'\n\nimport numeral from 'numeral'\nimport MetaData from './MetaData'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        padding: theme.spacing(1)\n    },\n    sectionHeader: {\n        borderBottom: '1px solid'\n    },\n    table: {},\n    metaKey: { fontWeight: 'bold' },\n    metaValue: {\n        color: theme.palette.text.secondary\n    }\n}))\n\ninterface LayerTileInfoProps {\n    tiles: TileService\n}\n\nconst LayerTileInfo: React.FC<LayerTileInfoProps> = ({ tiles }: LayerTileInfoProps) => {\n    const classes = useStyles()\n    const meta: Record<string, string> = {\n        Status: tiles.status as string,\n        Error: tiles.error as string,\n        Started: tiles\n            ? `${dates.formatDate(tiles.started, 'lll')} (${dates.formatDateAgo(tiles.started)})`\n            : 'unknown',\n        'Last status': tiles\n            ? `${dates.formatDate(tiles.lastStatus, 'lll')} (${dates.formatDateAgo(tiles.lastStatus)})`\n            : 'unknown',\n        'Creation time': tiles ? `${((tiles.duration || 0) / 60).toFixed(0)} minutes` : 'unknown',\n        'Original Size': tiles && tiles.originFile ? numeral(tiles.originFile.size).format('0.0 b') : 'unknown',\n        'Relative path': tiles.rsLayer?.path || 'unknown',\n        'Physical path': tiles ? (tiles.originFile?.key as string) : 'unknown',\n        'Modified (origin)': tiles\n            ? `${dates.formatDate(tiles.originFile?.lastModified, 'lll')} (${dates.formatDateAgo(\n                  tiles.originFile?.lastModified\n              )})`\n            : 'unknown'\n    }\n    return (\n        <Paper className={classes.root}>\n            <MetaData title=\"Webtile information\" meta={meta} />\n        </Paper>\n    )\n}\n\nexport default LayerTileInfo\n","import React from 'react'\n\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Typography from '@material-ui/core/Typography'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport IconButton from '@material-ui/core/IconButton'\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { ProjectTreeLeaf, TileService } from '@riverscapes/common'\nimport { LayerIcon } from '@riverscapes/react-icons'\n\nimport LayerMeta from './LayerMeta'\nimport LayerTileInfo from './LayerTileInfo'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        height: '100%',\n        overflow: 'hidden',\n        display: 'flex',\n        flexDirection: 'column'\n    },\n    toolbar: {\n        flex: '0 0 ',\n        padding: theme.spacing(0, 1),\n        minHeight: theme.spacing(6),\n        background: theme.palette.primary.dark,\n        color: theme.palette.primary.contrastText\n    },\n    spacer: { flexGrow: 1 },\n    layerTitle: {},\n    layerIcon: {},\n    layerMeta: {\n        flexGrow: 1,\n        overflowY: 'scroll',\n        userSelect: 'text',\n        '& *': {\n            userSelect: 'text'\n        }\n    },\n    typeContainer: {\n        // borderRadius: theme.spacing(1),\n        // background: '#FFFFFF22',\n        // margin: theme.spacing(1),\n        // padding: theme.spacing(0, 1),\n        // border: '1px solid #FFFFFF22'\n    },\n    closeButton: {\n        // marginLeft: theme.spacing(2)\n    }\n}))\n\ninterface LayerInfoProps {\n    leaf: ProjectTreeLeaf\n    tiles?: TileService\n    handleClose: () => void\n}\n\nconst LayerInfo: React.FC<LayerInfoProps> = ({ leaf, tiles, handleClose }: LayerInfoProps) => {\n    const classes = useStyles()\n    return (\n        <div className={classes.root}>\n            <Toolbar className={classes.toolbar}>\n                <Tooltip title={`This is a ${leaf.layerType} layer`}>\n                    <IconButton edge=\"start\" className={classes.layerIcon} color=\"inherit\" aria-label=\"menu\">\n                        <LayerIcon layerType={leaf.layerType} />\n                    </IconButton>\n                </Tooltip>\n                <Typography variant=\"body2\" className={classes.layerTitle}>\n                    {leaf.label}\n                </Typography>\n                <div className={classes.spacer} />\n                {/* <div className={classes.typeContainer}>\n                    </div> */}\n                <IconButton\n                    edge=\"start\"\n                    className={classes.closeButton}\n                    color=\"inherit\"\n                    aria-label=\"menu\"\n                    onClick={handleClose}\n                >\n                    <CloseIcon />\n                </IconButton>\n            </Toolbar>\n            <div className={classes.layerMeta}>\n                {leaf.meta && <LayerMeta meta={leaf.meta || {}} />}\n                {tiles && <LayerTileInfo tiles={tiles} />}\n            </div>\n        </div>\n    )\n}\n\nexport default LayerInfo\n","import React from 'react'\nimport { useRecoilValue } from 'recoil'\nimport { layerStateSelectorFamily } from '../recoil'\nimport LayerInfo from '../components/meta/LayerInfo'\n\ninterface Props {\n    leafID: number\n    handleClose: () => void\n}\n\nconst TreeLayerInfo: React.FC<Props> = ({ leafID, handleClose }: Props) => {\n    const layer = useRecoilValue(layerStateSelectorFamily(leafID))\n    return <LayerInfo leaf={layer.leaf} tiles={layer.tiles} handleClose={handleClose} />\n}\n\nexport default TreeLayerInfo\n","import React from 'react'\nimport { useRecoilState, useRecoilValue, useSetRecoilState } from 'recoil'\nimport {\n    projectHiddenNodesSelector,\n    treeAllIdsSelector,\n    treeContextMenuAtom,\n    treeSelectedIdsAtom,\n    treeExpandedIdsAtom,\n    treeFilterTextAtom,\n    treeBranchStateSelectorFamily,\n    treeLeafStateSelector,\n    treeInfoPaneIdAtom,\n    treeInfoPaneOpenAtom,\n    treeRootBranchId\n} from '../recoil'\nimport useMapLayers from '../hooks/useMapLayers'\nimport TreeLeaf from '../components/tree/TreeLeaf'\nimport TreeBranch from '../components/tree/TreeBranch'\nimport TreeControl from '../components/tree/TreeControl'\nimport { isEqual } from 'lodash'\n\nimport TreeContextMenuConnect from './TreeContextMenu.connect'\nimport TreeLayerInfoConnect from './TreeLayerInfo.connect'\nimport log from 'loglevel'\nimport { ProjectTreeLayerTypes } from '@riverscapes/common'\nimport { googleAnalytics } from '@riverscapes/react-common'\ninterface TreeBranchProps {\n    branchId: number\n    depth: number\n}\n\nconst TreeBranchConnector: React.FC<TreeBranchProps> = ({ branchId, depth }: TreeBranchProps) => {\n    const branchState = useRecoilValue(treeBranchStateSelectorFamily(branchId))\n    const filterText = useRecoilValue(treeFilterTextAtom)\n    if (!branchState || !branchState.branch) return null\n\n    const branches = branchState?.branch.children.branches\n        .map((bid, idx) => (\n            <TreeBranchConnector\n                key={`${branchState?.branch.branch.label}-${bid}-${idx}`}\n                branchId={bid}\n                depth={depth + 1}\n            />\n        ))\n        .filter((d) => d)\n\n    const leaves = branchState?.branch.children.leaves\n        .map((lid, idx) => (\n            <TreeLeafConnector\n                key={`${branchState?.branch.branch.label}-${lid}-${idx}`}\n                leafId={lid}\n                depth={depth + 1}\n            />\n        ))\n        .filter((d) => d)\n\n    // Clean up any dead ends with no leaves\n    if (leaves.length === 0 && branches.length === 0) return null\n\n    return (\n        <TreeBranch\n            id={branchId}\n            label={branchState?.branch.branch.label}\n            hidden={branchState?.hidden}\n            searchText={filterText}\n        >\n            {[...branches, ...leaves]}\n        </TreeBranch>\n    )\n}\n\ninterface TreeLeafProps {\n    leafId: number\n    depth: number\n}\n\nconst TreeLeafConnector: React.FC<TreeLeafProps> = ({ leafId }: TreeLeafProps) => {\n    const treeLeafState = useRecoilValue(treeLeafStateSelector(leafId))\n    const filterText = useRecoilValue(treeFilterTextAtom)\n    const setCtxState = useSetRecoilState(treeContextMenuAtom)\n    const setInfoPaneId = useSetRecoilState(treeInfoPaneIdAtom)\n    const { toggleLayer } = useMapLayers()\n\n    const handleContext = (leafId: number, left: number, top: number) => {\n        googleAnalytics.event('webrave', 'open_context_menu')\n        setCtxState({ leafId, position: { left, top } })\n    }\n\n    const doubleClick = () => {\n        googleAnalytics.event('webrave', 'double_click')\n        if (treeLeafState.leaf.layerType === ProjectTreeLayerTypes.REPORT && treeLeafState.renderable) {\n            const newWindow = window.open(treeLeafState.reportUrl, '_blank', 'noopener,noreferrer')\n            if (newWindow) newWindow.opener = null\n        } else if (treeLeafState.leaf.layerType === ProjectTreeLayerTypes.FILE) {\n            log.error('FILE DOWNLOADING NOT HANDLED YET')\n        } else if (treeLeafState.renderable) toggleLayer(treeLeafState.leaf.id)\n    }\n\n    if (!treeLeafState || !treeLeafState.leaf || !treeLeafState.leaf.nodeExists) return null\n    const { id, layerType, label } = treeLeafState.leaf\n    return (\n        <TreeLeaf\n            id={id}\n            layerType={layerType}\n            label={label}\n            active={treeLeafState.active}\n            hidden={treeLeafState.hidden}\n            tilesState={treeLeafState.tilesState}\n            searchText={filterText}\n            handleClick={setInfoPaneId}\n            handleDoubleClick={doubleClick}\n            handleContext={handleContext}\n        />\n    )\n}\n\nconst TreeControlConnect: React.FC = () => {\n    const setFilterText = useSetRecoilState(treeFilterTextAtom)\n    const rootBranchId = useRecoilValue(treeRootBranchId)\n    const [expandedIds, setExpandedIds] = useRecoilState(treeExpandedIdsAtom)\n    const [selectedIds, setSelectedIds] = useRecoilState(treeSelectedIdsAtom)\n    const [ctxState, setCtxState] = useRecoilState(treeContextMenuAtom)\n    const infoPaneId = useRecoilValue(treeInfoPaneIdAtom)\n    const allIds = useRecoilValue(treeAllIdsSelector)\n\n    const hiddenNodes = useRecoilValue(projectHiddenNodesSelector)\n    const [infoPaneOpen, setInfoPaneOpen] = useRecoilState(treeInfoPaneOpenAtom)\n\n    const setSelected = (ids) => {\n        if (!isEqual(ids, selectedIds)) setSelectedIds(ids)\n    }\n\n    // If there's a search query on then everything is expanded\n    const realExpanded = hiddenNodes.branches.length > 0 ? allIds : expandedIds\n    const realSetExpanded =\n        hiddenNodes.branches.length > 0\n            ? () => {\n                  log.debug('collapsing turned off')\n              }\n            : setExpandedIds\n\n    const lyrInfo =\n        infoPaneOpen && infoPaneId !== null ? (\n            <TreeLayerInfoConnect leafID={infoPaneId} handleClose={() => setInfoPaneOpen(false)} />\n        ) : null\n\n    const treeContrextMenu = ctxState && (\n        <TreeContextMenuConnect ctxState={ctxState} onClose={() => setCtxState(null)} />\n    )\n    const rootBranch = rootBranchId !== null ? <TreeBranchConnector branchId={rootBranchId} depth={0} /> : <div />\n\n    return (\n        <TreeControl\n            lyrInfoOpen={infoPaneOpen}\n            setSearchText={setFilterText}\n            expanded={realExpanded}\n            ctxMenu={treeContrextMenu}\n            lyrInfo={lyrInfo}\n            selected={selectedIds}\n            setExpanded={realSetExpanded}\n            setSelected={setSelected}\n        >\n            {rootBranch}\n        </TreeControl>\n    )\n}\n\nexport default TreeControlConnect\n","import React, { useEffect } from 'react'\nimport { useRecoilCallback, useRecoilValueLoadable } from 'recoil'\nimport {\n    tilesRequestIdAtomFamily,\n    tilesRetriesAtomFamily,\n    boundsAtom,\n    zoomBoundsAtom,\n    tilesSelectorFamily\n} from '../recoil'\nimport { appDefaults } from '../config'\nimport { newBounds, newZoomBounds } from '../lib/util'\nimport { TileService, TilingStatus } from '@riverscapes/common'\n\ninterface MPDProps {\n    layerPath: string\n}\n\nconst MapTilesConnect: React.FC<MPDProps> = ({ layerPath }: MPDProps) => {\n    const tLoad = useRecoilValueLoadable(tilesSelectorFamily(layerPath))\n\n    const updateBoundsState = useRecoilCallback(({ snapshot, set }) => async () => {\n        const tLoad = snapshot.getLoadable(tilesSelectorFamily(layerPath))\n        if (tLoad.state !== 'hasValue') return\n        const tiles = tLoad.contents as TileService\n        // Now we have to carefully decide whether to queue up another fetch or give up\n        const reqId = await snapshot.getPromise(tilesRequestIdAtomFamily(layerPath))\n        const retryId = await snapshot.getPromise(tilesRetriesAtomFamily(layerPath))\n        const bounds = await snapshot.getPromise(boundsAtom)\n        const zoomBounds = await snapshot.getPromise(zoomBoundsAtom)\n        set(boundsAtom, newBounds(bounds, tiles.bounds))\n        set(zoomBoundsAtom, newZoomBounds(zoomBounds, [tiles.minZoom, tiles.maxZoom]))\n        // If we succeeded then there's nothing left to do\n        if (tiles.status === TilingStatus.SUCCESS) {\n            return\n        }\n        // If we failed to fetch then retry the network call\n        else if (tiles.status === TilingStatus.FETCH_ERROR) {\n            if (retryId < 5)\n                setTimeout(() => set(tilesRetriesAtomFamily(layerPath), retryId + 1), appDefaults.retryDelayS * 1000)\n        }\n        // If the tile status is on a transitory state (QUEUED, UNKNOWN, CREATING) then try again in (n) seconds\n        else if (\n            tiles.status === TilingStatus.QUEUED ||\n            tiles.status === TilingStatus.UNKNOWN ||\n            tiles.status === TilingStatus.CREATING\n        ) {\n            setTimeout(() => set(tilesRequestIdAtomFamily(layerPath), reqId + 1), appDefaults.refreshDelayS * 1000)\n        }\n    })\n    useEffect(() => {\n        updateBoundsState()\n    }, [tLoad])\n\n    return null\n}\n\nexport default MapTilesConnect\n","import React, { useMemo } from 'react'\nimport InputLabel from '@material-ui/core/InputLabel'\nimport Typography from '@material-ui/core/Typography'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport FormControl from '@material-ui/core/FormControl'\nimport Select from '@material-ui/core/Select'\nimport { ProjectTreeView } from '@riverscapes/common'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        margin: theme.spacing(1, 0)\n    }\n}))\nconst EMPTY_VID = 'custom'\nexport interface ViewListProps {\n    activeView: string | null\n    defaultView?: string\n    projectViews: ProjectTreeView[]\n    handleChange: (viewId: string) => void\n}\nconst ViewList: React.FC<ViewListProps> = ({ activeView, defaultView, projectViews, handleChange }: ViewListProps) => {\n    const classes = useStyles()\n    const realView = activeView === null ? EMPTY_VID : activeView\n    const viewOptions = useMemo(() => {\n        if (!projectViews || projectViews.length === 0)\n            return [\n                <MenuItem key={EMPTY_VID} value=\"custom\" disabled>\n                    <Typography variant=\"subtitle1\" color=\"textSecondary\">\n                        <em>No custom views</em>\n                    </Typography>\n                </MenuItem>\n            ]\n        const viewOpts =\n            projectViews.map((v, idx) => {\n                const isDefault = v.id === defaultView\n                const defaultString = isDefault ? '(default)' : ''\n                return (\n                    <MenuItem key={`view-${idx}`} value={v.id}>\n                        {v.name} {defaultString}\n                    </MenuItem>\n                )\n            }) || []\n        return [\n            ...viewOpts,\n            activeView === null && (\n                <MenuItem key={EMPTY_VID} value=\"custom\">\n                    <Typography variant=\"subtitle1\" color=\"textSecondary\">\n                        <em>Custom View</em>\n                    </Typography>\n                </MenuItem>\n            )\n        ]\n    }, [projectViews, activeView])\n\n    return (\n        <FormControl className={classes.root} fullWidth>\n            <InputLabel htmlFor=\"grouped-native-select\">Curated Views</InputLabel>\n            <Select\n                id=\"view\"\n                value={realView}\n                disabled={!projectViews || projectViews.length === 0}\n                variant=\"filled\"\n                onChange={(event) => event.target.value !== EMPTY_VID && handleChange(event.target.value as string)}\n            >\n                {viewOptions}\n            </Select>\n        </FormControl>\n    )\n}\n\nexport default ViewList\n","import React from 'react'\nimport InputLabel from '@material-ui/core/InputLabel'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport FormControl from '@material-ui/core/FormControl'\nimport Select from '@material-ui/core/Select'\nimport { makeStyles } from '@material-ui/core/styles'\nimport Typography from '@material-ui/core/Typography'\nimport { BaseLayer } from '../../types'\n\ninterface BaseLayerPickerProps {\n    baseLayer: BaseLayer\n    baseLayers: BaseLayer[]\n    setBaseLayer: (baseLyr: BaseLayer) => void\n}\n\nconst useStyles = makeStyles((theme) => ({\n    root: {},\n    menuIcon: {\n        marginRight: theme.spacing(1)\n    },\n    menuItem: {\n        display: 'flex'\n    }\n}))\n\nconst BaseLayerPicker: React.FC<BaseLayerPickerProps> = ({\n    baseLayer,\n    baseLayers,\n    setBaseLayer\n}: BaseLayerPickerProps) => {\n    const classes = useStyles()\n\n    const viewOptions = baseLayers.map((v, idx) => {\n        const Icon = v.Icon\n        return (\n            <MenuItem key={`view-${idx}`} value={v.id} className={classes.menuItem}>\n                <Icon className={classes.menuIcon} />\n                <Typography>{v.title}</Typography>\n            </MenuItem>\n        )\n    })\n\n    return (\n        <FormControl className={classes.root} fullWidth>\n            <InputLabel>Basemap</InputLabel>\n            <Select\n                id=\"baselayer\"\n                value={baseLayer.id}\n                variant=\"filled\"\n                classes={{\n                    selectMenu: classes.menuItem\n                }}\n                onChange={(event) => {\n                    const newBl = baseLayers.find((bl) => bl.id === event.target.value)\n                    if (newBl) setBaseLayer(newBl)\n                }}\n            >\n                {viewOptions}\n            </Select>\n        </FormControl>\n    )\n}\n\nexport default BaseLayerPicker\n","import React from 'react'\nimport { Typography } from '@material-ui/core'\n\ninterface Props {\n    error?: string\n}\n\nconst LegendError: React.FC<Props> = ({ error }: Props) => {\n    return <Typography color=\"error\">{error || ' '}</Typography>\n}\n\nexport default LegendError\n","import React from 'react'\nimport { ProjectTreeView } from '@riverscapes/common'\nimport ViewList from './ViewList'\nimport BaseLayerPicker from './BaseLayerPicker'\nimport { List } from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport LegendError from './LegendError'\nimport { BaseLayer } from '../../types'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {},\n    legendBox: {\n        padding: theme.spacing(1),\n        border: '1px solid #999999',\n        borderRadius: 5,\n        position: 'absolute',\n        background: 'white',\n        width: 270,\n        boxShadow: '3px 3px 3px #00000066',\n        top: 15,\n        right: 15\n    },\n    subheaders: {\n        background: 'white'\n    },\n    container: {}\n}))\n\ninterface LegendProps {\n    defaultView: string\n    views: ProjectTreeView[]\n    error?: string\n    viewId: string | null\n    setViewId: (viewId: string) => void\n    baseLayer: BaseLayer\n    baseLayers: BaseLayer[]\n    setBaseLayer: (baselayer: BaseLayer) => void\n    children: React.ReactElement[]\n}\n\nconst Legend: React.FC<LegendProps> = ({\n    views,\n    defaultView,\n    children,\n    baseLayer,\n    baseLayers,\n    setBaseLayer,\n    error,\n    viewId,\n    setViewId\n}: LegendProps) => {\n    const classes = useStyles()\n    return (\n        <div className={classes.legendBox}>\n            <div className={classes.root}>\n                <BaseLayerPicker baseLayer={baseLayer} baseLayers={baseLayers} setBaseLayer={setBaseLayer} />\n                <ViewList activeView={viewId} defaultView={defaultView} handleChange={setViewId} projectViews={views} />\n                <div className={classes.container}>\n                    <List dense disablePadding>\n                        {children}\n                    </List>\n                </div>\n                <LegendError error={error} />\n            </div>\n        </div>\n    )\n}\n\nexport default Legend\n","import React from 'react'\nimport { util } from '@northarrowresearch/common'\nimport ListItem from '@material-ui/core/ListItem'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport log from 'loglevel'\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        flexDirection: 'column',\n        paddingLeft: theme.spacing(10)\n    },\n    row: {\n        width: '100%'\n    },\n    colorBox: {\n        border: '1px solid #eaeaea',\n        overflow: 'hidden',\n        color: '#FFFFFF00',\n        width: theme.spacing(2),\n        height: theme.spacing(2)\n    },\n    value: {\n        marginLeft: theme.spacing(1)\n    }\n}))\n\nexport interface ViewListProps {\n    max?: number\n    min?: number\n    ramp: string[][]\n}\nconst ViewList: React.FC<ViewListProps> = ({ max, min, ramp }: ViewListProps) => {\n    const classes = useStyles()\n    const pRamp = parseRamp(ramp, max, min)\n    return (\n        <ListItem divider dense disableGutters className={classes.root}>\n            {pRamp.map((row, idr) => (\n                <Typography key={`cr-${idr}`} variant=\"caption\" className={classes.row} component=\"div\">\n                    <span className={classes.colorBox} style={{ background: row[0] }}>\n                        color\n                    </span>\n                    <span className={classes.value}>{row[1]}</span>\n                </Typography>\n            ))}\n        </ListItem>\n    )\n}\n\nexport default ViewList\n\nfunction parseRamp(ramp: string[][], max?: number, min?: number): [string, string][] {\n    let retVal: [string, number][] = []\n    // First filter out gargage rows\n    try {\n        const percent = Boolean(ramp.find((row) => row[0].indexOf('%') > 0))\n        retVal = ramp.reduce<[string, number][]>((acc, row) => {\n            // Throw away any non-numeric rows\n            if (row.length < 4 || !util.isNumeric(row[0].replace('%', '').trim()) || !util.isNumeric(row[1])) return acc\n            else {\n                try {\n                    const colors = row.slice(1, 4).map((it) => parseInt(it.trim(), 10))\n                    if (!colors.every((c) => c >= 0 && c <= 255)) return acc\n\n                    const colorStr = colors.length > 3 ? `rgba(${colors.join(',')})` : `rgba(${colors.join(',')})`\n                    const val = parseFloat(row[0].replace('%', ''))\n\n                    return [...acc, [colorStr, val]]\n                } catch {\n                    return acc\n                }\n            }\n        }, [])\n        retVal.sort((a, b) => a[1] - b[1])\n        if (percent) {\n            if (!max || !min) return retVal.map(([c, v]) => [c, v + '%'])\n            else {\n                return retVal.map(([c, v]) => {\n                    const newVal = (max - min) * (v / 100) + min\n                    return [c, newVal.toFixed(2)]\n                })\n            }\n        }\n    } catch (e) {\n        log.error(e)\n    }\n\n    return retVal.map(([c, v]) => [c, v.toFixed(2)])\n}\n","import React, { useState } from 'react'\nimport IconButton from '@material-ui/core/IconButton'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport Avatar from '@material-ui/core/Avatar'\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport ColorRamp from './ColorRamp'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { LayerIcon } from '@riverscapes/react-icons'\nimport { ProjectTreeLayerTypes } from '@riverscapes/common'\n\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight'\n\nimport log from 'loglevel'\n// import { legendColorFinder } from '../../lib/util'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ListItemIcon } from '@material-ui/core'\n// import { makeStyles, useTheme } from '@material-ui/core/styles'\n\nexport type LegendData = {\n    min?: number\n    max?: number\n    ramp?: string[][]\n}\n\nconst useStyles = makeStyles((theme) => ({\n    container: {},\n    listItem: {\n        paddingLeft: 0\n    },\n    listItemAvatar: {\n        minWidth: theme.spacing(6)\n    },\n    expandIcon: {\n        minWidth: theme.spacing(2)\n    },\n    expandDisabled: {\n        color: 'rgba(0,0,0,0.05)!important'\n    },\n    avatar: {},\n    root: {\n        marginTop: theme.spacing(2)\n    },\n    heading: {\n        marginTop: theme.spacing(1)\n    },\n    loadingSpinner: {\n        color: theme.palette.text.secondary\n    },\n    layerItem: {\n        display: 'flex'\n    },\n    legendName: {\n        flexGrow: 1\n    },\n    deleteButtonHover: {},\n    legendColor: {\n        border: '1px solid black',\n        width: '20px',\n        display: 'inline-block',\n        height: '14px',\n        marginRight: '5px'\n    },\n    deleteButton: {\n        flexGrow: 0,\n        color: '#AAAAAA'\n    }\n}))\n\nexport interface LegendLayerItemProps {\n    label: string\n    leafId: number\n    loading?: boolean\n    // TODO: This is largely innadequate long term and doesn't handle rasters or color ramps\n    fgColor?: string\n    bgColor?: string\n    subLabel?: string\n    layerType: ProjectTreeLayerTypes\n    legendData?: LegendData\n    removeLayer: (lid: number) => void\n}\n\nconst LegendLayerItem: React.FC<LegendLayerItemProps> = ({\n    label,\n    leafId,\n    loading,\n    fgColor,\n    bgColor,\n    legendData,\n    layerType,\n    removeLayer\n}: LegendLayerItemProps) => {\n    const classes = useStyles()\n    const [open, setOpen] = useState<boolean>(false)\n    const bgColFinal = layerType === ProjectTreeLayerTypes.RASTER ? '#FFFFFF' : bgColor || '#66666666'\n    const fgColFinal = layerType === ProjectTreeLayerTypes.RASTER ? '#000000' : fgColor || '#000000'\n\n    const toggle = (): void => (hasRamp ? setOpen(!open) : undefined)\n\n    let subLabel = ''\n    if (legendData && legendData.max && legendData.min) {\n        try {\n            subLabel = `min: ${(legendData.min as number).toFixed(2)} max: ${(legendData.max as number).toFixed(2)}`\n        } catch {\n            log.error(`Could not get stats using object: ${JSON.stringify(legendData)}`)\n        }\n    }\n\n    const hasRamp = Boolean(legendData && legendData.ramp)\n\n    return (\n        <React.Fragment>\n            <ListItem dense className={classes.listItem}>\n                <ListItemIcon className={classes.expandIcon}>\n                    <IconButton\n                        size=\"small\"\n                        onClick={toggle}\n                        disabled={!hasRamp}\n                        classes={{ disabled: classes.expandDisabled }}\n                    >\n                        {hasRamp && open ? <ExpandMoreIcon /> : <ChevronRightIcon />}\n                    </IconButton>\n                </ListItemIcon>\n                <ListItemAvatar className={classes.listItemAvatar}>\n                    <Avatar style={{ background: bgColFinal }} onClick={toggle}>\n                        <LayerIcon\n                            layerType={layerType}\n                            iconProps={{\n                                style: { color: fgColFinal }\n                            }}\n                        />\n                    </Avatar>\n                </ListItemAvatar>\n                <ListItemText primary={label} secondary={subLabel} onClick={toggle} />\n                <ListItemSecondaryAction>\n                    {loading && (\n                        <CircularProgress className={classes.loadingSpinner} color=\"inherit\" thickness={3} size={15} />\n                    )}\n                    {!loading && (\n                        <IconButton\n                            edge=\"end\"\n                            aria-label=\"delete\"\n                            onClick={(event) => {\n                                event.stopPropagation()\n                                removeLayer(leafId)\n                            }}\n                        >\n                            <CancelIcon />\n                        </IconButton>\n                    )}\n                </ListItemSecondaryAction>\n            </ListItem>\n            {hasRamp && open && (\n                <ColorRamp max={legendData?.max} min={legendData?.min} ramp={legendData?.ramp as string[][]} />\n            )}\n        </React.Fragment>\n    )\n}\n\nexport default LegendLayerItem\n","import React from 'react'\nimport Legend from '../components/legend/Legend'\nimport { useRecoilState, useRecoilValue } from 'recoil'\nimport useMapLayers from '../hooks/useMapLayers'\nimport {\n    baseLayerAtom,\n    activeViewAtom,\n    projectAtom,\n    layerStateSelectorFamily,\n    activeLeavesSortedSelector,\n    leafRandomColAtomFamily,\n    treeLeafSelectorFamily,\n    mapErrorAtom\n} from '../recoil'\nimport { legendColors } from '../config'\nimport baseLayers from '../mapStyles'\nimport { legendColorFinder } from '../lib/util'\nimport { ProjectTreeLayerTypes, ProjectTreeView, SymbologyStatus, TilingStatus } from '@riverscapes/common'\nimport LegendLayerItem from '../components/legend/LegendLayerItem'\nimport useViews from '../hooks/useViews'\nimport { googleAnalytics } from '@riverscapes/react-common'\nimport { BaseLayer } from '../types'\n// import log from 'loglevel'\n\nconst LegendConnect: React.FC = () => {\n    const proj = useRecoilValue(projectAtom)\n    const mapError = useRecoilValue(mapErrorAtom)\n    const activeLeaves = useRecoilValue(activeLeavesSortedSelector)\n    const [baseLayer, _setBaseLayer] = useRecoilState(baseLayerAtom)\n    const currentView = useRecoilValue(activeViewAtom)\n    const { setView } = useViews()\n\n    const setBaseLayer = (bl: BaseLayer): void => {\n        googleAnalytics.event('webrave', 'set_base_layer', bl.id)\n        _setBaseLayer(bl)\n    }\n\n    if (!proj) return null\n\n    const views: ProjectTreeView[] = proj.tree.views ? proj.tree.views : []\n    const defaultView = views.length > 0 && proj.tree.defaultView ? proj.tree.defaultView : ''\n    return (\n        <Legend\n            views={views}\n            defaultView={defaultView}\n            baseLayer={baseLayer}\n            baseLayers={baseLayers}\n            error={mapError}\n            setBaseLayer={setBaseLayer}\n            viewId={currentView}\n            setViewId={setView}\n        >\n            {activeLeaves.map(({ id }, idx) => (\n                <LegendItemConnect key={`lgdLyr-${idx}`} lid={id} />\n            ))}\n        </Legend>\n    )\n}\n\nexport default LegendConnect\n\ninterface ItemProps {\n    lid: number\n}\n\nconst LegendItemConnect: React.FC<ItemProps> = ({ lid }: ItemProps) => {\n    const leaf = useRecoilValue(treeLeafSelectorFamily(lid))\n    const layer = useRecoilValue(layerStateSelectorFamily(lid))\n    const rndColIdx = useRecoilValue(leafRandomColAtomFamily(lid))\n    const { removeLayer } = useMapLayers()\n\n    const cols = legendColorFinder(\n        layer.symbology?.symbologyJSON,\n        rndColIdx !== null ? legendColors[rndColIdx] : undefined\n    )\n    const stats = layer.tiles?.rasterStats?.stats as Record<string, unknown>\n\n    const { id, layerType, label } = leaf\n    return (\n        <LegendLayerItem\n            leafId={id}\n            fgColor={cols.fg}\n            bgColor={cols.bg}\n            layerType={layerType}\n            label={label}\n            legendData={\n                layer.symbology?.colorRamp && leaf.layerType === ProjectTreeLayerTypes.RASTER\n                    ? {\n                          max: stats.maximum as number,\n                          min: stats.minimum as number,\n                          ramp: layer.symbology?.colorRamp\n                      }\n                    : undefined\n            }\n            loading={layer.tileStatus === TilingStatus.FETCHING || layer.symbologyStatus === SymbologyStatus.FETCHING}\n            removeLayer={removeLayer}\n        />\n    )\n}\n","import React from 'react'\n// import { makeStyles } from '@material-ui/core/styles'\nimport { Typography, CircularProgress } from '@material-ui/core'\nimport { Loading } from '@northarrowresearch/react-common'\n\nconst MapLoading: React.FC = () => {\n    return (\n        <Loading\n            logoSVG={<CircularProgress size=\"3rem\" thickness={4} />}\n            status={\n                <Typography variant=\"h5\" component=\"div\">\n                    Loading Map...\n                </Typography>\n            }\n            containerProps={{\n                maxWidth: 'xl',\n                style: {\n                    position: 'absolute',\n                    zIndex: 1000,\n                    top: 0,\n                    left: 0,\n                    width: '100%',\n                    height: '100%',\n                    background: '#FFFFFF33'\n                }\n            }}\n        />\n    )\n}\n\nexport default MapLoading\n","import React, { useState, useRef, useEffect } from 'react'\nimport { config } from '@riverscapes/react-common'\nimport MapGL, { ViewportProps } from 'react-map-gl'\nimport { makeStyles } from '@material-ui/core/styles'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport MapLoading from './MapLoading'\nimport mapStyles from '../../mapStyles'\nimport { BaseLayer } from '../../types'\nimport { CircularProgress } from '@material-ui/core'\nimport _ from 'lodash'\nimport log from 'loglevel'\n\ninterface MapProps {\n    baseLayer: BaseLayer\n    styleLoading?: boolean\n    bounds?: [minx: number, miny: number, maxx: number, maxy: number]\n    zoomBounds: [minZoom: number, maxZoom: number]\n    children?: React.ReactChild | React.ReactChildren | React.ReactElement[]\n}\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        marginLeft: theme.spacing(1)\n    },\n    container: {\n        display: 'flex',\n        height: '100%'\n    },\n    mapContainer: {\n        position: 'relative',\n        background: '#CCCCCC',\n        height: '100%',\n        width: '100%',\n        '&>h1': {\n            color: '#9999FF',\n            position: 'absolute',\n            top: '50%',\n            left: '50%',\n            transform: 'translate(-50%, -50%)'\n        }\n    },\n    drawerContents: {\n        // border: '1px solid green',\n        height: '100%',\n        display: 'flex'\n    },\n    drawerSpacer: {\n        flex: '0 0 0%'\n    },\n    drawerSpacerOpen: {\n        // flex: `0 0 ${DRAWER_WIDTH}`\n    },\n    dialogContainer: {\n        alignItems: 'left',\n        justifyContent: 'left'\n    },\n    loaderSpinner: {\n        position: 'absolute',\n        bottom: 10,\n        right: 10,\n        color: theme.palette.secondary.main\n    },\n    dialog: {\n        position: 'absolute',\n        margin: 0,\n        left: '20px',\n        top: '20px'\n    },\n    subheaders: {\n        background: 'white'\n    },\n    dummyText: {}\n}))\n\nconst defaultViewport: ViewportProps = {\n    // longitude: -115.8,\n    // latitude: 46.1,\n    zoom: 8\n    // bearing: 0,\n    // pitch: 0\n}\n\nconst debounceConsoleLog = _.debounce((...vals) => log.debug(...vals), 1500)\n\nconst Map: React.FC<MapProps> = ({ children, baseLayer, styleLoading, bounds, zoomBounds }: MapProps) => {\n    const classes = useStyles()\n    const [viewport, _setViewport] = useState<ViewportProps>(defaultViewport)\n    const viewportRef = useRef<ViewportProps>()\n    viewportRef.current = viewport\n\n    // Constrain the Bounds and zoom\n    const setViewport = (inV: ViewportProps) => {\n        const outV = { ...viewportRef.current, ...inV, pitch: 0, bearing: 0 }\n        // Constrict bounds\n        if (zoomBounds && outV.zoom) {\n            if (outV.zoom > zoomBounds[1]) outV.zoom = zoomBounds[1]\n            else if (outV.zoom < zoomBounds[0]) outV.zoom = zoomBounds[0]\n        }\n        if (bounds && outV.longitude && outV.latitude) {\n            if (outV.longitude < bounds[0]) outV.longitude = bounds[0]\n            else if (outV.longitude > bounds[2]) outV.longitude = bounds[2]\n            if (outV.latitude < bounds[1]) outV.latitude = bounds[1]\n            else if (outV.latitude > bounds[3]) outV.latitude = bounds[3]\n        }\n\n        debounceConsoleLog('setViewport DEBOUNCED', { inV, outV, bounds })\n        _setViewport(outV)\n    }\n\n    const baseStyle = mapStyles.find((bs) => bs.id === baseLayer.id) as BaseLayer\n\n    // When loading we may get an initial zoom and/or bounds value\n    useEffect(() => {\n        const newViewport = { ...viewportRef.current }\n        // First set\n        if (!newViewport.latitude && bounds) {\n            setViewport({\n                ...newViewport,\n                longitude: (bounds[0] + bounds[2]) / 2,\n                latitude: (bounds[1] + bounds[3]) / 2\n            })\n        }\n    }, [bounds, zoomBounds])\n\n    const mapLoader = styleLoading && <CircularProgress size=\"2rem\" thickness={6} className={classes.loaderSpinner} />\n\n    // NO HOOKS BELOW HERE\n    if (!baseStyle || !bounds) return <MapLoading />\n    return (\n        <div className={classes.mapContainer}>\n            <MapGL\n                {...viewport}\n                width=\"100%\"\n                height=\"100%\"\n                minZoom={zoomBounds[0] || 4}\n                maxZoom={zoomBounds[1] || 20}\n                mapStyle={baseStyle.style}\n                clickRadius={2}\n                onViewportChange={setViewport}\n                mapboxApiAccessToken={config.mapConfig.mapBoxToken}\n            >\n                {mapLoader}\n                {children}\n            </MapGL>\n        </div>\n    )\n}\n\nexport default Map\n","import React from 'react'\nimport { Fab } from '@material-ui/core'\nimport LayersClearIcon from '@material-ui/icons/LayersClear'\nimport { makeStyles } from '@material-ui/core/styles'\nimport LayersIcon from '@material-ui/icons/Layers'\n\ninterface Props {\n    drawerOpen?: boolean\n    toggleDrawer: () => void\n}\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        position: 'absolute',\n        top: theme.spacing(1),\n        left: theme.spacing(1)\n    }\n}))\n\nconst ProjectLoading: React.FC<Props> = ({ drawerOpen, toggleDrawer }: Props) => {\n    const classes = useStyles()\n    return (\n        <Fab color=\"primary\" aria-label=\"add\" onClick={toggleDrawer} size=\"small\" className={classes.root}>\n            {drawerOpen ? <LayersClearIcon /> : <LayersIcon />}\n        </Fab>\n    )\n}\n\nexport default ProjectLoading\n","import { TileService, GISTileLayer, ProjectTreeLeaf } from '@riverscapes/common'\nimport { Color } from '@material-ui/core'\n\nfunction calculateOpacity(transparency = 0): number {\n    const sanitized = Math.max(0, Math.min(100, transparency))\n    return 1 - sanitized / 100\n}\n\nfunction commonFeatures(layerId?: string, tiles?: TileService): Record<string, unknown> {\n    const lyrProps = {\n        minzoom: tiles?.minZoom || 0,\n        maxzoom: 24,\n        layout: {}\n    }\n    if (tiles?.rsLayer?.subLayers) {\n        const sublyr = tiles.rsLayer.subLayers.find((sl) => sl.id === layerId) as GISTileLayer\n        lyrProps['source-layer'] = sublyr.path\n    } else {\n        lyrProps['source-layer'] = tiles?.rsLayer?.id\n    }\n    return lyrProps\n}\n\nfunction getPolygonOutlineLayer(leaf: ProjectTreeLeaf, rndColor: Color, tiles?: TileService): Record<string, unknown> {\n    const lyrProps = {\n        ...commonFeatures(leaf.layerId, tiles),\n        type: 'line',\n        paint: {\n            'line-color': rndColor[500],\n            'line-opacity': calculateOpacity(leaf.transparency)\n        }\n    }\n\n    return lyrProps\n}\n\nfunction getPolygonLayer(leaf: ProjectTreeLeaf, rndColor: Color, tiles?: TileService): Record<string, unknown> {\n    const lyrProps = {\n        ...commonFeatures(leaf.layerId, tiles),\n        type: 'fill',\n        paint: {\n            'fill-opacity': calculateOpacity(leaf.transparency),\n            'fill-color': rndColor[700]\n        }\n    }\n    return lyrProps\n}\n\nfunction getPointLayer(leaf: ProjectTreeLeaf, rndColor: Color, tiles?: TileService): Record<string, unknown> {\n    const lyrProps = {\n        ...commonFeatures(leaf.layerId, tiles),\n        type: 'circle',\n        paint: {\n            'circle-stroke-opacity': 1,\n            'circle-stroke-width': 2,\n            'circle-stroke-color': calculateOpacity(leaf.transparency),\n            'circle-opacity': 0.5,\n            'circle-radius': 4,\n            'circle-color': rndColor[700]\n        }\n    }\n    return lyrProps\n}\n\nfunction getLineLayer(leaf: ProjectTreeLeaf, rndColor: Color, tiles?: TileService): Record<string, unknown> {\n    const lyrProps = {\n        ...commonFeatures(leaf.layerId, tiles),\n        type: 'line',\n        paint: {\n            'line-color': rndColor[500],\n            'line-opacity': calculateOpacity(leaf.transparency)\n        }\n    }\n    return lyrProps\n}\n\nexport default {\n    line: getLineLayer,\n    point: getPointLayer,\n    polygon: getPolygonLayer,\n    outline: getPolygonOutlineLayer\n}\n","import React, { useCallback, useEffect, useState } from 'react'\nimport { MapContext, SourceProps, LayerProps } from 'react-map-gl'\nimport { useRecoilState, useRecoilValue } from 'recoil'\nimport {\n    baseLayerAtom,\n    MapLayerState,\n    mapLoadingAtom,\n    RenderableMapLayer,\n    renderableMapLayersSelector\n} from '../recoil'\nimport { legendColors } from '../config'\nimport defaultSymbology from '../components/map/defaultSymbology'\nimport log from 'loglevel'\nimport { ProjectTreeLayerTypes, TileService } from '@riverscapes/common'\n\nfunction getLayerKey(lid: number): string {\n    return `webRAVE_${lid || 'UNKNOWN'}`\n}\n\nfunction getSourceKey(layerPath: string): string {\n    return `webRAVE_${layerPath}`\n}\n\nconst MapLayers: React.FC = () => {\n    const [retry, setRetry] = useState<number>(0)\n    const { map } = React.useContext(MapContext)\n    const baseLayer = useRecoilValue(baseLayerAtom)\n    const [mapLoading, setMapLoading] = useRecoilState(mapLoadingAtom)\n    const renderableMapLayers = useRecoilValue(renderableMapLayersSelector)\n\n    const recalcMapLayers = useCallback(() => {\n        if (!map || !map.isStyleLoaded()) {\n            setMapLoading(true)\n            throw new Error('Map is still loading')\n        }\n        setMapLoading(false)\n\n        const getMapStyle = (): { layers: string[]; sources: string[] } => {\n            const defaultVal = { layers: [], sources: [] }\n            try {\n                const mapStyles = map.getStyle()\n                const mapLayers = mapStyles.layers\n                const mapSources = mapStyles.sources\n                // Get all currently loaded layers and sources from the mapStyle object\n                const currLayerIds = mapLayers.map(({ id }) => id).filter((id) => id.indexOf('webRAVE') === 0)\n                const currSourceIds = Object.keys(mapSources).filter((id) => id.indexOf('webRAVE') === 0)\n                return { layers: currLayerIds, sources: currSourceIds }\n            } catch (e) {\n                // log.error('MapLayers Error retrieving styles', e)\n                return defaultVal\n            }\n        }\n\n        // Make a quick lookup [layerMapboxId] => {layer, sourceMapboxId}\n        const renderablelayersDict = renderableMapLayers.reduce<\n            Record<string, { layer: RenderableMapLayer; sourceId: string }>\n        >(\n            (acc, lyr) => ({\n                ...acc,\n                [getLayerKey(lyr.leaf.id)]: { layer: lyr, sourceId: getSourceKey(lyr.leaf.layerPath || 'UNKNOWN') }\n            }),\n            {}\n        )\n\n        let lastId\n        // Add any new layers. We reverse them because we want the beforeId property to be correct\n        Object.keys(renderablelayersDict).forEach((newKey) => {\n            const { layer, sourceId } = renderablelayersDict[newKey]\n            // Keep track of the layers we're adding here for each tree leaf\n            const addedLayers: string[] = []\n            const mapStyle = getMapStyle()\n            // Layer has already been added. We can set the layer order but otherwise do nothing\n            if (mapStyle.layers.indexOf(newKey) < 0) {\n                // Add the source (if necessary)\n                if (mapStyle.sources.indexOf(sourceId) < 0) {\n                    if (layer.leaf.layerType === ProjectTreeLayerTypes.RASTER) {\n                        map.addSource(sourceId, getRasterSource(layer.tiles as TileService, layer.leaf.symbology))\n                    } else {\n                        map.addSource(sourceId, getVectorSource(layer.tiles as TileService))\n                    }\n                }\n                // Add the layer (every time)\n                if (layer.leaf.layerType === ProjectTreeLayerTypes.RASTER) {\n                    map.addLayer(getRasterLayerProps(layer, newKey, sourceId))\n                    addedLayers.push(newKey)\n                } else {\n                    let symbJSON = (layer.symbology?.symbologyJSON || []) as Record<string, unknown>[]\n                    // If we need a default fallback symbology then go create one\n                    if (symbJSON && layer.randomColor !== null) {\n                        const rndCol = legendColors[layer.randomColor]\n                        switch (layer.leaf.layerType) {\n                            case ProjectTreeLayerTypes.LINE:\n                                symbJSON = [defaultSymbology.line(layer.leaf, rndCol, layer.tiles)]\n                                break\n                            case ProjectTreeLayerTypes.POLYGON:\n                                symbJSON = [\n                                    defaultSymbology.polygon(layer.leaf, rndCol, layer?.tiles),\n                                    defaultSymbology.outline(layer.leaf, rndCol, layer?.tiles)\n                                ]\n                                break\n                            case ProjectTreeLayerTypes.POINT:\n                                symbJSON = [defaultSymbology.line(layer.leaf, rndCol, layer.tiles)]\n                                break\n                            default:\n                                break\n                        }\n                    }\n                    symbJSON.forEach((symb, idx) => {\n                        const idStrIdx = idx === 0 ? newKey : `${newKey}-${idx}`\n                        const lyrProps = getVectorLayerProps(layer, symb, idStrIdx, sourceId)\n                        map.addLayer(lyrProps)\n                        addedLayers.push(idStrIdx)\n                    })\n                }\n                log.debug('MapLayers::AddLayer', { layer, sourceId, newKey, lastId })\n            } else {\n                // If this layer is already loaded then we probably just have to consider\n                // What order it's in\n                const applicableLayers = getMapStyle().layers.filter((lid) => lid.indexOf(newKey) > -1)\n                applicableLayers.forEach((lKey) => addedLayers.push(lKey))\n            }\n            // Regardless of the layer being found we might need to reorder it\n            addedLayers.forEach((addKey) => {\n                if (lastId) {\n                    // const currLayers = getMapStyle().layers\n                    log.debug(`MapLayers:: Moving ${addKey} before ${lastId}`)\n                    // const currIndex = currLayers.indexOf(addKey)\n                    // const lastIndex = currLayers.indexOf(lastId)\n                    // Moving layers is expensive so don't do it unless you have to\n                    // if (currIndex > -1 && lastIndex > -1 && currIndex !== lastIndex + 1) {\n                    map.moveLayer(addKey, lastId)\n                    // }\n                }\n                lastId = addKey\n            })\n        })\n\n        // Remove any unused Layers\n        // TODO: Right now we don't clean up sources. Just layers\n        getMapStyle().layers.forEach((currId) => {\n            // Remember a webRave layer can represent more than one mapbox layer\n            if (!Object.keys(renderablelayersDict).find((newKey) => currId.indexOf(newKey) == 0)) {\n                map.removeLayer(currId)\n            }\n        })\n        // Reset any retries we might be looking into\n        setRetry(0)\n    }, [map, mapLoading, renderableMapLayers, baseLayer])\n\n    // When baselayer changes we reset the map\n    useEffect(() => {\n        try {\n            log.info('recalcMapLayers:Regular')\n            recalcMapLayers()\n        } catch (e) {\n            if (retry < 20) setTimeout(() => setRetry(retry + 1), 2000)\n        }\n    }, [map, mapLoading, renderableMapLayers, baseLayer])\n\n    useEffect(() => {\n        try {\n            log.info('recalcMapLayers:Regular')\n            if (retry > 0) recalcMapLayers()\n        } catch (e) {\n            if (retry < 20) setTimeout(() => setRetry(retry + 1), 2000)\n        }\n    }, [retry])\n\n    // This is kind of a bogus react component\n    return null\n}\n\nexport default MapLayers\n\nfunction getVectorSource(tiles: TileService): SourceProps {\n    return {\n        type: 'vector',\n        maxzoom: tiles.maxZoom || 20,\n        minzoom: tiles.minZoom || 4,\n        tiles: [`${tiles.url}{z}/{x}/{y}.${tiles.format || 'pbf'}`]\n    }\n}\nfunction getRasterSource(tiles: TileService, symbologyName?: string): SourceProps {\n    return {\n        type: 'raster',\n        scheme: 'tms',\n        maxzoom: tiles.maxZoom || 20,\n        minzoom: tiles.minZoom || 4,\n        tiles: [`${tiles.url}${symbologyName || 'raster'}/{z}/{x}/{y}.${tiles.format || 'png'}`]\n    }\n}\n\nfunction getRasterLayerProps(layer: MapLayerState, id: string, sourceId: string): LayerProps {\n    const lyrProps: LayerProps = {\n        type: 'raster',\n        id,\n        source: sourceId,\n        minzoom: layer.tiles?.minZoom || 0,\n        maxzoom: 24,\n        layout: {},\n        paint: {}\n    }\n    return lyrProps\n}\n\nfunction getVectorLayerProps(layer: MapLayerState, symb: Record<string, unknown>, id: string, sourceId: string) {\n    const lyrProps = {\n        // this will get overridden by\n        type: 'fill',\n        minzoom: layer.tiles?.minZoom || 0,\n        maxzoom: 24, // hardcoded to the max value possible\n        layout: {},\n        paint: {},\n        ...symb,\n        id,\n        source: sourceId\n    }\n    return lyrProps\n}\n","import React from 'react'\nimport LegendConnect from './Legend.connect'\n// import MapLayerConnect from './MapLayer.connect'\nimport { useRecoilValue, useRecoilState } from 'recoil'\nimport { baseLayerAtom, boundsSelector, drawerOpenAtom, mapLoadingAtom } from '../recoil'\nimport Map from '../components/map/Map'\nimport TreeToggleBtn from '../components/TreeToggleBtn'\nimport MapLayerConnect from './MapLayer.connect'\nimport { googleAnalytics } from '@riverscapes/react-common'\n\nconst MapConnect: React.FC = () => {\n    const bounds = useRecoilValue(boundsSelector)\n    const mapLoading = useRecoilValue(mapLoadingAtom)\n\n    const baseLayer = useRecoilValue(baseLayerAtom)\n    const [drawerOpen, toggleDrawer] = useRecoilState(drawerOpenAtom)\n\n    return (\n        <React.Fragment>\n            <Map baseLayer={baseLayer} zoomBounds={bounds.zoom} bounds={bounds.bounds} styleLoading={mapLoading}>\n                {[\n                    <TreeToggleBtn\n                        key=\"treeToggleBtn\"\n                        drawerOpen={drawerOpen}\n                        toggleDrawer={() => {\n                            googleAnalytics.event('webrave', 'set_map_drawer', !drawerOpen ? 'closed' : 'open')\n                            toggleDrawer(!drawerOpen)\n                        }}\n                    />,\n                    <LegendConnect key=\"legend\" />,\n                    <MapLayerConnect key=\"mapLayers\" />\n                ]}\n            </Map>\n        </React.Fragment>\n    )\n}\n\nexport default MapConnect\n","import React from 'react'\nimport { dates } from '@northarrowresearch/common'\nimport { DownloadZipBtn, PendingZips } from '@riverscapes/react-common'\nimport Paper from '@material-ui/core/Paper'\nimport Divider from '@material-ui/core/Divider'\nimport { warehouseUrl } from '../config'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Typography } from '@material-ui/core'\nimport { Project } from '@riverscapes/common'\nimport MetaData from './meta/MetaData'\nimport { WarehouseButton } from '@riverscapes/react-common'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        padding: theme.spacing(1),\n        height: '100%',\n        overflowY: 'scroll',\n        userSelect: 'text',\n        '& *': {\n            userSelect: 'text'\n        }\n    },\n    btnGroup: {\n        width: '100%',\n        display: 'flex',\n        justifyContent: 'space-between',\n        '&>*': {\n            flex: '0 0 calc(50% - 0.5em)'\n        },\n        margin: theme.spacing(1, 1, 3, 1)\n    },\n    divider: {\n        marginTop: theme.spacing(3)\n    },\n    footerLogo: {}\n}))\n\ninterface ProjectInfoTabProps {\n    project: Project\n    downloadZipFile: (project: Project) => Promise<void>\n    pendingZips: PendingZips\n}\n\nconst ProjectInfoTab: React.FC<ProjectInfoTabProps> = ({\n    project,\n    downloadZipFile,\n    pendingZips\n}: ProjectInfoTabProps) => {\n    const classes = useStyles()\n\n    const projectInfo = {\n        Title: project.name,\n        Type: project.projType,\n        'Warehouse ID': project.id,\n        'Warehouse Tags': Array.isArray(project.tags) ? project.tags.join(', ') : '<None>',\n        'Project Created': `${dates.formatDate(project.createdOn, 'lll')} (${dates.formatDateAgo(project.createdOn)})`,\n        'Project Updated': `${dates.formatDate(project.updatedOn, 'lll')} (${dates.formatDateAgo(project.updatedOn)})`\n    }\n    const pendingSince = project && pendingZips[project.id]\n    return (\n        <Paper className={classes.root}>\n            <Typography variant=\"h4\" paragraph color=\"textPrimary\">\n                {project.projType} Project\n            </Typography>\n            <Divider />\n            <Typography component=\"div\" paragraph>\n                This project exists within the Riverscapes Data Warehouse. You can download this project and view it\n                using the free{' '}\n                <a href=\"https://rave.riverscapes.xyz\" target=\"_blank\" rel=\"noreferrer\">\n                    RAVE\n                </a>{' '}\n                {/* plugin for either QGIS or ArcGIS. */}\n                plugin for ArcGIS.\n            </Typography>\n            <div className={classes.btnGroup}>\n                <WarehouseButton title={`Warehouse`} href={`${warehouseUrl}/#/${project.program}/${project.id}`} />\n                <DownloadZipBtn\n                    downloadZipFile={downloadZipFile}\n                    pendingSince={pendingSince}\n                    project={project}\n                    // btnProps={{}}\n                    title=\"Download\"\n                />\n            </div>\n            <MetaData title=\"Project Information\" meta={projectInfo} />\n            <MetaData title=\"Project Metadata\" meta={project.meta} />\n\n            <Divider className={classes.divider} />\n            <a href=\"http://riverscapes.xyz\" target=\"_blank\" rel=\"noreferrer\">\n                <img\n                    className={classes.footerLogo}\n                    alt=\"footer\"\n                    src={`${process.env.PUBLIC_URL}/cc-watermarks-riverscapes_orig.png`}\n                />\n            </a>\n        </Paper>\n    )\n}\n\nexport default ProjectInfoTab\n","import { ProjectTreeLayerTypes, SymbologyStatus } from '@riverscapes/common'\nimport { useEffect } from 'react'\nimport { useRecoilValue, useRecoilCallback } from 'recoil'\nimport {\n    assignedRandomColorsAtom,\n    selectNextColor,\n    layerStateSelectorFamily,\n    leafRandomColAtomFamily,\n    activeTreeLeavesSelector\n} from '../recoil'\n// import log from 'loglevel'\n\nconst useColourFallback = (): void => {\n    const activeTreeLeaves = useRecoilValue(activeTreeLeavesSelector)\n    /**\n     * We can use a Recoil Callback here to make sure we don't overfetch any state while we're assigning a color\n     */\n    const assignRndCol = useRecoilCallback(({ snapshot, set }) => async (lid: number) => {\n        const colIds = await snapshot.getPromise(assignedRandomColorsAtom) // pre-fetch user info\n        const currRndCol = await snapshot.getPromise(leafRandomColAtomFamily(lid)) // pre-fetch user info\n        const layer = await snapshot.getPromise(layerStateSelectorFamily(lid))\n        const nextCol = await snapshot.getPromise(selectNextColor) // pre-fetch user info\n\n        let needRndCol = false\n        // Symbology and tiles are loaded asynchronously so we might need a loading state here\n        if (!layer.symbology || layer.symbology.status !== SymbologyStatus.FOUND) {\n            needRndCol = true\n        }\n\n        // Only do this if we haven't already assigned a color. Should save on churn\n        if (needRndCol && currRndCol === null) {\n            set(assignedRandomColorsAtom, [...colIds, nextCol])\n            set(leafRandomColAtomFamily(lid), nextCol)\n        }\n        // Unsetting isn't exactly just an Else case\n        else if (!needRndCol && currRndCol !== null) {\n            set(\n                assignedRandomColorsAtom,\n                colIds.filter((cid) => cid === currRndCol)\n            )\n            set(leafRandomColAtomFamily(lid), null)\n        }\n    })\n\n    useEffect(() => {\n        const exFunc = async () => {\n            for (let idx = 0; idx < activeTreeLeaves.length; idx++) {\n                if (activeTreeLeaves[idx].layerType !== ProjectTreeLayerTypes.RASTER)\n                    await assignRndCol(activeTreeLeaves[idx].id)\n            }\n        }\n        exFunc()\n    }, [activeTreeLeaves])\n}\n\nexport default useColourFallback\n","import React from 'react'\nimport { History } from 'react-router-dom'\nimport AppWrapper from '../components/AppWrapper'\n// import log from 'loglevel'\n// import { useHosted } from '@northarrowresearch/react-auth'\nimport { UseHostedReturn } from '@northarrowresearch/react-auth'\nimport ProjectLoading from '../components/ProjectLoading'\nimport { useDownloads, NotAllowedModal, useProgram, useProject, googleAnalytics } from '@riverscapes/react-common'\nimport { Program, WarehouseRoleEnum } from '@riverscapes/common'\n\nimport useAppStateInit from '../hooks/useAppStateInit'\nimport { drawerOpenAtom, projectLayerPathsSelector } from '../recoil'\nimport { useRecoilValue } from 'recoil'\nimport ProjectNotFound from '../components/ProjectNotFound'\nimport AppSplitter from '../components/AppSplitter'\nimport TreeDrawer from '../components/TreeDrawer'\nimport TreeControlConnect from './Treecontrol.connect'\nimport MapTilesConnect from './MapTiles.connect'\nimport MapConnect from './Map.connect'\nimport ProjectInfoTab from '../components/ProjectInfoTab'\nimport useColourFallback from '../hooks/useColourFallback'\n\n/**\n * This is the over-arching wrapper for the app. It combines all the\n * same place. Time will tell if that's a good strategy.\n * This is also where we carry the bulk of the state and the hooks for the app\n */\ninterface Props {\n    auth: UseHostedReturn\n    history: History\n    programs: Program[]\n}\n\nconst AppConnect: React.FC<Props> = ({ history, auth, programs }: Props) => {\n    // Here we make the graphql call to retrieve the project and program from the API\n    const program = useProgram(programs)\n    const drawerOpen = useRecoilValue(drawerOpenAtom)\n    const projectLayerPaths = useRecoilValue(projectLayerPathsSelector)\n\n    // Init state won't change unless I reload this component\n    const hasViewAccess = program && Object.values(WarehouseRoleEnum).indexOf(program.role) > -1\n    const { project, loading: isProjLoading, initialized } = useProject(auth, program, false, true)\n    const { downloadZipFile, pendingZips } = useDownloads(auth, program as Program)\n\n    // This is where we initialize all the recoil pre-fetch stuff\n    useAppStateInit(auth, project)\n    useColourFallback()\n\n    // 1. If we don's have access then tell the user that\n    if (!hasViewAccess) {\n        googleAnalytics.event('error', 'access_denied', window.location.hash)\n        return (\n            <AppWrapper title={'Access Denied'} history={history} signOut={auth.signOut}>\n                <NotAllowedModal program={program as Program} onClose={(): void => history.push('/')} />\n            </AppWrapper>\n        )\n    }\n    // 2. If we haven't made the query yet then this is in LOADING state\n    else if (!initialized || isProjLoading)\n        return (\n            <AppWrapper title={'Loading'} history={history} signOut={auth.signOut}>\n                <ProjectLoading title={isProjLoading ? 'Loading Project...' : 'Initializing...'} />\n            </AppWrapper>\n        )\n    // 4. Default to project not found otherwise\n    else if (!project) {\n        return (\n            <AppWrapper title={'Project not found'} history={history} signOut={auth.signOut}>\n                <ProjectNotFound />\n            </AppWrapper>\n        )\n    }\n    // Send a 404 to analytics if necessary\n    if (!project && !isProjLoading) googleAnalytics.event('error', 'project_not_found', window.location.hash)\n\n    return (\n        <>\n            {projectLayerPaths.map((plp) => (\n                // This is maybe a little bit of a hack and a small concession. Usually I don't like dummy\n                // React components that return nothing but in this case I can't figure out a way to do this nicely\n                <MapTilesConnect key={plp} layerPath={plp} />\n            ))}\n            <AppWrapper title={project.name} history={history} signOut={auth.signOut}>\n                <AppSplitter\n                    open={drawerOpen}\n                    split=\"vertical\"\n                    primary=\"second\"\n                    minSize={500}\n                    maxSize=\"85%\"\n                    defaultSize=\"75%\"\n                    child1={\n                        <TreeDrawer\n                            tabs={[\n                                {\n                                    label: 'Project Tree',\n                                    value: <TreeControlConnect />\n                                },\n                                {\n                                    label: 'Project Info',\n                                    value: (\n                                        <ProjectInfoTab\n                                            project={project}\n                                            downloadZipFile={downloadZipFile}\n                                            pendingZips={pendingZips}\n                                        />\n                                    )\n                                }\n                            ]}\n                        />\n                    }\n                    child2={<MapConnect />}\n                />\n            </AppWrapper>\n        </>\n    )\n}\nexport default AppConnect\n","import React, { useState, useEffect, useCallback } from 'react'\nimport AppConnect from './App.connect'\nimport { LoginScreen, config, googleAnalytics } from '@riverscapes/react-common'\nimport { Route, Switch, History, useHistory } from 'react-router-dom'\nimport { Loading } from '@northarrowresearch/react-common'\nimport { useHosted, UseHostedReturn } from '@northarrowresearch/react-auth'\nimport { warehouseIconUrl, appDefaults, appRouterPath } from '../config'\nimport { authCheck } from '@riverscapes/common'\nimport AppWrapper from '../components/AppWrapper'\nimport ProjectNotFound from '../components/ProjectNotFound'\nimport { Program, Project, getPrograms } from '@riverscapes/common'\nimport log from 'loglevel'\n\ngoogleAnalytics.init()\n\nconst AppAuthConnect: React.FC = () => {\n    const [authInfo, setAuthInfo] = useState<Record<string, unknown>>()\n    const [programsState, setProgramsState] = useState<{ programs: Program[]; loading: boolean }>()\n    const [isAppPreLoading, setIsAppPreLoading] = useState(true)\n    const auth: UseHostedReturn = useHosted(authInfo as Record<string, unknown>, false, false) //config.isDev\n    const history = useHistory()\n\n    // Go get all the startup info we need to start logging in\n    // Initial fetch gets us all the program objects\n    useEffect(() => {\n        // Register the current page view\n        googleAnalytics.currentPageView()\n\n        authCheck(config.endpoints.graphql, '')\n            .then((authResp) => {\n                log.debug('authResp', authResp)\n                const authVals = authResp.data?.auth\n                if (authVals && authVals.region) {\n                    setAuthInfo({\n                        region: authVals.region,\n                        userPoolId: authVals.userPool,\n                        userPoolWebClientId: authVals.clientId,\n                        mandatorySignIn: true,\n                        oauth: {\n                            domain: authVals.domain,\n                            scope: ['email', 'profile', 'openid'],\n                            redirectSignIn: config.redirectUrl.toString(),\n                            redirectSignOut: config.redirectUrl.toString(),\n                            responseType: 'code'\n                        }\n                    })\n                    setIsAppPreLoading(false)\n                }\n            })\n            .catch((err) => {\n                log.error('api.getPrograms error', err)\n            })\n    }, [])\n\n    // This lets us do a redirect after login using localstorage\n    useEffect(() => {\n        if (!history) return\n        const storageUrl = localStorage.getItem('RSUrl')\n        const localUrl = history.location.pathname\n        log.debug('LOCALSTORAGE:::REDIRECT checking', storageUrl, localUrl, auth)\n\n        if (!auth.isAuthenticated && !auth.error && auth.isAuthComplete) {\n            log.debug('LOCALSTORAGE:::SET', localUrl)\n            localStorage.setItem('RSUrl', localUrl)\n        }\n        if (storageUrl && auth.isAuthenticated && auth.isAuthComplete && !auth.error) {\n            if (localUrl !== storageUrl) {\n                log.debug('LOCALSTORAGE:::REDIRECT', localUrl, storageUrl)\n                history.push(storageUrl)\n            }\n            localStorage.removeItem('RSUrl')\n        }\n    }, [history, auth])\n\n    const navigate = useCallback((history: History, program: Program, project?: Project): void => {\n        let address\n\n        if (project) address = '/' + program.machineName + '/' + project.id\n        else address = '/' + program.machineName\n\n        googleAnalytics.event('webrave', 'navigate', address)\n        history.push(address)\n    }, [])\n\n    // Initial fetch gets us all the program objects\n    useEffect(() => {\n        if (!auth.isAuthenticated || programsState?.programs) return\n        setProgramsState({ programs: [], loading: true })\n        auth.getCurrentToken()\n            .then((jwt) => getPrograms(config.endpoints.graphql, jwt))\n            .then((allPrograms) => {\n                log.debug('API GetPrograms', allPrograms)\n                if (allPrograms.data && allPrograms.data.programs) {\n                    setProgramsState({ programs: allPrograms.data.programs, loading: false })\n                }\n            })\n            .catch((err) => {\n                log.error('api.getPrograms error', err)\n                // setIsAppPreLoading(false)\n            })\n    }, [auth, programsState])\n\n    const logoSVG = <img src={warehouseIconUrl} alt=\"logo\" />\n\n    // render the login helper screen if that's called for\n    if (isAppPreLoading) {\n        return (\n            <AppWrapper title=\"Loading authentication info\">\n                <Loading\n                    logoSVG={logoSVG}\n                    title={appDefaults.appName}\n                    message={'Loading authentication info'}\n                    version={config.version}\n                />\n            </AppWrapper>\n        )\n    } else {\n        if (!auth.isAuthenticated) {\n            if (!auth.isAuthComplete) {\n                return (\n                    <AppWrapper title=\"webRAVE\">\n                        <Loading\n                            logoSVG={logoSVG}\n                            title=\"Authenticating\"\n                            message={'Authenticating'}\n                            version={config.version}\n                        />\n                    </AppWrapper>\n                )\n            }\n            return (\n                <AppWrapper title=\"Sign in\">\n                    <LoginScreen signIn={auth.signIn} title={'Riverscapes Map Viewer'} />\n                </AppWrapper>\n            )\n        } else if (!programsState || programsState?.loading) {\n            return (\n                <AppWrapper title=\"webRAVE\">\n                    <Loading\n                        logoSVG={logoSVG}\n                        title={'Riverscapes Warehouse'}\n                        message={'Loading Programs'}\n                        version={config.version}\n                    />\n                </AppWrapper>\n            )\n        } else {\n            const appWrapProps = { navigate, signOut: auth.signOut }\n            return (\n                <Switch>\n                    <Route\n                        path={appRouterPath}\n                        render={(props): React.ReactElement => (\n                            <AppConnect {...props} auth={auth} programs={programsState?.programs} />\n                        )}\n                    />\n                    <Route\n                        path=\"*\"\n                        render={(props): React.ReactElement => (\n                            <AppWrapper {...props} {...appWrapProps}>\n                                <ProjectNotFound />\n                            </AppWrapper>\n                        )}\n                    />\n                </Switch>\n            )\n        }\n    }\n}\nexport default AppAuthConnect\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppAuthConnect from './connectors/AppAuth.connect'\nimport { Router } from 'react-router-dom'\nimport { hashHistory } from '@riverscapes/react-common'\nimport log from 'loglevel'\n// import { devSetup } from '@northarrowresearch/react-common'\n// Here's our global overrides css\nimport './base.css'\nimport { RecoilRoot } from 'recoil'\n\n// THIS FIX IS NECESSARY FOR PRODUCTION AND WEBPACK!!!!\n// https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2\n// https://github.com/mapbox/mapbox-gl-js/issues/10173\nimport mapboxgl from 'mapbox-gl/dist/mapbox-gl'\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nmapboxgl.workerClass = require('worker-loader!mapbox-gl/dist/mapbox-gl-csp-worker').default\n\n// This does its own process.env.NODE_ENV check\n// In production it only presents a minimal set of tools\n// devSetup()\nlog.setDefaultLevel(log.levels.DEBUG)\n\n// This is the font we need\nrequire('typeface-roboto')\n\nReactDOM.render(\n    <RecoilRoot>\n        <Router basename=\"/\" history={hashHistory}>\n            <AppAuthConnect />\n        </Router>\n    </RecoilRoot>,\n    document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.register()\n\n// On android this will trick the back button into not closing the app\nwindow.addEventListener('load', () => {\n    window.history.pushState({}, '')\n})\n\n// In Chrome > 52 we need to explicitly request persistent storage to make sure our\n// stuff isn't cleaned up automatically.\nif (navigator.storage && navigator.storage.persist) {\n    navigator.storage.persist().then((granted) => {\n        if (granted) {\n            log.debug('Storage will not be cleared except by explicit user action')\n        } else {\n            log.warn('Storage may be cleared by the UA under storage pressure.')\n        }\n    })\n} else {\n    log.warn('navigator.storage API not implemented.')\n}\n"],"sourceRoot":""}